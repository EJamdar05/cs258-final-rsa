{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 411.0, "episode_reward_min": 290.0, "episode_reward_mean": 355.3, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3451183959320709, "mean_inference_ms": 1.3220057739959015, "mean_action_processing_ms": 0.04459594513152863, "mean_env_wait_ms": 0.46900531033297754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015027523040771484, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0587010383605957}, "num_episodes": 10, "episode_return_max": 411.0, "episode_return_min": 290.0, "episode_return_mean": 355.3}, "env_runner_results": {"episode_reward_max": 411.0, "episode_reward_min": 290.0, "episode_reward_mean": 355.3, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3451183959320709, "mean_inference_ms": 1.3220057739959015, "mean_action_processing_ms": 0.04459594513152863, "mean_env_wait_ms": 0.46900531033297754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015027523040771484, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0587010383605957}, "num_episodes": 10, "episode_return_max": 411.0, "episode_return_min": 290.0, "episode_return_mean": 355.3}, "episode_reward_max": 411.0, "episode_reward_min": 290.0, "episode_reward_mean": 355.3, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 1000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3451183959320709, "mean_inference_ms": 1.3220057739959015, "mean_action_processing_ms": 0.04459594513152863, "mean_env_wait_ms": 0.46900531033297754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015027523040771484, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0587010383605957}, "num_episodes": 10, "episode_return_max": 411.0, "episode_return_min": 290.0, "episode_return_mean": 355.3, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.43412938142524, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000, "num_env_steps_sampled_lifetime": 1000, "num_agent_steps_sampled_lifetime": 1000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000, "timers": {"training_iteration_time_ms": 3657.188, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3.665, "sample_time_ms": 3.665}, "counters": {"num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "default", "date": "2024-05-18_20-33-04", "timestamp": 1716089584, "time_this_iter_s": 3.6581883430480957, "time_total_s": 3.6581883430480957, "pid": 44624, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002876A119620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3.6581883430480957, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 2.35, "ram_util_percent": 34.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5855041742324829, "mean_q": 9.215191841125488, "min_q": 1.5107274055480957, "max_q": 16.82176971435547, "cur_lr": 0.0005}, "td_error": [3.4566097259521484, -0.5335803031921387, -1.2739238739013672, 5.022139072418213, 9.710982322692871, 5.777988433837891, 1.125645637512207, 1.939466953277588, 0.5674762725830078, 0.03670930862426758, 0.9749712944030762, 0.3515958786010742, -0.143646240234375, 0.871647834777832, -2.6925277709960938, 0.5607805252075195, -0.9769124984741211, -1.0797114372253418, 1.8819776773452759, 2.721177101135254, -0.3370490074157715, -0.9992284774780273, -2.75100040435791, -0.10867595672607422, 1.0774202346801758, -4.400310516357422, 2.0766868591308594, 0.7801065444946289, -1.776224136352539, 1.9381380081176758, 3.949887752532959, 0.36865997314453125], "mean_td_error": 0.8786649107933044, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 999.0}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "last_target_update_ts": 1501, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": 411.0, "episode_reward_min": 290.0, "episode_reward_mean": 361.5, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41155184039299086, "mean_inference_ms": 1.45922721748255, "mean_action_processing_ms": 0.05622597297443449, "mean_env_wait_ms": 0.49914656307093497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010026693344116211, "StateBufferConnector_ms": 0.010014772415161133, "ViewRequirementAgentConnector_ms": 0.07439255714416504}, "num_episodes": 10, "episode_return_max": 411.0, "episode_return_min": 290.0, "episode_return_mean": 361.5}, "env_runner_results": {"episode_reward_max": 411.0, "episode_reward_min": 290.0, "episode_reward_mean": 361.5, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41155184039299086, "mean_inference_ms": 1.45922721748255, "mean_action_processing_ms": 0.05622597297443449, "mean_env_wait_ms": 0.49914656307093497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010026693344116211, "StateBufferConnector_ms": 0.010014772415161133, "ViewRequirementAgentConnector_ms": 0.07439255714416504}, "num_episodes": 10, "episode_return_max": 411.0, "episode_return_min": 290.0, "episode_return_mean": 361.5}, "episode_reward_max": 411.0, "episode_reward_min": 290.0, "episode_reward_mean": 361.5, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 2000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41155184039299086, "mean_inference_ms": 1.45922721748255, "mean_action_processing_ms": 0.05622597297443449, "mean_env_wait_ms": 0.49914656307093497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010026693344116211, "StateBufferConnector_ms": 0.010014772415161133, "ViewRequirementAgentConnector_ms": 0.07439255714416504}, "num_episodes": 10, "episode_return_max": 411.0, "episode_return_min": 290.0, "episode_return_mean": 361.5, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.620737135070012, "num_env_steps_trained_throughput_per_sec": 659.8635883222404, "timesteps_total": 2000, "num_env_steps_sampled_lifetime": 2000, "num_agent_steps_sampled_lifetime": 2000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 26076.03, "restore_workers_time_ms": 0.0, "training_step_time_ms": 48.647, "sample_time_ms": 14.715, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 18.418, "learn_throughput": 1737.446, "synch_weights_time_ms": 6.615}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "last_target_update_ts": 1501, "num_target_updates": 2}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "default", "date": "2024-05-18_20-33-53", "timestamp": 1716089633, "time_this_iter_s": 48.510889768600464, "time_total_s": 52.16907811164856, "pid": 44624, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002876A119620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 52.16907811164856, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 21.179411764705883, "ram_util_percent": 34.582352941176474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6081735491752625, "mean_q": 20.896530151367188, "min_q": 7.623797416687012, "max_q": 37.6552619934082, "cur_lr": 0.0005}, "td_error": [0.7190742492675781, 0.6581125259399414, -3.9654579162597656, 3.2128677368164062, -8.364648818969727, 1.7358379364013672, -1.643960952758789, -0.3739166259765625, 1.0449333190917969, -2.733858108520508, -1.0669059753417969, -1.8319015502929688, 2.4710845947265625, 2.2758350372314453, 5.761104583740234, 1.3988056182861328, 3.476665496826172, 0.1268310546875, 0.6556835174560547, 2.6237974166870117, 0.2784099578857422, 2.5376224517822266, -8.308128356933594, -1.359395980834961, 0.5706844329833984, -1.6819095611572266, -0.9912815093994141, 1.8522300720214844, 5.546561241149902, -3.6368026733398438, 2.115154266357422, -1.9516372680664062], "mean_td_error": 0.03598406910896301, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2000.0, "diff_num_grad_updates_vs_sampler_policy": 1999.0}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "last_target_update_ts": 2501, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": 414.0, "episode_reward_min": 290.0, "episode_reward_mean": 366.56666666666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45130398037689257, "mean_inference_ms": 1.547061249434305, "mean_action_processing_ms": 0.06348312682977496, "mean_env_wait_ms": 0.5211153971384938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010016759236653646, "StateBufferConnector_ms": 0.010019143422444662, "ViewRequirementAgentConnector_ms": 0.07195711135864258}, "num_episodes": 10, "episode_return_max": 414.0, "episode_return_min": 290.0, "episode_return_mean": 366.56666666666666}, "env_runner_results": {"episode_reward_max": 414.0, "episode_reward_min": 290.0, "episode_reward_mean": 366.56666666666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45130398037689257, "mean_inference_ms": 1.547061249434305, "mean_action_processing_ms": 0.06348312682977496, "mean_env_wait_ms": 0.5211153971384938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010016759236653646, "StateBufferConnector_ms": 0.010019143422444662, "ViewRequirementAgentConnector_ms": 0.07195711135864258}, "num_episodes": 10, "episode_return_max": 414.0, "episode_return_min": 290.0, "episode_return_mean": 366.56666666666666}, "episode_reward_max": 414.0, "episode_reward_min": 290.0, "episode_reward_mean": 366.56666666666666, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45130398037689257, "mean_inference_ms": 1.547061249434305, "mean_action_processing_ms": 0.06348312682977496, "mean_env_wait_ms": 0.5211153971384938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010016759236653646, "StateBufferConnector_ms": 0.010019143422444662, "ViewRequirementAgentConnector_ms": 0.07195711135864258}, "num_episodes": 10, "episode_return_max": 414.0, "episode_return_min": 290.0, "episode_return_mean": 366.56666666666666, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.290774343490522, "num_env_steps_trained_throughput_per_sec": 617.3047789916967, "timesteps_total": 3000, "num_env_steps_sampled_lifetime": 3000, "num_agent_steps_sampled_lifetime": 3000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 3000, "timers": {"training_iteration_time_ms": 34663.437, "restore_workers_time_ms": 0.1, "training_step_time_ms": 48.375, "sample_time_ms": 15.225, "load_time_ms": 0.3, "load_throughput": 106513.553, "learn_time_ms": 18.526, "learn_throughput": 1727.264, "synch_weights_time_ms": 6.465}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "last_target_update_ts": 2501, "num_target_updates": 4}, "done": false, "episodes_total": 30, "training_iteration": 3, "trial_id": "default", "date": "2024-05-18_20-34-45", "timestamp": 1716089685, "time_this_iter_s": 51.85526752471924, "time_total_s": 104.0243456363678, "pid": 44624, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002876A119620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 104.0243456363678, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 21.45, "ram_util_percent": 34.92702702702702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1308794021606445, "mean_q": 28.14830780029297, "min_q": 14.949304580688477, "max_q": 41.69902801513672, "cur_lr": 0.0005}, "td_error": [0.11193084716796875, -0.5353546142578125, -1.6339778900146484, -0.17702102661132812, 7.419450759887695, -0.038516998291015625, 0.11936187744140625, 1.8173141479492188, -1.6023807525634766, -3.6667861938476562, 7.347833633422852, -2.080841064453125, 0.17666053771972656, -2.5684661865234375, -2.6795654296875, -0.4870319366455078, -1.7943229675292969, -2.6795654296875, -1.9135894775390625, -1.9259662628173828, -6.127971649169922, 1.5517215728759766, -2.7217845916748047, -4.272254943847656, -1.9312019348144531, 1.7097663879394531, -4.680957794189453, 3.780061721801758, -0.3906402587890625, 1.3158950805664062, 3.5725173950195312, -2.4307727813720703], "mean_td_error": -0.5442642569541931, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3000.0, "diff_num_grad_updates_vs_sampler_policy": 2999.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "last_target_update_ts": 3501, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": 417.0, "episode_reward_min": 290.0, "episode_reward_mean": 371.775, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4782651341280113, "mean_inference_ms": 1.6057634880489702, "mean_action_processing_ms": 0.06852442841227686, "mean_env_wait_ms": 0.5369734758935508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018769502639770508, "StateBufferConnector_ms": 0.007514357566833496, "ViewRequirementAgentConnector_ms": 0.10152459144592285}, "num_episodes": 10, "episode_return_max": 417.0, "episode_return_min": 290.0, "episode_return_mean": 371.775}, "env_runner_results": {"episode_reward_max": 417.0, "episode_reward_min": 290.0, "episode_reward_mean": 371.775, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4782651341280113, "mean_inference_ms": 1.6057634880489702, "mean_action_processing_ms": 0.06852442841227686, "mean_env_wait_ms": 0.5369734758935508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018769502639770508, "StateBufferConnector_ms": 0.007514357566833496, "ViewRequirementAgentConnector_ms": 0.10152459144592285}, "num_episodes": 10, "episode_return_max": 417.0, "episode_return_min": 290.0, "episode_return_mean": 371.775}, "episode_reward_max": 417.0, "episode_reward_min": 290.0, "episode_reward_mean": 371.775, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4782651341280113, "mean_inference_ms": 1.6057634880489702, "mean_action_processing_ms": 0.06852442841227686, "mean_env_wait_ms": 0.5369734758935508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018769502639770508, "StateBufferConnector_ms": 0.007514357566833496, "ViewRequirementAgentConnector_ms": 0.10152459144592285}, "num_episodes": 10, "episode_return_max": 417.0, "episode_return_min": 290.0, "episode_return_mean": 371.775, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.5990632888675, "num_env_steps_trained_throughput_per_sec": 595.17002524376, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 39439.115, "restore_workers_time_ms": 0.0, "training_step_time_ms": 52.453, "sample_time_ms": 16.645, "load_time_ms": 0.051, "load_throughput": 622531.206, "learn_time_ms": 20.261, "learn_throughput": 1579.428, "synch_weights_time_ms": 6.706}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "last_target_update_ts": 3501, "num_target_updates": 6}, "done": false, "episodes_total": 40, "training_iteration": 4, "trial_id": "default", "date": "2024-05-18_20-35-38", "timestamp": 1716089738, "time_this_iter_s": 53.77917718887329, "time_total_s": 157.8035228252411, "pid": 44624, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002876A119620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 157.8035228252411, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.62236842105263, "ram_util_percent": 35.031578947368416}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7076926231384277, "mean_q": 40.930057525634766, "min_q": 11.788938522338867, "max_q": 60.810630798339844, "cur_lr": 0.0005}, "td_error": [2.684337615966797, -1.8005485534667969, 4.901145935058594, -6.676982879638672, 10.417167663574219, 3.374950408935547, -3.3998241424560547, 1.7387657165527344, -7.413991928100586, 4.988178253173828, -0.4422721862792969, 3.575023651123047, 4.132659912109375, -1.819244384765625, -2.3567581176757812, 4.1644287109375, 1.205902099609375, 6.130802154541016, 1.6786651611328125, 1.538909912109375, 1.7048606872558594, 0.47118568420410156, 4.537227630615234, 1.0227165222167969, 6.3079376220703125, -7.987434387207031, 4.211681365966797, 3.4788780212402344, 5.347080230712891, 3.9430904388427734, -1.936187744140625, -5.9953155517578125], "mean_td_error": 1.3039698600769043, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4000.0, "diff_num_grad_updates_vs_sampler_policy": 3999.0}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "last_target_update_ts": 4501, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": 417.0, "episode_reward_min": 290.0, "episode_reward_mean": 372.5, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4967931151712698, "mean_inference_ms": 1.6468511647062416, "mean_action_processing_ms": 0.07176893452870779, "mean_env_wait_ms": 0.547807088178348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024018287658691406, "StateBufferConnector_ms": 0.0080108642578125, "ViewRequirementAgentConnector_ms": 0.09623527526855469}, "num_episodes": 10, "episode_return_max": 417.0, "episode_return_min": 290.0, "episode_return_mean": 372.5}, "env_runner_results": {"episode_reward_max": 417.0, "episode_reward_min": 290.0, "episode_reward_mean": 372.5, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4967931151712698, "mean_inference_ms": 1.6468511647062416, "mean_action_processing_ms": 0.07176893452870779, "mean_env_wait_ms": 0.547807088178348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024018287658691406, "StateBufferConnector_ms": 0.0080108642578125, "ViewRequirementAgentConnector_ms": 0.09623527526855469}, "num_episodes": 10, "episode_return_max": 417.0, "episode_return_min": 290.0, "episode_return_mean": 372.5}, "episode_reward_max": 417.0, "episode_reward_min": 290.0, "episode_reward_mean": 372.5, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4967931151712698, "mean_inference_ms": 1.6468511647062416, "mean_action_processing_ms": 0.07176893452870779, "mean_env_wait_ms": 0.547807088178348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024018287658691406, "StateBufferConnector_ms": 0.0080108642578125, "ViewRequirementAgentConnector_ms": 0.09623527526855469}, "num_episodes": 10, "episode_return_max": 417.0, "episode_return_min": 290.0, "episode_return_mean": 372.5, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.857099968988297, "num_env_steps_trained_throughput_per_sec": 603.4271990076255, "timesteps_total": 5000, "num_env_steps_sampled_lifetime": 5000, "num_agent_steps_sampled_lifetime": 5000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 5000, "timers": {"training_iteration_time_ms": 42157.377, "restore_workers_time_ms": 0.0, "training_step_time_ms": 48.358, "sample_time_ms": 15.476, "load_time_ms": 0.1, "load_throughput": 320175.878, "learn_time_ms": 18.852, "learn_throughput": 1697.388, "synch_weights_time_ms": 6.47}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "last_target_update_ts": 4501, "num_target_updates": 8}, "done": false, "episodes_total": 50, "training_iteration": 5, "trial_id": "default", "date": "2024-05-18_20-36-31", "timestamp": 1716089791, "time_this_iter_s": 53.04693937301636, "time_total_s": 210.85046219825745, "pid": 44624, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002876A119620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 210.85046219825745, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.362666666666666, "ram_util_percent": 35.08133333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.126466989517212, "mean_q": 45.107845306396484, "min_q": 1.9350261688232422, "max_q": 67.63546752929688, "cur_lr": 0.0005}, "td_error": [-2.064973831176758, -4.733390808105469, -2.5995559692382812, -6.695934295654297, 3.96832275390625, -0.9125823974609375, -0.2651710510253906, -0.4339561462402344, -7.886762619018555, -5.996055603027344, -3.4934539794921875, -3.0167922973632812, -1.5651473999023438, -15.555286407470703, 1.7212028503417969, -6.595432281494141, -1.5170021057128906, -4.718170166015625, -3.3972740173339844, -0.41570281982421875, -12.225021362304688, -3.2380714416503906, -0.8808059692382812, 2.5645828247070312, -4.131160736083984, -0.1459503173828125, 8.767242431640625, 1.9253807067871094, -2.7018280029296875, -2.241241455078125, -1.3958663940429688, 9.103218078613281], "mean_td_error": -2.2116448879241943, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5000.0, "diff_num_grad_updates_vs_sampler_policy": 4999.0}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "last_target_update_ts": 5501, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": 417.0, "episode_reward_min": 290.0, "episode_reward_mean": 373.1333333333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 6000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5116187049582676, "mean_inference_ms": 1.6784466591469556, "mean_action_processing_ms": 0.07449399945372644, "mean_env_wait_ms": 0.5565626543412321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02334912618001302, "StateBufferConnector_ms": 0.00667572021484375, "ViewRequirementAgentConnector_ms": 0.10190566380818684}, "num_episodes": 10, "episode_return_max": 417.0, "episode_return_min": 290.0, "episode_return_mean": 373.1333333333333}, "env_runner_results": {"episode_reward_max": 417.0, "episode_reward_min": 290.0, "episode_reward_mean": 373.1333333333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 6000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5116187049582676, "mean_inference_ms": 1.6784466591469556, "mean_action_processing_ms": 0.07449399945372644, "mean_env_wait_ms": 0.5565626543412321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02334912618001302, "StateBufferConnector_ms": 0.00667572021484375, "ViewRequirementAgentConnector_ms": 0.10190566380818684}, "num_episodes": 10, "episode_return_max": 417.0, "episode_return_min": 290.0, "episode_return_mean": 373.1333333333333}, "episode_reward_max": 417.0, "episode_reward_min": 290.0, "episode_reward_mean": 373.1333333333333, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 6000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5116187049582676, "mean_inference_ms": 1.6784466591469556, "mean_action_processing_ms": 0.07449399945372644, "mean_env_wait_ms": 0.5565626543412321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02334912618001302, "StateBufferConnector_ms": 0.00667572021484375, "ViewRequirementAgentConnector_ms": 0.10190566380818684}, "num_episodes": 10, "episode_return_max": 417.0, "episode_return_min": 290.0, "episode_return_mean": 373.1333333333333, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.73615145753812, "num_env_steps_trained_throughput_per_sec": 599.5568466412199, "timesteps_total": 6000, "num_env_steps_sampled_lifetime": 6000, "num_agent_steps_sampled_lifetime": 6000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 44026.606, "restore_workers_time_ms": 0.0, "training_step_time_ms": 52.082, "sample_time_ms": 16.973, "load_time_ms": 0.05, "load_throughput": 637008.676, "learn_time_ms": 20.314, "learn_throughput": 1575.253, "synch_weights_time_ms": 6.287}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "last_target_update_ts": 5501, "num_target_updates": 10}, "done": false, "episodes_total": 60, "training_iteration": 6, "trial_id": "default", "date": "2024-05-18_20-37-25", "timestamp": 1716089845, "time_this_iter_s": 53.38426661491394, "time_total_s": 264.2347288131714, "pid": 44624, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002876A119620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 264.2347288131714, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.685333333333332, "ram_util_percent": 35.31066666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7187548875808716, "mean_q": 53.550071716308594, "min_q": -0.6989402770996094, "max_q": 72.59102630615234, "cur_lr": 0.0005}, "td_error": [8.32656478881836, 4.820732116699219, 0.6514778137207031, 0.3010597229003906, -3.4569549560546875, -5.7249298095703125, -7.63502311706543, 3.3194808959960938, 1.6173782348632812, 0.5283851623535156, -3.1556625366210938, 3.3741455078125, 6.279090881347656, 1.5844497680664062, -3.0613327026367188, -6.013309478759766, 1.6739349365234375, 11.554580688476562, 5.775188446044922, 1.1801910400390625, -2.7231903076171875, 3.0683822631835938, 3.449481964111328, 4.251800537109375, -0.6859092712402344, 4.821491241455078, -1.8122329711914062, 3.425464630126953, -1.6099700927734375, -0.2489471435546875, 1.9852828979492188, 0.48244476318359375], "mean_td_error": 1.1357358694076538, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6000.0, "diff_num_grad_updates_vs_sampler_policy": 5999.0}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "last_target_update_ts": 6501, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": 433.0, "episode_reward_min": 290.0, "episode_reward_mean": 375.57142857142856, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 7000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0, 376.0, 392.0, 433.0, 364.0, 384.0, 422.0, 350.0, 392.0, 391.0, 398.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5234909424189239, "mean_inference_ms": 1.7044035537343998, "mean_action_processing_ms": 0.07668209300709423, "mean_env_wait_ms": 0.563644026376341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02429894038609096, "StateBufferConnector_ms": 0.007150173187255859, "ViewRequirementAgentConnector_ms": 0.1066446304321289}, "num_episodes": 10, "episode_return_max": 433.0, "episode_return_min": 290.0, "episode_return_mean": 375.57142857142856}, "env_runner_results": {"episode_reward_max": 433.0, "episode_reward_min": 290.0, "episode_reward_mean": 375.57142857142856, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 7000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0, 376.0, 392.0, 433.0, 364.0, 384.0, 422.0, 350.0, 392.0, 391.0, 398.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5234909424189239, "mean_inference_ms": 1.7044035537343998, "mean_action_processing_ms": 0.07668209300709423, "mean_env_wait_ms": 0.563644026376341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02429894038609096, "StateBufferConnector_ms": 0.007150173187255859, "ViewRequirementAgentConnector_ms": 0.1066446304321289}, "num_episodes": 10, "episode_return_max": 433.0, "episode_return_min": 290.0, "episode_return_mean": 375.57142857142856}, "episode_reward_max": 433.0, "episode_reward_min": 290.0, "episode_reward_mean": 375.57142857142856, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 7000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0, 376.0, 392.0, 433.0, 364.0, 384.0, 422.0, 350.0, 392.0, 391.0, 398.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5234909424189239, "mean_inference_ms": 1.7044035537343998, "mean_action_processing_ms": 0.07668209300709423, "mean_env_wait_ms": 0.563644026376341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02429894038609096, "StateBufferConnector_ms": 0.007150173187255859, "ViewRequirementAgentConnector_ms": 0.1066446304321289}, "num_episodes": 10, "episode_return_max": 433.0, "episode_return_min": 290.0, "episode_return_mean": 375.57142857142856, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.718297957585413, "num_env_steps_trained_throughput_per_sec": 598.9855346427332, "timesteps_total": 7000, "num_env_steps_sampled_lifetime": 7000, "num_agent_steps_sampled_lifetime": 7000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 7000, "timers": {"training_iteration_time_ms": 45369.042, "restore_workers_time_ms": 0.0, "training_step_time_ms": 51.988, "sample_time_ms": 16.363, "load_time_ms": 0.351, "load_throughput": 91161.943, "learn_time_ms": 20.378, "learn_throughput": 1570.314, "synch_weights_time_ms": 5.98}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "last_target_update_ts": 6501, "num_target_updates": 12}, "done": false, "episodes_total": 70, "training_iteration": 7, "trial_id": "default", "date": "2024-05-18_20-38-18", "timestamp": 1716089898, "time_this_iter_s": 53.434672832489014, "time_total_s": 317.6694016456604, "pid": 44624, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002876A119620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 317.6694016456604, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.913157894736845, "ram_util_percent": 35.56447368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.975149929523468, "mean_q": 63.61833953857422, "min_q": 33.67009353637695, "max_q": 87.47158813476562, "cur_lr": 0.0005}, "td_error": [3.8194656372070312, -11.6942138671875, 4.4862518310546875, 5.0332794189453125, -0.5783271789550781, 2.1856422424316406, -1.3330917358398438, 4.983238220214844, 0.6684761047363281, 5.173500061035156, -4.506805419921875, -2.73583984375, -1.0184211730957031, 0.6484146118164062, -3.066547393798828, -0.4736480712890625, -2.4401779174804688, 1.5998039245605469, 0.03870391845703125, -10.861824035644531, 1.8743782043457031, -9.27371597290039, -2.4081077575683594, 4.018352508544922, -2.9511642456054688, -4.630088806152344, -5.132678985595703, 1.1129074096679688, 10.279571533203125, -0.346466064453125, -1.8581924438476562, 0.8971672058105469], "mean_td_error": -0.577817440032959, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7000.0, "diff_num_grad_updates_vs_sampler_policy": 6999.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "last_target_update_ts": 7501, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": 433.0, "episode_reward_min": 290.0, "episode_reward_mean": 374.7875, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0, 376.0, 392.0, 433.0, 364.0, 384.0, 422.0, 350.0, 392.0, 391.0, 398.0, 380.0, 383.0, 333.0, 338.0, 362.0, 361.0, 394.0, 388.0, 355.0, 399.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5326827857749361, "mean_inference_ms": 1.7255025701903512, "mean_action_processing_ms": 0.0783948020301076, "mean_env_wait_ms": 0.5694600747457297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02627164125442505, "StateBufferConnector_ms": 0.006256401538848877, "ViewRequirementAgentConnector_ms": 0.1164749264717102}, "num_episodes": 10, "episode_return_max": 433.0, "episode_return_min": 290.0, "episode_return_mean": 374.7875}, "env_runner_results": {"episode_reward_max": 433.0, "episode_reward_min": 290.0, "episode_reward_mean": 374.7875, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0, 376.0, 392.0, 433.0, 364.0, 384.0, 422.0, 350.0, 392.0, 391.0, 398.0, 380.0, 383.0, 333.0, 338.0, 362.0, 361.0, 394.0, 388.0, 355.0, 399.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5326827857749361, "mean_inference_ms": 1.7255025701903512, "mean_action_processing_ms": 0.0783948020301076, "mean_env_wait_ms": 0.5694600747457297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02627164125442505, "StateBufferConnector_ms": 0.006256401538848877, "ViewRequirementAgentConnector_ms": 0.1164749264717102}, "num_episodes": 10, "episode_return_max": 433.0, "episode_return_min": 290.0, "episode_return_mean": 374.7875}, "episode_reward_max": 433.0, "episode_reward_min": 290.0, "episode_reward_mean": 374.7875, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0, 376.0, 392.0, 433.0, 364.0, 384.0, 422.0, 350.0, 392.0, 391.0, 398.0, 380.0, 383.0, 333.0, 338.0, 362.0, 361.0, 394.0, 388.0, 355.0, 399.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5326827857749361, "mean_inference_ms": 1.7255025701903512, "mean_action_processing_ms": 0.0783948020301076, "mean_env_wait_ms": 0.5694600747457297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02627164125442505, "StateBufferConnector_ms": 0.006256401538848877, "ViewRequirementAgentConnector_ms": 0.1164749264717102}, "num_episodes": 10, "episode_return_max": 433.0, "episode_return_min": 290.0, "episode_return_mean": 374.7875, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.156451049777615, "num_env_steps_trained_throughput_per_sec": 581.0064335928837, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 46582.518, "restore_workers_time_ms": 0.1, "training_step_time_ms": 56.007, "sample_time_ms": 17.875, "load_time_ms": 0.1, "load_throughput": 320099.518, "learn_time_ms": 22.105, "learn_throughput": 1447.614, "synch_weights_time_ms": 6.715}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "last_target_update_ts": 7501, "num_target_updates": 14}, "done": false, "episodes_total": 80, "training_iteration": 8, "trial_id": "default", "date": "2024-05-18_20-39-13", "timestamp": 1716089953, "time_this_iter_s": 55.08786153793335, "time_total_s": 372.75726318359375, "pid": 44624, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002876A119620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 372.75726318359375, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.732051282051277, "ram_util_percent": 35.71153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1135787963867188, "mean_q": 69.86941528320312, "min_q": 56.186363220214844, "max_q": 81.67225646972656, "cur_lr": 0.0005}, "td_error": [-5.603218078613281, 2.423614501953125, -2.7051849365234375, 5.039253234863281, -1.3531723022460938, -1.3843841552734375, -1.6287994384765625, -2.72808837890625, 2.5104637145996094, -2.3227157592773438, -0.25904083251953125, -1.1558876037597656, -1.5704803466796875, 4.30126953125, -14.391220092773438, -3.1195030212402344, -0.06209564208984375, 4.5065765380859375, -3.6396484375, -6.3341827392578125, -2.1874847412109375, -2.0462646484375, 0.81298828125, -16.406150817871094, -1.0192108154296875, -12.865806579589844, -0.9731369018554688, 6.094631195068359, 4.841068267822266, -3.400787353515625, -2.8230133056640625, -1.880950927734375], "mean_td_error": -1.916580080986023, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8000.0, "diff_num_grad_updates_vs_sampler_policy": 7999.0}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "last_target_update_ts": 8501, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": 447.0, "episode_reward_min": 290.0, "episode_reward_mean": 377.81111111111113, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 9000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0, 376.0, 392.0, 433.0, 364.0, 384.0, 422.0, 350.0, 392.0, 391.0, 398.0, 380.0, 383.0, 333.0, 338.0, 362.0, 361.0, 394.0, 388.0, 355.0, 399.0, 410.0, 424.0, 374.0, 393.0, 397.0, 395.0, 447.0, 389.0, 382.0, 409.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5400669099101585, "mean_inference_ms": 1.7431296220068249, "mean_action_processing_ms": 0.07960124113433564, "mean_env_wait_ms": 0.5739040226137208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02613597446017795, "StateBufferConnector_ms": 0.005561245812310113, "ViewRequirementAgentConnector_ms": 0.11594242519802517}, "num_episodes": 10, "episode_return_max": 447.0, "episode_return_min": 290.0, "episode_return_mean": 377.81111111111113}, "env_runner_results": {"episode_reward_max": 447.0, "episode_reward_min": 290.0, "episode_reward_mean": 377.81111111111113, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 9000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0, 376.0, 392.0, 433.0, 364.0, 384.0, 422.0, 350.0, 392.0, 391.0, 398.0, 380.0, 383.0, 333.0, 338.0, 362.0, 361.0, 394.0, 388.0, 355.0, 399.0, 410.0, 424.0, 374.0, 393.0, 397.0, 395.0, 447.0, 389.0, 382.0, 409.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5400669099101585, "mean_inference_ms": 1.7431296220068249, "mean_action_processing_ms": 0.07960124113433564, "mean_env_wait_ms": 0.5739040226137208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02613597446017795, "StateBufferConnector_ms": 0.005561245812310113, "ViewRequirementAgentConnector_ms": 0.11594242519802517}, "num_episodes": 10, "episode_return_max": 447.0, "episode_return_min": 290.0, "episode_return_mean": 377.81111111111113}, "episode_reward_max": 447.0, "episode_reward_min": 290.0, "episode_reward_mean": 377.81111111111113, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 9000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0, 376.0, 392.0, 433.0, 364.0, 384.0, 422.0, 350.0, 392.0, 391.0, 398.0, 380.0, 383.0, 333.0, 338.0, 362.0, 361.0, 394.0, 388.0, 355.0, 399.0, 410.0, 424.0, 374.0, 393.0, 397.0, 395.0, 447.0, 389.0, 382.0, 409.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5400669099101585, "mean_inference_ms": 1.7431296220068249, "mean_action_processing_ms": 0.07960124113433564, "mean_env_wait_ms": 0.5739040226137208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02613597446017795, "StateBufferConnector_ms": 0.005561245812310113, "ViewRequirementAgentConnector_ms": 0.11594242519802517}, "num_episodes": 10, "episode_return_max": 447.0, "episode_return_min": 290.0, "episode_return_mean": 377.81111111111113, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.66273611833791, "num_env_steps_trained_throughput_per_sec": 597.2075557868131, "timesteps_total": 9000, "num_env_steps_sampled_lifetime": 9000, "num_agent_steps_sampled_lifetime": 9000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 47360.317, "restore_workers_time_ms": 0.0, "training_step_time_ms": 51.777, "sample_time_ms": 16.678, "load_time_ms": 0.1, "load_throughput": 320405.175, "learn_time_ms": 19.718, "learn_throughput": 1622.857, "synch_weights_time_ms": 5.707}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "last_target_update_ts": 8501, "num_target_updates": 16}, "done": false, "episodes_total": 90, "training_iteration": 9, "trial_id": "default", "date": "2024-05-18_20-40-07", "timestamp": 1716090007, "time_this_iter_s": 53.5977258682251, "time_total_s": 426.35498905181885, "pid": 44624, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002876A119620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 426.35498905181885, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.672, "ram_util_percent": 35.95066666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0340240001678467, "mean_q": 78.49898529052734, "min_q": -14.71023941040039, "max_q": 97.7608413696289, "cur_lr": 0.0005}, "td_error": [72.9909896850586, 4.426246643066406, 9.944419860839844, -16.71023941040039, 1.6597824096679688, -1.7444534301757812, 1.6868743896484375, -0.5262908935546875, 0.6168365478515625, 3.807342529296875, 0.9731674194335938, -2.38720703125, 5.836662292480469, 6.2273101806640625, -5.3303680419921875, 5.578056335449219, 7.962562561035156, 1.6205062866210938, 5.2890472412109375, 7.029289245605469, -4.382225036621094, 5.328437805175781, -3.84088134765625, 2.0118484497070312, -7.9695587158203125, -1.4437179565429688, 1.04345703125, 6.1516571044921875, 8.290824890136719, -0.8651351928710938, 2.103363037109375, -2.8657913208007812], "mean_td_error": 3.5160255432128906, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9000.0, "diff_num_grad_updates_vs_sampler_policy": 8999.0}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "last_target_update_ts": 9501, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": 447.0, "episode_reward_min": 290.0, "episode_reward_mean": 379.57, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0, 376.0, 392.0, 433.0, 364.0, 384.0, 422.0, 350.0, 392.0, 391.0, 398.0, 380.0, 383.0, 333.0, 338.0, 362.0, 361.0, 394.0, 388.0, 355.0, 399.0, 410.0, 424.0, 374.0, 393.0, 397.0, 395.0, 447.0, 389.0, 382.0, 409.0, 387.0, 393.0, 416.0, 373.0, 379.0, 389.0, 400.0, 394.0, 412.0, 411.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5462453262781579, "mean_inference_ms": 1.7577139812022375, "mean_action_processing_ms": 0.080476243010714, "mean_env_wait_ms": 0.5780699599500173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027522802352905273, "StateBufferConnector_ms": 0.0050051212310791016, "ViewRequirementAgentConnector_ms": 0.12037348747253418}, "num_episodes": 10, "episode_return_max": 447.0, "episode_return_min": 290.0, "episode_return_mean": 379.57}, "env_runner_results": {"episode_reward_max": 447.0, "episode_reward_min": 290.0, "episode_reward_mean": 379.57, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0, 376.0, 392.0, 433.0, 364.0, 384.0, 422.0, 350.0, 392.0, 391.0, 398.0, 380.0, 383.0, 333.0, 338.0, 362.0, 361.0, 394.0, 388.0, 355.0, 399.0, 410.0, 424.0, 374.0, 393.0, 397.0, 395.0, 447.0, 389.0, 382.0, 409.0, 387.0, 393.0, 416.0, 373.0, 379.0, 389.0, 400.0, 394.0, 412.0, 411.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5462453262781579, "mean_inference_ms": 1.7577139812022375, "mean_action_processing_ms": 0.080476243010714, "mean_env_wait_ms": 0.5780699599500173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027522802352905273, "StateBufferConnector_ms": 0.0050051212310791016, "ViewRequirementAgentConnector_ms": 0.12037348747253418}, "num_episodes": 10, "episode_return_max": 447.0, "episode_return_min": 290.0, "episode_return_mean": 379.57}, "episode_reward_max": 447.0, "episode_reward_min": 290.0, "episode_reward_mean": 379.57, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [356.0, 318.0, 374.0, 354.0, 411.0, 290.0, 325.0, 397.0, 372.0, 356.0, 397.0, 365.0, 361.0, 393.0, 367.0, 341.0, 394.0, 329.0, 353.0, 377.0, 414.0, 371.0, 346.0, 359.0, 372.0, 334.0, 398.0, 410.0, 369.0, 394.0, 396.0, 417.0, 361.0, 371.0, 376.0, 356.0, 409.0, 388.0, 415.0, 385.0, 364.0, 340.0, 399.0, 360.0, 389.0, 395.0, 367.0, 390.0, 400.0, 350.0, 383.0, 397.0, 349.0, 406.0, 408.0, 375.0, 378.0, 355.0, 369.0, 343.0, 376.0, 392.0, 433.0, 364.0, 384.0, 422.0, 350.0, 392.0, 391.0, 398.0, 380.0, 383.0, 333.0, 338.0, 362.0, 361.0, 394.0, 388.0, 355.0, 399.0, 410.0, 424.0, 374.0, 393.0, 397.0, 395.0, 447.0, 389.0, 382.0, 409.0, 387.0, 393.0, 416.0, 373.0, 379.0, 389.0, 400.0, 394.0, 412.0, 411.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5462453262781579, "mean_inference_ms": 1.7577139812022375, "mean_action_processing_ms": 0.080476243010714, "mean_env_wait_ms": 0.5780699599500173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027522802352905273, "StateBufferConnector_ms": 0.0050051212310791016, "ViewRequirementAgentConnector_ms": 0.12037348747253418}, "num_episodes": 10, "episode_return_max": 447.0, "episode_return_min": 290.0, "episode_return_mean": 379.57, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.679341903848837, "num_env_steps_trained_throughput_per_sec": 597.7389409231628, "timesteps_total": 10000, "num_env_steps_sampled_lifetime": 10000, "num_agent_steps_sampled_lifetime": 10000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 47977.793, "restore_workers_time_ms": 0.0, "training_step_time_ms": 53.092, "sample_time_ms": 15.899, "load_time_ms": 0.181, "load_throughput": 177021.535, "learn_time_ms": 20.275, "learn_throughput": 1578.323, "synch_weights_time_ms": 6.308}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "last_target_update_ts": 9501, "num_target_updates": 18}, "done": false, "episodes_total": 100, "training_iteration": 10, "trial_id": "default", "date": "2024-05-18_20-41-01", "timestamp": 1716090061, "time_this_iter_s": 53.547590494155884, "time_total_s": 479.90257954597473, "pid": 44624, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000002876A119620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 479.90257954597473, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.88421052631579, "ram_util_percent": 35.90394736842106}}
