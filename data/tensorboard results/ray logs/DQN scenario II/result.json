{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 383.0, "episode_reward_min": 326.0, "episode_reward_mean": 358.6, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36088498560460536, "mean_inference_ms": 1.2629420369059652, "mean_action_processing_ms": 0.049502699525206244, "mean_env_wait_ms": 0.4617527171924755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011112689971923828, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.050928592681884766}, "num_episodes": 10, "episode_return_max": 383.0, "episode_return_min": 326.0, "episode_return_mean": 358.6}, "env_runner_results": {"episode_reward_max": 383.0, "episode_reward_min": 326.0, "episode_reward_mean": 358.6, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36088498560460536, "mean_inference_ms": 1.2629420369059652, "mean_action_processing_ms": 0.049502699525206244, "mean_env_wait_ms": 0.4617527171924755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011112689971923828, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.050928592681884766}, "num_episodes": 10, "episode_return_max": 383.0, "episode_return_min": 326.0, "episode_return_mean": 358.6}, "episode_reward_max": 383.0, "episode_reward_min": 326.0, "episode_reward_mean": 358.6, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 1000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36088498560460536, "mean_inference_ms": 1.2629420369059652, "mean_action_processing_ms": 0.049502699525206244, "mean_env_wait_ms": 0.4617527171924755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011112689971923828, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.050928592681884766}, "num_episodes": 10, "episode_return_max": 383.0, "episode_return_min": 326.0, "episode_return_mean": 358.6, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 280.77678624922726, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000, "num_env_steps_sampled_lifetime": 1000, "num_agent_steps_sampled_lifetime": 1000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000, "timers": {"training_iteration_time_ms": 3561.548, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3.792, "sample_time_ms": 3.692}, "counters": {"num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "default", "date": "2024-05-19_13-31-41", "timestamp": 1716150701, "time_this_iter_s": 3.5625476837158203, "time_total_s": 3.5625476837158203, "pid": 29992, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225B231D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3.5625476837158203, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 9.578571428571427, "ram_util_percent": 30.89285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6787341833114624, "mean_q": 11.423770904541016, "min_q": 5.476433753967285, "max_q": 17.350881576538086, "cur_lr": 0.0005}, "td_error": [-0.3710794448852539, 2.5643510818481445, -4.810807228088379, 1.8897132873535156, 0.35132789611816406, 0.26406097412109375, 2.442241668701172, -1.0980854034423828, 3.4540696144104004, -0.5633983612060547, 2.0255980491638184, 0.21109867095947266, -0.04523658752441406, 0.20806598663330078, -0.5402946472167969, -0.4309234619140625, -0.07531070709228516, -0.5864648818969727, -1.704878807067871, -2.228229522705078, 3.2148303985595703, -3.5686206817626953, -1.115030288696289, 0.6363582611083984, -3.578972816467285, 6.633742332458496, 0.6204361915588379, 0.5295162200927734, -1.9814205169677734, 0.5526103973388672, -2.2180023193359375, -2.10878849029541], "mean_td_error": -0.044610098004341125, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 999.0}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "last_target_update_ts": 1501, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": 385.0, "episode_reward_min": 304.0, "episode_reward_mean": 357.65, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41680889679284283, "mean_inference_ms": 1.4082284427155525, "mean_action_processing_ms": 0.05603279670850273, "mean_env_wait_ms": 0.503413756374552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028085708618164062, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08553743362426758}, "num_episodes": 10, "episode_return_max": 385.0, "episode_return_min": 304.0, "episode_return_mean": 357.65}, "env_runner_results": {"episode_reward_max": 385.0, "episode_reward_min": 304.0, "episode_reward_mean": 357.65, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41680889679284283, "mean_inference_ms": 1.4082284427155525, "mean_action_processing_ms": 0.05603279670850273, "mean_env_wait_ms": 0.503413756374552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028085708618164062, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08553743362426758}, "num_episodes": 10, "episode_return_max": 385.0, "episode_return_min": 304.0, "episode_return_mean": 357.65}, "episode_reward_max": 385.0, "episode_reward_min": 304.0, "episode_reward_mean": 357.65, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 2000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41680889679284283, "mean_inference_ms": 1.4082284427155525, "mean_action_processing_ms": 0.05603279670850273, "mean_env_wait_ms": 0.503413756374552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028085708618164062, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08553743362426758}, "num_episodes": 10, "episode_return_max": 385.0, "episode_return_min": 304.0, "episode_return_mean": 357.65, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 20.60505386276204, "num_env_steps_trained_throughput_per_sec": 659.3617236083853, "timesteps_total": 2000, "num_env_steps_sampled_lifetime": 2000, "num_agent_steps_sampled_lifetime": 2000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 26046.665, "restore_workers_time_ms": 0.0, "training_step_time_ms": 49.514, "sample_time_ms": 16.56, "load_time_ms": 0.3, "load_throughput": 106674.398, "learn_time_ms": 17.611, "learn_throughput": 1817.088, "synch_weights_time_ms": 5.707}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "last_target_update_ts": 1501, "num_target_updates": 2}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "default", "date": "2024-05-19_13-33-03", "timestamp": 1716150783, "time_this_iter_s": 48.54229116439819, "time_total_s": 52.104838848114014, "pid": 29992, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225B231D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 52.104838848114014, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.02241379310345, "ram_util_percent": 31.21379310344827}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8182734251022339, "mean_q": 22.97450065612793, "min_q": 12.48518180847168, "max_q": 34.27816390991211, "cur_lr": 0.0005}, "td_error": [-0.9118385314941406, -2.4998645782470703, -3.4529361724853516, -0.036174774169921875, -2.2223777770996094, 4.083406448364258, 3.087068557739258, -1.473226547241211, 1.8651866912841797, -3.410930633544922, -0.015756607055664062, -1.0616931915283203, -1.068953514099121, 1.701676368713379, -1.3487167358398438, -0.34990882873535156, 0.20769119262695312, -1.2313556671142578, -2.4998645782470703, 0.13695335388183594, 0.1478567123413086, -9.296615600585938, 0.5290737152099609, 2.022632598876953, 2.878335952758789, 2.422454833984375, -2.09161376953125, -1.0420303344726562, 1.3037567138671875, 0.6584758758544922, 0.8495540618896484, 0.09093666076660156], "mean_td_error": -0.37589994072914124, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2000.0, "diff_num_grad_updates_vs_sampler_policy": 1999.0}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "last_target_update_ts": 2501, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": 393.0, "episode_reward_min": 304.0, "episode_reward_mean": 359.8333333333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4505556817127561, "mean_inference_ms": 1.4928093043815889, "mean_action_processing_ms": 0.05971122308029752, "mean_env_wait_ms": 0.5229375589020976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0303951899210612, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09708086649576823}, "num_episodes": 10, "episode_return_max": 393.0, "episode_return_min": 304.0, "episode_return_mean": 359.8333333333333}, "env_runner_results": {"episode_reward_max": 393.0, "episode_reward_min": 304.0, "episode_reward_mean": 359.8333333333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4505556817127561, "mean_inference_ms": 1.4928093043815889, "mean_action_processing_ms": 0.05971122308029752, "mean_env_wait_ms": 0.5229375589020976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0303951899210612, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09708086649576823}, "num_episodes": 10, "episode_return_max": 393.0, "episode_return_min": 304.0, "episode_return_mean": 359.8333333333333}, "episode_reward_max": 393.0, "episode_reward_min": 304.0, "episode_reward_mean": 359.8333333333333, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4505556817127561, "mean_inference_ms": 1.4928093043815889, "mean_action_processing_ms": 0.05971122308029752, "mean_env_wait_ms": 0.5229375589020976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0303951899210612, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09708086649576823}, "num_episodes": 10, "episode_return_max": 393.0, "episode_return_min": 304.0, "episode_return_mean": 359.8333333333333, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.599710122886183, "num_env_steps_trained_throughput_per_sec": 627.1907239323579, "timesteps_total": 3000, "num_env_steps_sampled_lifetime": 3000, "num_agent_steps_sampled_lifetime": 3000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 3000, "timers": {"training_iteration_time_ms": 34371.498, "restore_workers_time_ms": 0.0, "training_step_time_ms": 51.582, "sample_time_ms": 16.992, "load_time_ms": 0.4, "load_throughput": 79901.017, "learn_time_ms": 19.477, "learn_throughput": 1642.924, "synch_weights_time_ms": 6.156}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "last_target_update_ts": 2501, "num_target_updates": 4}, "done": false, "episodes_total": 30, "training_iteration": 3, "trial_id": "default", "date": "2024-05-19_13-34-27", "timestamp": 1716150867, "time_this_iter_s": 51.03067064285278, "time_total_s": 103.1355094909668, "pid": 29992, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225B231D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 103.1355094909668, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.890833333333333, "ram_util_percent": 31.359166666666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8435418009757996, "mean_q": 34.11250686645508, "min_q": -5.5874834060668945, "max_q": 44.910030364990234, "cur_lr": 0.0005}, "td_error": [0.5113143920898438, 2.308032989501953, -2.1759033203125, -2.6729469299316406, -1.6707744598388672, -1.591705322265625, -1.0376625061035156, -0.3013134002685547, 3.8054656982421875, -2.1477088928222656, 0.8956489562988281, -4.5874834060668945, 4.034130096435547, -3.112293243408203, -4.103862762451172, -0.2882957458496094, -0.33636474609375, 1.433431625366211, 1.2656402587890625, -2.3235931396484375, 1.2878036499023438, 0.20930099487304688, 1.7434043884277344, 0.3374176025390625, 3.310861587524414, -1.0529975891113281, -0.27732086181640625, -3.3282814025878906, 3.3344173431396484, -0.6060867309570312, 1.6911582946777344, -0.5339088439941406], "mean_td_error": -0.1868898570537567, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3000.0, "diff_num_grad_updates_vs_sampler_policy": 2999.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "last_target_update_ts": 3501, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": 393.0, "episode_reward_min": 304.0, "episode_reward_mean": 361.775, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4719406281263131, "mean_inference_ms": 1.5458469736395641, "mean_action_processing_ms": 0.06374490470822533, "mean_env_wait_ms": 0.5340793855892363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03156304359436035, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09035170078277588}, "num_episodes": 10, "episode_return_max": 393.0, "episode_return_min": 304.0, "episode_return_mean": 361.775}, "env_runner_results": {"episode_reward_max": 393.0, "episode_reward_min": 304.0, "episode_reward_mean": 361.775, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4719406281263131, "mean_inference_ms": 1.5458469736395641, "mean_action_processing_ms": 0.06374490470822533, "mean_env_wait_ms": 0.5340793855892363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03156304359436035, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09035170078277588}, "num_episodes": 10, "episode_return_max": 393.0, "episode_return_min": 304.0, "episode_return_mean": 361.775}, "episode_reward_max": 393.0, "episode_reward_min": 304.0, "episode_reward_mean": 361.775, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4719406281263131, "mean_inference_ms": 1.5458469736395641, "mean_action_processing_ms": 0.06374490470822533, "mean_env_wait_ms": 0.5340793855892363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03156304359436035, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09035170078277588}, "num_episodes": 10, "episode_return_max": 393.0, "episode_return_min": 304.0, "episode_return_mean": 361.775, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.71497484097481, "num_env_steps_trained_throughput_per_sec": 630.879194911194, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 38459.34, "restore_workers_time_ms": 0.0, "training_step_time_ms": 49.246, "sample_time_ms": 16.412, "load_time_ms": 0.1, "load_throughput": 320023.195, "learn_time_ms": 17.546, "learn_throughput": 1823.769, "synch_weights_time_ms": 6.0}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "last_target_update_ts": 3501, "num_target_updates": 6}, "done": false, "episodes_total": 40, "training_iteration": 4, "trial_id": "default", "date": "2024-05-19_13-35-52", "timestamp": 1716150952, "time_this_iter_s": 50.73638725280762, "time_total_s": 153.8718967437744, "pid": 29992, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225B231D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 153.8718967437744, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.725, "ram_util_percent": 31.419166666666662}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8793227076530457, "mean_q": 43.64286422729492, "min_q": 27.878488540649414, "max_q": 58.14484405517578, "cur_lr": 0.0005}, "td_error": [-1.4445991516113281, -6.985435485839844, -4.637165069580078, 3.5798721313476562, -0.6167182922363281, -1.2853202819824219, 5.3243865966796875, -7.038425445556641, -1.2514152526855469, -2.886028289794922, -1.9102821350097656, -2.7675933837890625, -1.6181564331054688, 1.3668022155761719, 0.4626579284667969, -1.0861778259277344, 1.4053421020507812, -0.5969009399414062, 2.3236312866210938, 2.6422996520996094, 10.047445297241211, -0.8295021057128906, 1.62188720703125, 2.0105438232421875, 1.8902740478515625, -6.718414306640625, -1.2722892761230469, 1.1390419006347656, 2.8425941467285156, 0.9220123291015625, 4.2535858154296875, 2.3651466369628906], "mean_td_error": 0.03915935754776001, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4000.0, "diff_num_grad_updates_vs_sampler_policy": 3999.0}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "last_target_update_ts": 4501, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": 404.0, "episode_reward_min": 304.0, "episode_reward_mean": 363.04, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48739880220778403, "mean_inference_ms": 1.584292324913867, "mean_action_processing_ms": 0.06649489535287825, "mean_env_wait_ms": 0.5434190092895603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031253814697265625, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09031343460083008}, "num_episodes": 10, "episode_return_max": 404.0, "episode_return_min": 304.0, "episode_return_mean": 363.04}, "env_runner_results": {"episode_reward_max": 404.0, "episode_reward_min": 304.0, "episode_reward_mean": 363.04, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48739880220778403, "mean_inference_ms": 1.584292324913867, "mean_action_processing_ms": 0.06649489535287825, "mean_env_wait_ms": 0.5434190092895603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031253814697265625, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09031343460083008}, "num_episodes": 10, "episode_return_max": 404.0, "episode_return_min": 304.0, "episode_return_mean": 363.04}, "episode_reward_max": 404.0, "episode_reward_min": 304.0, "episode_reward_mean": 363.04, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48739880220778403, "mean_inference_ms": 1.584292324913867, "mean_action_processing_ms": 0.06649489535287825, "mean_env_wait_ms": 0.5434190092895603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031253814697265625, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09031343460083008}, "num_episodes": 10, "episode_return_max": 404.0, "episode_return_min": 304.0, "episode_return_mean": 363.04, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.231315563418455, "num_env_steps_trained_throughput_per_sec": 615.4020980293906, "timesteps_total": 5000, "num_env_steps_sampled_lifetime": 5000, "num_agent_steps_sampled_lifetime": 5000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 5000, "timers": {"training_iteration_time_ms": 41167.176, "restore_workers_time_ms": 0.0, "training_step_time_ms": 78.784, "sample_time_ms": 15.184, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 19.448, "learn_throughput": 1645.418, "synch_weights_time_ms": 36.498}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "last_target_update_ts": 4501, "num_target_updates": 8}, "done": false, "episodes_total": 50, "training_iteration": 5, "trial_id": "default", "date": "2024-05-19_13-37-18", "timestamp": 1716151038, "time_this_iter_s": 52.00753974914551, "time_total_s": 205.87943649291992, "pid": 29992, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225B231D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 205.87943649291992, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.003278688524592, "ram_util_percent": 31.428688524590157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4601470232009888, "mean_q": 47.133811950683594, "min_q": 7.748660087585449, "max_q": 65.68717193603516, "cur_lr": 0.0005}, "td_error": [3.1943817138671875, 4.486213684082031, -3.4155540466308594, -1.5223846435546875, 0.19620513916015625, 6.241127014160156, 1.4757881164550781, 2.4670562744140625, 0.12633514404296875, -2.6131362915039062, -1.1233177185058594, -3.856494903564453, 3.464008331298828, 0.1913604736328125, -4.0258941650390625, 3.748660087585449, -3.6093368530273438, -1.1284217834472656, -1.7280769348144531, -1.9984054565429688, -1.1110382080078125, 28.7941951751709, -3.08868408203125, 1.1296577453613281, 0.9638023376464844, -2.4543533325195312, 2.0619049072265625, -0.7150039672851562, -5.7960205078125, 0.19620513916015625, 0.0711669921875, -3.2180328369140625], "mean_td_error": 0.5438723564147949, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5000.0, "diff_num_grad_updates_vs_sampler_policy": 4999.0}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "last_target_update_ts": 5501, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": 410.0, "episode_reward_min": 304.0, "episode_reward_mean": 366.55, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 6000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5007452315636585, "mean_inference_ms": 1.6178887856034017, "mean_action_processing_ms": 0.06812573953073321, "mean_env_wait_ms": 0.5516279199497696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028549035390218098, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09611765543619792}, "num_episodes": 10, "episode_return_max": 410.0, "episode_return_min": 304.0, "episode_return_mean": 366.55}, "env_runner_results": {"episode_reward_max": 410.0, "episode_reward_min": 304.0, "episode_reward_mean": 366.55, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 6000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5007452315636585, "mean_inference_ms": 1.6178887856034017, "mean_action_processing_ms": 0.06812573953073321, "mean_env_wait_ms": 0.5516279199497696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028549035390218098, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09611765543619792}, "num_episodes": 10, "episode_return_max": 410.0, "episode_return_min": 304.0, "episode_return_mean": 366.55}, "episode_reward_max": 410.0, "episode_reward_min": 304.0, "episode_reward_mean": 366.55, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 6000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5007452315636585, "mean_inference_ms": 1.6178887856034017, "mean_action_processing_ms": 0.06812573953073321, "mean_env_wait_ms": 0.5516279199497696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028549035390218098, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09611765543619792}, "num_episodes": 10, "episode_return_max": 410.0, "episode_return_min": 304.0, "episode_return_mean": 366.55, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.646244963128034, "num_env_steps_trained_throughput_per_sec": 596.6798388200971, "timesteps_total": 6000, "num_env_steps_sampled_lifetime": 6000, "num_agent_steps_sampled_lifetime": 6000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 43244.33, "restore_workers_time_ms": 0.0, "training_step_time_ms": 54.65, "sample_time_ms": 15.516, "load_time_ms": 0.2, "load_throughput": 160011.598, "learn_time_ms": 20.211, "learn_throughput": 1583.29, "synch_weights_time_ms": 7.106}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "last_target_update_ts": 5501, "num_target_updates": 10}, "done": false, "episodes_total": 60, "training_iteration": 6, "trial_id": "default", "date": "2024-05-19_13-38-47", "timestamp": 1716151127, "time_this_iter_s": 53.64711785316467, "time_total_s": 259.5265543460846, "pid": 29992, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225B231D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 259.5265543460846, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.0376, "ram_util_percent": 31.425600000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.954617500305176, "mean_q": 60.719200134277344, "min_q": 20.294309616088867, "max_q": 79.08883666992188, "cur_lr": 0.0005}, "td_error": [-1.08294677734375, -0.42071533203125, 2.183856964111328, 4.71435546875, 3.3366317749023438, 6.813690185546875, 0.2564697265625, 2.2246627807617188, 4.812522888183594, 9.322479248046875, -1.8592681884765625, 3.2520599365234375, -2.0259170532226562, 5.675262451171875, 28.62148094177246, -5.2563934326171875, 16.294309616088867, -0.6868476867675781, 6.098598480224609, 4.550178527832031, 1.5760040283203125, 2.8908920288085938, 3.2864761352539062, -1.64202880859375, 2.423065185546875, 7.967521667480469, -0.027835845947265625, 6.324989318847656, 1.4995880126953125, 1.1609268188476562, 0.15988540649414062, 0.6027069091796875], "mean_td_error": 3.532707929611206, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6000.0, "diff_num_grad_updates_vs_sampler_policy": 5999.0}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "last_target_update_ts": 6501, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": 416.0, "episode_reward_min": 304.0, "episode_reward_mean": 369.48571428571427, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 7000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0, 362.0, 407.0, 416.0, 372.0, 386.0, 364.0, 390.0, 396.0, 375.0, 403.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5124628118456976, "mean_inference_ms": 1.646028090104743, "mean_action_processing_ms": 0.06948851003998896, "mean_env_wait_ms": 0.5588006863305213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03377165113176618, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.095259462084089}, "num_episodes": 10, "episode_return_max": 416.0, "episode_return_min": 304.0, "episode_return_mean": 369.48571428571427}, "env_runner_results": {"episode_reward_max": 416.0, "episode_reward_min": 304.0, "episode_reward_mean": 369.48571428571427, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 7000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0, 362.0, 407.0, 416.0, 372.0, 386.0, 364.0, 390.0, 396.0, 375.0, 403.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5124628118456976, "mean_inference_ms": 1.646028090104743, "mean_action_processing_ms": 0.06948851003998896, "mean_env_wait_ms": 0.5588006863305213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03377165113176618, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.095259462084089}, "num_episodes": 10, "episode_return_max": 416.0, "episode_return_min": 304.0, "episode_return_mean": 369.48571428571427}, "episode_reward_max": 416.0, "episode_reward_min": 304.0, "episode_reward_mean": 369.48571428571427, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 7000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0, 362.0, 407.0, 416.0, 372.0, 386.0, 364.0, 390.0, 396.0, 375.0, 403.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5124628118456976, "mean_inference_ms": 1.646028090104743, "mean_action_processing_ms": 0.06948851003998896, "mean_env_wait_ms": 0.5588006863305213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03377165113176618, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.095259462084089}, "num_episodes": 10, "episode_return_max": 416.0, "episode_return_min": 304.0, "episode_return_mean": 369.48571428571427, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.455196578082543, "num_env_steps_trained_throughput_per_sec": 590.5662904986414, "timesteps_total": 7000, "num_env_steps_sampled_lifetime": 7000, "num_agent_steps_sampled_lifetime": 7000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 7000, "timers": {"training_iteration_time_ms": 44807.323, "restore_workers_time_ms": 0.0, "training_step_time_ms": 52.22, "sample_time_ms": 16.667, "load_time_ms": 0.2, "load_throughput": 159783.01, "learn_time_ms": 19.186, "learn_throughput": 1667.869, "synch_weights_time_ms": 6.291}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "last_target_update_ts": 6501, "num_target_updates": 12}, "done": false, "episodes_total": 70, "training_iteration": 7, "trial_id": "default", "date": "2024-05-19_13-40-16", "timestamp": 1716151216, "time_this_iter_s": 54.19728922843933, "time_total_s": 313.7238435745239, "pid": 29992, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225B231D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 313.7238435745239, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.834126984126982, "ram_util_percent": 31.38968253968254}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7336390018463135, "mean_q": 70.9537353515625, "min_q": 55.822998046875, "max_q": 86.73731994628906, "cur_lr": 0.0005}, "td_error": [4.9880828857421875, 54.20264434814453, -0.46118927001953125, -0.44748687744140625, 0.5253143310546875, -1.70831298828125, -4.56671142578125, -2.771331787109375, -0.46016693115234375, -0.28260040283203125, -5.904956817626953, 1.6012115478515625, -3.73126220703125, -4.165367126464844, -5.0558013916015625, 2.9133567810058594, -3.7073745727539062, -1.9322586059570312, -3.4577560424804688, 2.088916778564453, -1.3816452026367188, -2.1808547973632812, -2.208465576171875, -0.582000732421875, -1.69854736328125, 2.564666748046875, -8.543968200683594, -4.796928405761719, -1.6409225463867188, 0.41443634033203125, -1.3767318725585938, -4.3179931640625], "mean_td_error": 0.059937357902526855, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7000.0, "diff_num_grad_updates_vs_sampler_policy": 6999.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "last_target_update_ts": 7501, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": 427.0, "episode_reward_min": 304.0, "episode_reward_mean": 373.45, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0, 362.0, 407.0, 416.0, 372.0, 386.0, 364.0, 390.0, 396.0, 375.0, 403.0, 373.0, 394.0, 427.0, 409.0, 413.0, 369.0, 423.0, 395.0, 390.0, 419.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5226960301905356, "mean_inference_ms": 1.6694710581708183, "mean_action_processing_ms": 0.07054395051220697, "mean_env_wait_ms": 0.5651660190974784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033299922943115234, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09134083986282349}, "num_episodes": 10, "episode_return_max": 427.0, "episode_return_min": 304.0, "episode_return_mean": 373.45}, "env_runner_results": {"episode_reward_max": 427.0, "episode_reward_min": 304.0, "episode_reward_mean": 373.45, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0, 362.0, 407.0, 416.0, 372.0, 386.0, 364.0, 390.0, 396.0, 375.0, 403.0, 373.0, 394.0, 427.0, 409.0, 413.0, 369.0, 423.0, 395.0, 390.0, 419.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5226960301905356, "mean_inference_ms": 1.6694710581708183, "mean_action_processing_ms": 0.07054395051220697, "mean_env_wait_ms": 0.5651660190974784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033299922943115234, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09134083986282349}, "num_episodes": 10, "episode_return_max": 427.0, "episode_return_min": 304.0, "episode_return_mean": 373.45}, "episode_reward_max": 427.0, "episode_reward_min": 304.0, "episode_reward_mean": 373.45, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0, 362.0, 407.0, 416.0, 372.0, 386.0, 364.0, 390.0, 396.0, 375.0, 403.0, 373.0, 394.0, 427.0, 409.0, 413.0, 369.0, 423.0, 395.0, 390.0, 419.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5226960301905356, "mean_inference_ms": 1.6694710581708183, "mean_action_processing_ms": 0.07054395051220697, "mean_env_wait_ms": 0.5651660190974784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033299922943115234, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09134083986282349}, "num_episodes": 10, "episode_return_max": 427.0, "episode_return_min": 304.0, "episode_return_mean": 373.45, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.22974097932815, "num_env_steps_trained_throughput_per_sec": 583.3517113385008, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 46063.335, "restore_workers_time_ms": 0.0, "training_step_time_ms": 55.449, "sample_time_ms": 17.419, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 20.221, "learn_throughput": 1582.523, "synch_weights_time_ms": 7.25}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "last_target_update_ts": 7501, "num_target_updates": 14}, "done": false, "episodes_total": 80, "training_iteration": 8, "trial_id": "default", "date": "2024-05-19_13-41-45", "timestamp": 1716151305, "time_this_iter_s": 54.867433071136475, "time_total_s": 368.5912766456604, "pid": 29992, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225B231D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 368.5912766456604, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.576190476190476, "ram_util_percent": 31.435714285714283}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8696192502975464, "mean_q": 73.91157531738281, "min_q": 10.876937866210938, "max_q": 95.62407684326172, "cur_lr": 0.0005}, "td_error": [8.876937866210938, -2.2505950927734375, -2.4438247680664062, 1.2284774780273438, -0.9494400024414062, -5.970954895019531, 1.0311431884765625, -1.6011199951171875, -7.580513000488281, 2.7430038452148438, 4.671348571777344, -0.6945953369140625, -1.3407974243164062, 5.493679046630859, -5.0578460693359375, 1.8247909545898438, 3.0523529052734375, -1.0381698608398438, -1.2289657592773438, -8.440986633300781, -2.1368255615234375, 1.5426406860351562, 0.1517181396484375, -3.005657196044922, -0.337432861328125, 2.26239013671875, -3.8998031616210938, 2.8690032958984375, -5.682350158691406, 0.11054229736328125, -3.181671142578125, -1.1118621826171875], "mean_td_error": -0.6904807090759277, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8000.0, "diff_num_grad_updates_vs_sampler_policy": 7999.0}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "last_target_update_ts": 8501, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": 427.0, "episode_reward_min": 304.0, "episode_reward_mean": 376.73333333333335, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 9000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0, 362.0, 407.0, 416.0, 372.0, 386.0, 364.0, 390.0, 396.0, 375.0, 403.0, 373.0, 394.0, 427.0, 409.0, 413.0, 369.0, 423.0, 395.0, 390.0, 419.0, 402.0, 401.0, 371.0, 403.0, 426.0, 406.0, 420.0, 397.0, 424.0, 380.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.531694937846822, "mean_inference_ms": 1.6894746871506738, "mean_action_processing_ms": 0.07145893806840584, "mean_env_wait_ms": 0.5705983734897536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03182570139567057, "StateBufferConnector_ms": 0.0011107656690809461, "ViewRequirementAgentConnector_ms": 0.09604083167182074}, "num_episodes": 10, "episode_return_max": 427.0, "episode_return_min": 304.0, "episode_return_mean": 376.73333333333335}, "env_runner_results": {"episode_reward_max": 427.0, "episode_reward_min": 304.0, "episode_reward_mean": 376.73333333333335, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 9000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0, 362.0, 407.0, 416.0, 372.0, 386.0, 364.0, 390.0, 396.0, 375.0, 403.0, 373.0, 394.0, 427.0, 409.0, 413.0, 369.0, 423.0, 395.0, 390.0, 419.0, 402.0, 401.0, 371.0, 403.0, 426.0, 406.0, 420.0, 397.0, 424.0, 380.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.531694937846822, "mean_inference_ms": 1.6894746871506738, "mean_action_processing_ms": 0.07145893806840584, "mean_env_wait_ms": 0.5705983734897536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03182570139567057, "StateBufferConnector_ms": 0.0011107656690809461, "ViewRequirementAgentConnector_ms": 0.09604083167182074}, "num_episodes": 10, "episode_return_max": 427.0, "episode_return_min": 304.0, "episode_return_mean": 376.73333333333335}, "episode_reward_max": 427.0, "episode_reward_min": 304.0, "episode_reward_mean": 376.73333333333335, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 9000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0, 362.0, 407.0, 416.0, 372.0, 386.0, 364.0, 390.0, 396.0, 375.0, 403.0, 373.0, 394.0, 427.0, 409.0, 413.0, 369.0, 423.0, 395.0, 390.0, 419.0, 402.0, 401.0, 371.0, 403.0, 426.0, 406.0, 420.0, 397.0, 424.0, 380.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.531694937846822, "mean_inference_ms": 1.6894746871506738, "mean_action_processing_ms": 0.07145893806840584, "mean_env_wait_ms": 0.5705983734897536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03182570139567057, "StateBufferConnector_ms": 0.0011107656690809461, "ViewRequirementAgentConnector_ms": 0.09604083167182074}, "num_episodes": 10, "episode_return_max": 427.0, "episode_return_min": 304.0, "episode_return_mean": 376.73333333333335, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.334671221448748, "num_env_steps_trained_throughput_per_sec": 586.7094790863599, "timesteps_total": 9000, "num_env_steps_sampled_lifetime": 9000, "num_agent_steps_sampled_lifetime": 9000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 47005.35, "restore_workers_time_ms": 0.0, "training_step_time_ms": 54.667, "sample_time_ms": 16.273, "load_time_ms": 0.1, "load_throughput": 320023.195, "learn_time_ms": 22.024, "learn_throughput": 1452.963, "synch_weights_time_ms": 6.308}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "last_target_update_ts": 8501, "num_target_updates": 16}, "done": false, "episodes_total": 90, "training_iteration": 9, "trial_id": "default", "date": "2024-05-19_13-43-14", "timestamp": 1716151394, "time_this_iter_s": 54.55249047279358, "time_total_s": 423.143767118454, "pid": 29992, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225B231D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 423.143767118454, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.87142857142857, "ram_util_percent": 31.440476190476183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8679859638214111, "mean_q": 83.05535125732422, "min_q": 29.621788024902344, "max_q": 106.31350708007812, "cur_lr": 0.0005}, "td_error": [0.080810546875, -0.8854522705078125, 4.4045562744140625, 3.5703086853027344, 3.31121826171875, 4.724815368652344, 5.599723815917969, 4.67779541015625, -1.0712051391601562, -0.39191436767578125, -4.0479583740234375, -0.7870330810546875, 1.0977783203125, 0.36821746826171875, 4.177848815917969, 0.5192718505859375, 3.4013214111328125, 3.6612701416015625, -14.186912536621094, 4.04180908203125, 2.071990966796875, -2.0960693359375, -2.880706787109375, -3.8798980712890625, 0.870391845703125, 0.8534698486328125, 2.4797744750976562, 0.8563995361328125, -0.2257843017578125, 4.24517822265625, 1.5497817993164062, 3.2632904052734375], "mean_td_error": 0.9179402589797974, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9000.0, "diff_num_grad_updates_vs_sampler_policy": 8999.0}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "last_target_update_ts": 9501, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": 443.0, "episode_reward_min": 304.0, "episode_reward_mean": 379.46, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0, 362.0, 407.0, 416.0, 372.0, 386.0, 364.0, 390.0, 396.0, 375.0, 403.0, 373.0, 394.0, 427.0, 409.0, 413.0, 369.0, 423.0, 395.0, 390.0, 419.0, 402.0, 401.0, 371.0, 403.0, 426.0, 406.0, 420.0, 397.0, 424.0, 380.0, 383.0, 413.0, 414.0, 407.0, 422.0, 378.0, 381.0, 400.0, 443.0, 399.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5394807309225225, "mean_inference_ms": 1.7066750593972073, "mean_action_processing_ms": 0.07231368376899512, "mean_env_wait_ms": 0.5753468422906015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030643463134765625, "StateBufferConnector_ms": 0.0009996891021728516, "ViewRequirementAgentConnector_ms": 0.09744787216186523}, "num_episodes": 10, "episode_return_max": 443.0, "episode_return_min": 304.0, "episode_return_mean": 379.46}, "env_runner_results": {"episode_reward_max": 443.0, "episode_reward_min": 304.0, "episode_reward_mean": 379.46, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0, 362.0, 407.0, 416.0, 372.0, 386.0, 364.0, 390.0, 396.0, 375.0, 403.0, 373.0, 394.0, 427.0, 409.0, 413.0, 369.0, 423.0, 395.0, 390.0, 419.0, 402.0, 401.0, 371.0, 403.0, 426.0, 406.0, 420.0, 397.0, 424.0, 380.0, 383.0, 413.0, 414.0, 407.0, 422.0, 378.0, 381.0, 400.0, 443.0, 399.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5394807309225225, "mean_inference_ms": 1.7066750593972073, "mean_action_processing_ms": 0.07231368376899512, "mean_env_wait_ms": 0.5753468422906015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030643463134765625, "StateBufferConnector_ms": 0.0009996891021728516, "ViewRequirementAgentConnector_ms": 0.09744787216186523}, "num_episodes": 10, "episode_return_max": 443.0, "episode_return_min": 304.0, "episode_return_mean": 379.46}, "episode_reward_max": 443.0, "episode_reward_min": 304.0, "episode_reward_mean": 379.46, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [379.0, 365.0, 383.0, 377.0, 326.0, 340.0, 339.0, 374.0, 335.0, 368.0, 342.0, 385.0, 361.0, 364.0, 344.0, 373.0, 381.0, 366.0, 347.0, 304.0, 363.0, 375.0, 389.0, 366.0, 357.0, 342.0, 343.0, 393.0, 351.0, 363.0, 382.0, 346.0, 359.0, 381.0, 383.0, 351.0, 371.0, 382.0, 349.0, 372.0, 353.0, 348.0, 342.0, 388.0, 352.0, 387.0, 404.0, 383.0, 353.0, 371.0, 375.0, 403.0, 388.0, 397.0, 357.0, 357.0, 410.0, 381.0, 366.0, 407.0, 362.0, 407.0, 416.0, 372.0, 386.0, 364.0, 390.0, 396.0, 375.0, 403.0, 373.0, 394.0, 427.0, 409.0, 413.0, 369.0, 423.0, 395.0, 390.0, 419.0, 402.0, 401.0, 371.0, 403.0, 426.0, 406.0, 420.0, 397.0, 424.0, 380.0, 383.0, 413.0, 414.0, 407.0, 422.0, 378.0, 381.0, 400.0, 443.0, 399.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5394807309225225, "mean_inference_ms": 1.7066750593972073, "mean_action_processing_ms": 0.07231368376899512, "mean_env_wait_ms": 0.5753468422906015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030643463134765625, "StateBufferConnector_ms": 0.0009996891021728516, "ViewRequirementAgentConnector_ms": 0.09744787216186523}, "num_episodes": 10, "episode_return_max": 443.0, "episode_return_min": 304.0, "episode_return_mean": 379.46, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.199591378059527, "num_env_steps_trained_throughput_per_sec": 582.3869240979049, "timesteps_total": 10000, "num_env_steps_sampled_lifetime": 10000, "num_agent_steps_sampled_lifetime": 10000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 47799.444, "restore_workers_time_ms": 0.0, "training_step_time_ms": 56.002, "sample_time_ms": 18.666, "load_time_ms": 0.1, "load_throughput": 319946.908, "learn_time_ms": 21.102, "learn_throughput": 1516.466, "synch_weights_time_ms": 6.726}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "last_target_update_ts": 9501, "num_target_updates": 18}, "done": false, "episodes_total": 100, "training_iteration": 10, "trial_id": "default", "date": "2024-05-19_13-44-43", "timestamp": 1716151483, "time_this_iter_s": 54.9663188457489, "time_total_s": 478.1100859642029, "pid": 29992, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225B231D6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 478.1100859642029, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.98740157480315, "ram_util_percent": 31.45275590551181}}
