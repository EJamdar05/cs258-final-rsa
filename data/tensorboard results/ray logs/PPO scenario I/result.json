{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9297876194920591, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.68599537572553, "policy_loss": -0.20308322282382837, "vf_loss": 9.874365480484501, "vf_explained_var": -0.0012033913084255753, "kl": 0.07356551062636296, "entropy": 2.006991422176361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 399.0, "episode_reward_min": 288.0, "episode_reward_mean": 332.075, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.0, 323.0, 336.0, 339.0, 336.0, 298.0, 341.0, 312.0, 349.0, 344.0, 337.0, 345.0, 336.0, 321.0, 301.0, 326.0, 326.0, 312.0, 339.0, 315.0, 311.0, 376.0, 376.0, 317.0, 399.0, 365.0, 329.0, 298.0, 347.0, 344.0, 348.0, 326.0, 299.0, 328.0, 288.0, 358.0, 295.0, 354.0, 351.0, 332.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13976328315153266, "mean_inference_ms": 0.9529887959528672, "mean_action_processing_ms": 0.0514960890857913, "mean_env_wait_ms": 0.5453651888732224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015012025833129883, "StateBufferConnector_ms": 0.0025075674057006836, "ViewRequirementAgentConnector_ms": 0.0665140151977539}, "num_episodes": 40, "episode_return_max": 399.0, "episode_return_min": 288.0, "episode_return_mean": 332.075}, "env_runner_results": {"episode_reward_max": 399.0, "episode_reward_min": 288.0, "episode_reward_mean": 332.075, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.0, 323.0, 336.0, 339.0, 336.0, 298.0, 341.0, 312.0, 349.0, 344.0, 337.0, 345.0, 336.0, 321.0, 301.0, 326.0, 326.0, 312.0, 339.0, 315.0, 311.0, 376.0, 376.0, 317.0, 399.0, 365.0, 329.0, 298.0, 347.0, 344.0, 348.0, 326.0, 299.0, 328.0, 288.0, 358.0, 295.0, 354.0, 351.0, 332.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13976328315153266, "mean_inference_ms": 0.9529887959528672, "mean_action_processing_ms": 0.0514960890857913, "mean_env_wait_ms": 0.5453651888732224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015012025833129883, "StateBufferConnector_ms": 0.0025075674057006836, "ViewRequirementAgentConnector_ms": 0.0665140151977539}, "num_episodes": 40, "episode_return_max": 399.0, "episode_return_min": 288.0, "episode_return_mean": 332.075}, "episode_reward_max": 399.0, "episode_reward_min": 288.0, "episode_reward_mean": 332.075, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [306.0, 323.0, 336.0, 339.0, 336.0, 298.0, 341.0, 312.0, 349.0, 344.0, 337.0, 345.0, 336.0, 321.0, 301.0, 326.0, 326.0, 312.0, 339.0, 315.0, 311.0, 376.0, 376.0, 317.0, 399.0, 365.0, 329.0, 298.0, 347.0, 344.0, 348.0, 326.0, 299.0, 328.0, 288.0, 358.0, 295.0, 354.0, 351.0, 332.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13976328315153266, "mean_inference_ms": 0.9529887959528672, "mean_action_processing_ms": 0.0514960890857913, "mean_env_wait_ms": 0.5453651888732224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015012025833129883, "StateBufferConnector_ms": 0.0025075674057006836, "ViewRequirementAgentConnector_ms": 0.0665140151977539}, "num_episodes": 40, "episode_return_max": 399.0, "episode_return_min": 288.0, "episode_return_mean": 332.075, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.81333504429537, "num_env_steps_trained_throughput_per_sec": 244.81333504429537, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 16338.979, "restore_workers_time_ms": 0.0, "training_step_time_ms": 16338.979, "sample_time_ms": 6809.211, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 9524.769, "learn_throughput": 419.958, "synch_weights_time_ms": 4.999}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "default", "date": "2024-05-19_13-49-30", "timestamp": 1716151770, "time_this_iter_s": 16.34349226951599, "time_total_s": 16.34349226951599, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16.34349226951599, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 8.270967741935483, "ram_util_percent": 30.861290322580647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6831274450466196, "cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 9.611840867483489, "policy_loss": -0.19525587258970625, "vf_loss": 9.780762233529039, "vf_explained_var": 0.0007050123906904651, "kl": 0.08778175224121666, "entropy": 1.9335469865029857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 399.0, "episode_reward_min": 288.0, "episode_reward_mean": 341.175, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.0, 323.0, 336.0, 339.0, 336.0, 298.0, 341.0, 312.0, 349.0, 344.0, 337.0, 345.0, 336.0, 321.0, 301.0, 326.0, 326.0, 312.0, 339.0, 315.0, 311.0, 376.0, 376.0, 317.0, 399.0, 365.0, 329.0, 298.0, 347.0, 344.0, 348.0, 326.0, 299.0, 328.0, 288.0, 358.0, 295.0, 354.0, 351.0, 332.0, 328.0, 364.0, 376.0, 381.0, 350.0, 329.0, 370.0, 349.0, 374.0, 363.0, 321.0, 337.0, 369.0, 318.0, 347.0, 309.0, 319.0, 348.0, 338.0, 338.0, 345.0, 354.0, 347.0, 348.0, 336.0, 342.0, 352.0, 350.0, 341.0, 354.0, 361.0, 382.0, 388.0, 318.0, 376.0, 363.0, 358.0, 332.0, 384.0, 352.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14052250984388842, "mean_inference_ms": 0.9533590453858103, "mean_action_processing_ms": 0.05141026897957801, "mean_env_wait_ms": 0.5397373725081374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013141334056854248, "StateBufferConnector_ms": 0.00250399112701416, "ViewRequirementAgentConnector_ms": 0.05961477756500244}, "num_episodes": 40, "episode_return_max": 399.0, "episode_return_min": 288.0, "episode_return_mean": 341.175}, "env_runner_results": {"episode_reward_max": 399.0, "episode_reward_min": 288.0, "episode_reward_mean": 341.175, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.0, 323.0, 336.0, 339.0, 336.0, 298.0, 341.0, 312.0, 349.0, 344.0, 337.0, 345.0, 336.0, 321.0, 301.0, 326.0, 326.0, 312.0, 339.0, 315.0, 311.0, 376.0, 376.0, 317.0, 399.0, 365.0, 329.0, 298.0, 347.0, 344.0, 348.0, 326.0, 299.0, 328.0, 288.0, 358.0, 295.0, 354.0, 351.0, 332.0, 328.0, 364.0, 376.0, 381.0, 350.0, 329.0, 370.0, 349.0, 374.0, 363.0, 321.0, 337.0, 369.0, 318.0, 347.0, 309.0, 319.0, 348.0, 338.0, 338.0, 345.0, 354.0, 347.0, 348.0, 336.0, 342.0, 352.0, 350.0, 341.0, 354.0, 361.0, 382.0, 388.0, 318.0, 376.0, 363.0, 358.0, 332.0, 384.0, 352.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14052250984388842, "mean_inference_ms": 0.9533590453858103, "mean_action_processing_ms": 0.05141026897957801, "mean_env_wait_ms": 0.5397373725081374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013141334056854248, "StateBufferConnector_ms": 0.00250399112701416, "ViewRequirementAgentConnector_ms": 0.05961477756500244}, "num_episodes": 40, "episode_return_max": 399.0, "episode_return_min": 288.0, "episode_return_mean": 341.175}, "episode_reward_max": 399.0, "episode_reward_min": 288.0, "episode_reward_mean": 341.175, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [306.0, 323.0, 336.0, 339.0, 336.0, 298.0, 341.0, 312.0, 349.0, 344.0, 337.0, 345.0, 336.0, 321.0, 301.0, 326.0, 326.0, 312.0, 339.0, 315.0, 311.0, 376.0, 376.0, 317.0, 399.0, 365.0, 329.0, 298.0, 347.0, 344.0, 348.0, 326.0, 299.0, 328.0, 288.0, 358.0, 295.0, 354.0, 351.0, 332.0, 328.0, 364.0, 376.0, 381.0, 350.0, 329.0, 370.0, 349.0, 374.0, 363.0, 321.0, 337.0, 369.0, 318.0, 347.0, 309.0, 319.0, 348.0, 338.0, 338.0, 345.0, 354.0, 347.0, 348.0, 336.0, 342.0, 352.0, 350.0, 341.0, 354.0, 361.0, 382.0, 388.0, 318.0, 376.0, 363.0, 358.0, 332.0, 384.0, 352.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14052250984388842, "mean_inference_ms": 0.9533590453858103, "mean_action_processing_ms": 0.05141026897957801, "mean_env_wait_ms": 0.5397373725081374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013141334056854248, "StateBufferConnector_ms": 0.00250399112701416, "ViewRequirementAgentConnector_ms": 0.05961477756500244}, "num_episodes": 40, "episode_return_max": 399.0, "episode_return_min": 288.0, "episode_return_mean": 341.175, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.36502412332536, "num_env_steps_trained_throughput_per_sec": 244.36502412332536, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 16353.967, "restore_workers_time_ms": 0.0, "training_step_time_ms": 16353.967, "sample_time_ms": 6762.922, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 9584.792, "learn_throughput": 417.328, "synch_weights_time_ms": 6.253}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 80, "training_iteration": 2, "trial_id": "default", "date": "2024-05-19_13-50-07", "timestamp": 1716151807, "time_this_iter_s": 16.374461889266968, "time_total_s": 32.71795415878296, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 32.71795415878296, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 8.848148148148148, "ram_util_percent": 31.085185185185175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5051745221179018, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 9.610600540202151, "policy_loss": -0.20472701095565352, "vf_loss": 9.785281341306625, "vf_explained_var": -0.0017654179885823239, "kl": 0.06676928149139764, "entropy": 1.9030132816683862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 399.0, "episode_reward_min": 271.0, "episode_reward_mean": 348.21, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.0, 376.0, 376.0, 317.0, 399.0, 365.0, 329.0, 298.0, 347.0, 344.0, 348.0, 326.0, 299.0, 328.0, 288.0, 358.0, 295.0, 354.0, 351.0, 332.0, 328.0, 364.0, 376.0, 381.0, 350.0, 329.0, 370.0, 349.0, 374.0, 363.0, 321.0, 337.0, 369.0, 318.0, 347.0, 309.0, 319.0, 348.0, 338.0, 338.0, 345.0, 354.0, 347.0, 348.0, 336.0, 342.0, 352.0, 350.0, 341.0, 354.0, 361.0, 382.0, 388.0, 318.0, 376.0, 363.0, 358.0, 332.0, 384.0, 352.0, 355.0, 314.0, 347.0, 357.0, 336.0, 347.0, 379.0, 359.0, 357.0, 343.0, 357.0, 312.0, 364.0, 346.0, 362.0, 375.0, 351.0, 391.0, 271.0, 345.0, 346.0, 373.0, 347.0, 323.0, 375.0, 357.0, 369.0, 383.0, 297.0, 344.0, 347.0, 372.0, 389.0, 347.0, 392.0, 369.0, 335.0, 335.0, 378.0, 323.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14103991659728862, "mean_inference_ms": 0.9547612576689548, "mean_action_processing_ms": 0.05138344033681244, "mean_env_wait_ms": 0.5369879383805451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013535499572753906, "StateBufferConnector_ms": 0.0020012855529785156, "ViewRequirementAgentConnector_ms": 0.06004977226257324}, "num_episodes": 40, "episode_return_max": 399.0, "episode_return_min": 271.0, "episode_return_mean": 348.21}, "env_runner_results": {"episode_reward_max": 399.0, "episode_reward_min": 271.0, "episode_reward_mean": 348.21, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.0, 376.0, 376.0, 317.0, 399.0, 365.0, 329.0, 298.0, 347.0, 344.0, 348.0, 326.0, 299.0, 328.0, 288.0, 358.0, 295.0, 354.0, 351.0, 332.0, 328.0, 364.0, 376.0, 381.0, 350.0, 329.0, 370.0, 349.0, 374.0, 363.0, 321.0, 337.0, 369.0, 318.0, 347.0, 309.0, 319.0, 348.0, 338.0, 338.0, 345.0, 354.0, 347.0, 348.0, 336.0, 342.0, 352.0, 350.0, 341.0, 354.0, 361.0, 382.0, 388.0, 318.0, 376.0, 363.0, 358.0, 332.0, 384.0, 352.0, 355.0, 314.0, 347.0, 357.0, 336.0, 347.0, 379.0, 359.0, 357.0, 343.0, 357.0, 312.0, 364.0, 346.0, 362.0, 375.0, 351.0, 391.0, 271.0, 345.0, 346.0, 373.0, 347.0, 323.0, 375.0, 357.0, 369.0, 383.0, 297.0, 344.0, 347.0, 372.0, 389.0, 347.0, 392.0, 369.0, 335.0, 335.0, 378.0, 323.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14103991659728862, "mean_inference_ms": 0.9547612576689548, "mean_action_processing_ms": 0.05138344033681244, "mean_env_wait_ms": 0.5369879383805451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013535499572753906, "StateBufferConnector_ms": 0.0020012855529785156, "ViewRequirementAgentConnector_ms": 0.06004977226257324}, "num_episodes": 40, "episode_return_max": 399.0, "episode_return_min": 271.0, "episode_return_mean": 348.21}, "episode_reward_max": 399.0, "episode_reward_min": 271.0, "episode_reward_mean": 348.21, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [311.0, 376.0, 376.0, 317.0, 399.0, 365.0, 329.0, 298.0, 347.0, 344.0, 348.0, 326.0, 299.0, 328.0, 288.0, 358.0, 295.0, 354.0, 351.0, 332.0, 328.0, 364.0, 376.0, 381.0, 350.0, 329.0, 370.0, 349.0, 374.0, 363.0, 321.0, 337.0, 369.0, 318.0, 347.0, 309.0, 319.0, 348.0, 338.0, 338.0, 345.0, 354.0, 347.0, 348.0, 336.0, 342.0, 352.0, 350.0, 341.0, 354.0, 361.0, 382.0, 388.0, 318.0, 376.0, 363.0, 358.0, 332.0, 384.0, 352.0, 355.0, 314.0, 347.0, 357.0, 336.0, 347.0, 379.0, 359.0, 357.0, 343.0, 357.0, 312.0, 364.0, 346.0, 362.0, 375.0, 351.0, 391.0, 271.0, 345.0, 346.0, 373.0, 347.0, 323.0, 375.0, 357.0, 369.0, 383.0, 297.0, 344.0, 347.0, 372.0, 389.0, 347.0, 392.0, 369.0, 335.0, 335.0, 378.0, 323.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14103991659728862, "mean_inference_ms": 0.9547612576689548, "mean_action_processing_ms": 0.05138344033681244, "mean_env_wait_ms": 0.5369879383805451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013535499572753906, "StateBufferConnector_ms": 0.0020012855529785156, "ViewRequirementAgentConnector_ms": 0.06004977226257324}, "num_episodes": 40, "episode_return_max": 399.0, "episode_return_min": 271.0, "episode_return_mean": 348.21, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.46537559874088, "num_env_steps_trained_throughput_per_sec": 238.46537559874088, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 16493.953, "restore_workers_time_ms": 0.0, "training_step_time_ms": 16493.953, "sample_time_ms": 6780.966, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 9706.649, "learn_throughput": 412.089, "synch_weights_time_ms": 6.338}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 120, "training_iteration": 3, "trial_id": "default", "date": "2024-05-19_13-51-33", "timestamp": 1716151893, "time_this_iter_s": 16.77992606163025, "time_total_s": 49.49788022041321, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 49.49788022041321, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 21.149586776859508, "ram_util_percent": 31.970247933884295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9993117892613974, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 9.580634966204244, "policy_loss": -0.19713413972427607, "vf_loss": 9.73577219747728, "vf_explained_var": 0.0029112081373891523, "kl": 0.06221763135402104, "entropy": 1.903563258981192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 402.0, "episode_reward_min": 271.0, "episode_reward_mean": 349.69, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [345.0, 354.0, 347.0, 348.0, 336.0, 342.0, 352.0, 350.0, 341.0, 354.0, 361.0, 382.0, 388.0, 318.0, 376.0, 363.0, 358.0, 332.0, 384.0, 352.0, 355.0, 314.0, 347.0, 357.0, 336.0, 347.0, 379.0, 359.0, 357.0, 343.0, 357.0, 312.0, 364.0, 346.0, 362.0, 375.0, 351.0, 391.0, 271.0, 345.0, 346.0, 373.0, 347.0, 323.0, 375.0, 357.0, 369.0, 383.0, 297.0, 344.0, 347.0, 372.0, 389.0, 347.0, 392.0, 369.0, 335.0, 335.0, 378.0, 323.0, 330.0, 359.0, 339.0, 324.0, 308.0, 342.0, 344.0, 346.0, 360.0, 312.0, 402.0, 310.0, 387.0, 355.0, 382.0, 327.0, 373.0, 333.0, 352.0, 315.0, 377.0, 359.0, 291.0, 293.0, 333.0, 369.0, 344.0, 370.0, 329.0, 310.0, 324.0, 392.0, 330.0, 371.0, 376.0, 342.0, 376.0, 357.0, 359.0, 315.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14174535072181668, "mean_inference_ms": 0.9555584664730625, "mean_action_processing_ms": 0.05083722544649636, "mean_env_wait_ms": 0.5365648627420316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013540506362915039, "StateBufferConnector_ms": 0.001001119613647461, "ViewRequirementAgentConnector_ms": 0.05077838897705078}, "num_episodes": 40, "episode_return_max": 402.0, "episode_return_min": 271.0, "episode_return_mean": 349.69}, "env_runner_results": {"episode_reward_max": 402.0, "episode_reward_min": 271.0, "episode_reward_mean": 349.69, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [345.0, 354.0, 347.0, 348.0, 336.0, 342.0, 352.0, 350.0, 341.0, 354.0, 361.0, 382.0, 388.0, 318.0, 376.0, 363.0, 358.0, 332.0, 384.0, 352.0, 355.0, 314.0, 347.0, 357.0, 336.0, 347.0, 379.0, 359.0, 357.0, 343.0, 357.0, 312.0, 364.0, 346.0, 362.0, 375.0, 351.0, 391.0, 271.0, 345.0, 346.0, 373.0, 347.0, 323.0, 375.0, 357.0, 369.0, 383.0, 297.0, 344.0, 347.0, 372.0, 389.0, 347.0, 392.0, 369.0, 335.0, 335.0, 378.0, 323.0, 330.0, 359.0, 339.0, 324.0, 308.0, 342.0, 344.0, 346.0, 360.0, 312.0, 402.0, 310.0, 387.0, 355.0, 382.0, 327.0, 373.0, 333.0, 352.0, 315.0, 377.0, 359.0, 291.0, 293.0, 333.0, 369.0, 344.0, 370.0, 329.0, 310.0, 324.0, 392.0, 330.0, 371.0, 376.0, 342.0, 376.0, 357.0, 359.0, 315.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14174535072181668, "mean_inference_ms": 0.9555584664730625, "mean_action_processing_ms": 0.05083722544649636, "mean_env_wait_ms": 0.5365648627420316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013540506362915039, "StateBufferConnector_ms": 0.001001119613647461, "ViewRequirementAgentConnector_ms": 0.05077838897705078}, "num_episodes": 40, "episode_return_max": 402.0, "episode_return_min": 271.0, "episode_return_mean": 349.69}, "episode_reward_max": 402.0, "episode_reward_min": 271.0, "episode_reward_mean": 349.69, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [345.0, 354.0, 347.0, 348.0, 336.0, 342.0, 352.0, 350.0, 341.0, 354.0, 361.0, 382.0, 388.0, 318.0, 376.0, 363.0, 358.0, 332.0, 384.0, 352.0, 355.0, 314.0, 347.0, 357.0, 336.0, 347.0, 379.0, 359.0, 357.0, 343.0, 357.0, 312.0, 364.0, 346.0, 362.0, 375.0, 351.0, 391.0, 271.0, 345.0, 346.0, 373.0, 347.0, 323.0, 375.0, 357.0, 369.0, 383.0, 297.0, 344.0, 347.0, 372.0, 389.0, 347.0, 392.0, 369.0, 335.0, 335.0, 378.0, 323.0, 330.0, 359.0, 339.0, 324.0, 308.0, 342.0, 344.0, 346.0, 360.0, 312.0, 402.0, 310.0, 387.0, 355.0, 382.0, 327.0, 373.0, 333.0, 352.0, 315.0, 377.0, 359.0, 291.0, 293.0, 333.0, 369.0, 344.0, 370.0, 329.0, 310.0, 324.0, 392.0, 330.0, 371.0, 376.0, 342.0, 376.0, 357.0, 359.0, 315.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14174535072181668, "mean_inference_ms": 0.9555584664730625, "mean_action_processing_ms": 0.05083722544649636, "mean_env_wait_ms": 0.5365648627420316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013540506362915039, "StateBufferConnector_ms": 0.001001119613647461, "ViewRequirementAgentConnector_ms": 0.05077838897705078}, "num_episodes": 40, "episode_return_max": 402.0, "episode_return_min": 271.0, "episode_return_mean": 349.69, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.59282643930013, "num_env_steps_trained_throughput_per_sec": 238.59282643930013, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 16561.705, "restore_workers_time_ms": 0.0, "training_step_time_ms": 16561.705, "sample_time_ms": 6784.483, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 9771.092, "learn_throughput": 409.371, "synch_weights_time_ms": 6.004}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 160, "training_iteration": 4, "trial_id": "default", "date": "2024-05-19_13-53-00", "timestamp": 1716151980, "time_this_iter_s": 16.770973920822144, "time_total_s": 66.26885414123535, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 66.26885414123535, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 20.90813008130081, "ram_util_percent": 32.20650406504064}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.267834885722847, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 9.57990430298672, "policy_loss": -0.1971801081997773, "vf_loss": 9.72861354684317, "vf_explained_var": 0.0019353906954488447, "kl": 0.047872498180881524, "entropy": 1.8991153062030832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 404.0, "episode_reward_min": 291.0, "episode_reward_mean": 347.02, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [346.0, 373.0, 347.0, 323.0, 375.0, 357.0, 369.0, 383.0, 297.0, 344.0, 347.0, 372.0, 389.0, 347.0, 392.0, 369.0, 335.0, 335.0, 378.0, 323.0, 330.0, 359.0, 339.0, 324.0, 308.0, 342.0, 344.0, 346.0, 360.0, 312.0, 402.0, 310.0, 387.0, 355.0, 382.0, 327.0, 373.0, 333.0, 352.0, 315.0, 377.0, 359.0, 291.0, 293.0, 333.0, 369.0, 344.0, 370.0, 329.0, 310.0, 324.0, 392.0, 330.0, 371.0, 376.0, 342.0, 376.0, 357.0, 359.0, 315.0, 331.0, 404.0, 331.0, 360.0, 344.0, 367.0, 352.0, 316.0, 381.0, 324.0, 357.0, 359.0, 335.0, 325.0, 355.0, 352.0, 392.0, 344.0, 344.0, 337.0, 330.0, 351.0, 340.0, 339.0, 292.0, 333.0, 345.0, 352.0, 358.0, 339.0, 346.0, 361.0, 362.0, 358.0, 293.0, 326.0, 319.0, 321.0, 390.0, 319.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1417192949069195, "mean_inference_ms": 0.9554692219177195, "mean_action_processing_ms": 0.05047392530684324, "mean_env_wait_ms": 0.5386575821443412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01303720474243164, "StateBufferConnector_ms": 0.003006458282470703, "ViewRequirementAgentConnector_ms": 0.05504441261291504}, "num_episodes": 40, "episode_return_max": 404.0, "episode_return_min": 291.0, "episode_return_mean": 347.02}, "env_runner_results": {"episode_reward_max": 404.0, "episode_reward_min": 291.0, "episode_reward_mean": 347.02, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [346.0, 373.0, 347.0, 323.0, 375.0, 357.0, 369.0, 383.0, 297.0, 344.0, 347.0, 372.0, 389.0, 347.0, 392.0, 369.0, 335.0, 335.0, 378.0, 323.0, 330.0, 359.0, 339.0, 324.0, 308.0, 342.0, 344.0, 346.0, 360.0, 312.0, 402.0, 310.0, 387.0, 355.0, 382.0, 327.0, 373.0, 333.0, 352.0, 315.0, 377.0, 359.0, 291.0, 293.0, 333.0, 369.0, 344.0, 370.0, 329.0, 310.0, 324.0, 392.0, 330.0, 371.0, 376.0, 342.0, 376.0, 357.0, 359.0, 315.0, 331.0, 404.0, 331.0, 360.0, 344.0, 367.0, 352.0, 316.0, 381.0, 324.0, 357.0, 359.0, 335.0, 325.0, 355.0, 352.0, 392.0, 344.0, 344.0, 337.0, 330.0, 351.0, 340.0, 339.0, 292.0, 333.0, 345.0, 352.0, 358.0, 339.0, 346.0, 361.0, 362.0, 358.0, 293.0, 326.0, 319.0, 321.0, 390.0, 319.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1417192949069195, "mean_inference_ms": 0.9554692219177195, "mean_action_processing_ms": 0.05047392530684324, "mean_env_wait_ms": 0.5386575821443412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01303720474243164, "StateBufferConnector_ms": 0.003006458282470703, "ViewRequirementAgentConnector_ms": 0.05504441261291504}, "num_episodes": 40, "episode_return_max": 404.0, "episode_return_min": 291.0, "episode_return_mean": 347.02}, "episode_reward_max": 404.0, "episode_reward_min": 291.0, "episode_reward_mean": 347.02, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [346.0, 373.0, 347.0, 323.0, 375.0, 357.0, 369.0, 383.0, 297.0, 344.0, 347.0, 372.0, 389.0, 347.0, 392.0, 369.0, 335.0, 335.0, 378.0, 323.0, 330.0, 359.0, 339.0, 324.0, 308.0, 342.0, 344.0, 346.0, 360.0, 312.0, 402.0, 310.0, 387.0, 355.0, 382.0, 327.0, 373.0, 333.0, 352.0, 315.0, 377.0, 359.0, 291.0, 293.0, 333.0, 369.0, 344.0, 370.0, 329.0, 310.0, 324.0, 392.0, 330.0, 371.0, 376.0, 342.0, 376.0, 357.0, 359.0, 315.0, 331.0, 404.0, 331.0, 360.0, 344.0, 367.0, 352.0, 316.0, 381.0, 324.0, 357.0, 359.0, 335.0, 325.0, 355.0, 352.0, 392.0, 344.0, 344.0, 337.0, 330.0, 351.0, 340.0, 339.0, 292.0, 333.0, 345.0, 352.0, 358.0, 339.0, 346.0, 361.0, 362.0, 358.0, 293.0, 326.0, 319.0, 321.0, 390.0, 319.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1417192949069195, "mean_inference_ms": 0.9554692219177195, "mean_action_processing_ms": 0.05047392530684324, "mean_env_wait_ms": 0.5386575821443412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01303720474243164, "StateBufferConnector_ms": 0.003006458282470703, "ViewRequirementAgentConnector_ms": 0.05504441261291504}, "num_episodes": 40, "episode_return_max": 404.0, "episode_return_min": 291.0, "episode_return_mean": 347.02, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.50340580677076, "num_env_steps_trained_throughput_per_sec": 235.50340580677076, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 16646.343, "restore_workers_time_ms": 0.0, "training_step_time_ms": 16646.143, "sample_time_ms": 6785.423, "load_time_ms": 0.2, "load_throughput": 20006219.89, "learn_time_ms": 9854.616, "learn_throughput": 405.901, "synch_weights_time_ms": 5.803}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 200, "training_iteration": 5, "trial_id": "default", "date": "2024-05-19_13-54-29", "timestamp": 1716152069, "time_this_iter_s": 16.991907119750977, "time_total_s": 83.26076126098633, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 83.26076126098633, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.796031746031748, "ram_util_percent": 32.259523809523806}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.015586522894521, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 9.675950845082602, "policy_loss": -0.20191846500896918, "vf_loss": 9.829658574955438, "vf_explained_var": 0.0007326747140576763, "kl": 0.031743708883159444, "entropy": 1.9050258205782982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 405.0, "episode_reward_min": 291.0, "episode_reward_mean": 347.35, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [377.0, 359.0, 291.0, 293.0, 333.0, 369.0, 344.0, 370.0, 329.0, 310.0, 324.0, 392.0, 330.0, 371.0, 376.0, 342.0, 376.0, 357.0, 359.0, 315.0, 331.0, 404.0, 331.0, 360.0, 344.0, 367.0, 352.0, 316.0, 381.0, 324.0, 357.0, 359.0, 335.0, 325.0, 355.0, 352.0, 392.0, 344.0, 344.0, 337.0, 330.0, 351.0, 340.0, 339.0, 292.0, 333.0, 345.0, 352.0, 358.0, 339.0, 346.0, 361.0, 362.0, 358.0, 293.0, 326.0, 319.0, 321.0, 390.0, 319.0, 342.0, 352.0, 325.0, 341.0, 364.0, 381.0, 330.0, 333.0, 368.0, 360.0, 371.0, 345.0, 334.0, 355.0, 335.0, 358.0, 370.0, 311.0, 383.0, 365.0, 343.0, 367.0, 373.0, 309.0, 344.0, 321.0, 329.0, 402.0, 405.0, 363.0, 298.0, 368.0, 334.0, 361.0, 316.0, 341.0, 351.0, 377.0, 370.0, 339.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14148636394427697, "mean_inference_ms": 0.9555017003730762, "mean_action_processing_ms": 0.050522850695349175, "mean_env_wait_ms": 0.5395889632423703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070095062255859375, "StateBufferConnector_ms": 0.004006147384643555, "ViewRequirementAgentConnector_ms": 0.0542147159576416}, "num_episodes": 40, "episode_return_max": 405.0, "episode_return_min": 291.0, "episode_return_mean": 347.35}, "env_runner_results": {"episode_reward_max": 405.0, "episode_reward_min": 291.0, "episode_reward_mean": 347.35, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [377.0, 359.0, 291.0, 293.0, 333.0, 369.0, 344.0, 370.0, 329.0, 310.0, 324.0, 392.0, 330.0, 371.0, 376.0, 342.0, 376.0, 357.0, 359.0, 315.0, 331.0, 404.0, 331.0, 360.0, 344.0, 367.0, 352.0, 316.0, 381.0, 324.0, 357.0, 359.0, 335.0, 325.0, 355.0, 352.0, 392.0, 344.0, 344.0, 337.0, 330.0, 351.0, 340.0, 339.0, 292.0, 333.0, 345.0, 352.0, 358.0, 339.0, 346.0, 361.0, 362.0, 358.0, 293.0, 326.0, 319.0, 321.0, 390.0, 319.0, 342.0, 352.0, 325.0, 341.0, 364.0, 381.0, 330.0, 333.0, 368.0, 360.0, 371.0, 345.0, 334.0, 355.0, 335.0, 358.0, 370.0, 311.0, 383.0, 365.0, 343.0, 367.0, 373.0, 309.0, 344.0, 321.0, 329.0, 402.0, 405.0, 363.0, 298.0, 368.0, 334.0, 361.0, 316.0, 341.0, 351.0, 377.0, 370.0, 339.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14148636394427697, "mean_inference_ms": 0.9555017003730762, "mean_action_processing_ms": 0.050522850695349175, "mean_env_wait_ms": 0.5395889632423703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070095062255859375, "StateBufferConnector_ms": 0.004006147384643555, "ViewRequirementAgentConnector_ms": 0.0542147159576416}, "num_episodes": 40, "episode_return_max": 405.0, "episode_return_min": 291.0, "episode_return_mean": 347.35}, "episode_reward_max": 405.0, "episode_reward_min": 291.0, "episode_reward_mean": 347.35, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [377.0, 359.0, 291.0, 293.0, 333.0, 369.0, 344.0, 370.0, 329.0, 310.0, 324.0, 392.0, 330.0, 371.0, 376.0, 342.0, 376.0, 357.0, 359.0, 315.0, 331.0, 404.0, 331.0, 360.0, 344.0, 367.0, 352.0, 316.0, 381.0, 324.0, 357.0, 359.0, 335.0, 325.0, 355.0, 352.0, 392.0, 344.0, 344.0, 337.0, 330.0, 351.0, 340.0, 339.0, 292.0, 333.0, 345.0, 352.0, 358.0, 339.0, 346.0, 361.0, 362.0, 358.0, 293.0, 326.0, 319.0, 321.0, 390.0, 319.0, 342.0, 352.0, 325.0, 341.0, 364.0, 381.0, 330.0, 333.0, 368.0, 360.0, 371.0, 345.0, 334.0, 355.0, 335.0, 358.0, 370.0, 311.0, 383.0, 365.0, 343.0, 367.0, 373.0, 309.0, 344.0, 321.0, 329.0, 402.0, 405.0, 363.0, 298.0, 368.0, 334.0, 361.0, 316.0, 341.0, 351.0, 377.0, 370.0, 339.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14148636394427697, "mean_inference_ms": 0.9555017003730762, "mean_action_processing_ms": 0.050522850695349175, "mean_env_wait_ms": 0.5395889632423703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070095062255859375, "StateBufferConnector_ms": 0.004006147384643555, "ViewRequirementAgentConnector_ms": 0.0542147159576416}, "num_episodes": 40, "episode_return_max": 405.0, "episode_return_min": 291.0, "episode_return_mean": 347.35, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.8549113829844, "num_env_steps_trained_throughput_per_sec": 235.8549113829844, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 16698.549, "restore_workers_time_ms": 0.0, "training_step_time_ms": 16698.382, "sample_time_ms": 6790.641, "load_time_ms": 0.333, "load_throughput": 12009460.272, "learn_time_ms": 9901.488, "learn_throughput": 403.98, "synch_weights_time_ms": 5.836}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 240, "training_iteration": 6, "trial_id": "default", "date": "2024-05-19_13-55-58", "timestamp": 1716152158, "time_this_iter_s": 16.967085361480713, "time_total_s": 100.22784662246704, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 100.22784662246704, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.285714285714292, "ram_util_percent": 32.31904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0721475023095324, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.647893851290467, "policy_loss": -0.17997198116524965, "vf_loss": 9.751352548086516, "vf_explained_var": -0.01021709922821291, "kl": 0.03358608090452444, "entropy": 1.9027114341335911, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 405.0, "episode_reward_min": 292.0, "episode_reward_mean": 350.18, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.0, 351.0, 340.0, 339.0, 292.0, 333.0, 345.0, 352.0, 358.0, 339.0, 346.0, 361.0, 362.0, 358.0, 293.0, 326.0, 319.0, 321.0, 390.0, 319.0, 342.0, 352.0, 325.0, 341.0, 364.0, 381.0, 330.0, 333.0, 368.0, 360.0, 371.0, 345.0, 334.0, 355.0, 335.0, 358.0, 370.0, 311.0, 383.0, 365.0, 343.0, 367.0, 373.0, 309.0, 344.0, 321.0, 329.0, 402.0, 405.0, 363.0, 298.0, 368.0, 334.0, 361.0, 316.0, 341.0, 351.0, 377.0, 370.0, 339.0, 364.0, 373.0, 354.0, 343.0, 315.0, 301.0, 369.0, 367.0, 346.0, 368.0, 357.0, 356.0, 378.0, 310.0, 386.0, 371.0, 401.0, 368.0, 321.0, 341.0, 388.0, 353.0, 348.0, 362.0, 331.0, 347.0, 362.0, 376.0, 370.0, 361.0, 305.0, 374.0, 342.0, 338.0, 368.0, 367.0, 361.0, 343.0, 334.0, 391.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14147651181055187, "mean_inference_ms": 0.9566300734454622, "mean_action_processing_ms": 0.05075388505603115, "mean_env_wait_ms": 0.539670112868188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006999969482421875, "StateBufferConnector_ms": 0.004004240036010742, "ViewRequirementAgentConnector_ms": 0.043294668197631836}, "num_episodes": 40, "episode_return_max": 405.0, "episode_return_min": 292.0, "episode_return_mean": 350.18}, "env_runner_results": {"episode_reward_max": 405.0, "episode_reward_min": 292.0, "episode_reward_mean": 350.18, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.0, 351.0, 340.0, 339.0, 292.0, 333.0, 345.0, 352.0, 358.0, 339.0, 346.0, 361.0, 362.0, 358.0, 293.0, 326.0, 319.0, 321.0, 390.0, 319.0, 342.0, 352.0, 325.0, 341.0, 364.0, 381.0, 330.0, 333.0, 368.0, 360.0, 371.0, 345.0, 334.0, 355.0, 335.0, 358.0, 370.0, 311.0, 383.0, 365.0, 343.0, 367.0, 373.0, 309.0, 344.0, 321.0, 329.0, 402.0, 405.0, 363.0, 298.0, 368.0, 334.0, 361.0, 316.0, 341.0, 351.0, 377.0, 370.0, 339.0, 364.0, 373.0, 354.0, 343.0, 315.0, 301.0, 369.0, 367.0, 346.0, 368.0, 357.0, 356.0, 378.0, 310.0, 386.0, 371.0, 401.0, 368.0, 321.0, 341.0, 388.0, 353.0, 348.0, 362.0, 331.0, 347.0, 362.0, 376.0, 370.0, 361.0, 305.0, 374.0, 342.0, 338.0, 368.0, 367.0, 361.0, 343.0, 334.0, 391.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14147651181055187, "mean_inference_ms": 0.9566300734454622, "mean_action_processing_ms": 0.05075388505603115, "mean_env_wait_ms": 0.539670112868188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006999969482421875, "StateBufferConnector_ms": 0.004004240036010742, "ViewRequirementAgentConnector_ms": 0.043294668197631836}, "num_episodes": 40, "episode_return_max": 405.0, "episode_return_min": 292.0, "episode_return_mean": 350.18}, "episode_reward_max": 405.0, "episode_reward_min": 292.0, "episode_reward_mean": 350.18, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.0, 351.0, 340.0, 339.0, 292.0, 333.0, 345.0, 352.0, 358.0, 339.0, 346.0, 361.0, 362.0, 358.0, 293.0, 326.0, 319.0, 321.0, 390.0, 319.0, 342.0, 352.0, 325.0, 341.0, 364.0, 381.0, 330.0, 333.0, 368.0, 360.0, 371.0, 345.0, 334.0, 355.0, 335.0, 358.0, 370.0, 311.0, 383.0, 365.0, 343.0, 367.0, 373.0, 309.0, 344.0, 321.0, 329.0, 402.0, 405.0, 363.0, 298.0, 368.0, 334.0, 361.0, 316.0, 341.0, 351.0, 377.0, 370.0, 339.0, 364.0, 373.0, 354.0, 343.0, 315.0, 301.0, 369.0, 367.0, 346.0, 368.0, 357.0, 356.0, 378.0, 310.0, 386.0, 371.0, 401.0, 368.0, 321.0, 341.0, 388.0, 353.0, 348.0, 362.0, 331.0, 347.0, 362.0, 376.0, 370.0, 361.0, 305.0, 374.0, 342.0, 338.0, 368.0, 367.0, 361.0, 343.0, 334.0, 391.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14147651181055187, "mean_inference_ms": 0.9566300734454622, "mean_action_processing_ms": 0.05075388505603115, "mean_env_wait_ms": 0.539670112868188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006999969482421875, "StateBufferConnector_ms": 0.004004240036010742, "ViewRequirementAgentConnector_ms": 0.043294668197631836}, "num_episodes": 40, "episode_return_max": 405.0, "episode_return_min": 292.0, "episode_return_mean": 350.18, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.30840331653638, "num_env_steps_trained_throughput_per_sec": 234.30840331653638, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 16751.83, "restore_workers_time_ms": 0.0, "training_step_time_ms": 16751.687, "sample_time_ms": 6798.67, "load_time_ms": 0.431, "load_throughput": 9283101.099, "learn_time_ms": 9946.653, "learn_throughput": 402.145, "synch_weights_time_ms": 5.861}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 280, "training_iteration": 7, "trial_id": "default", "date": "2024-05-19_13-57-28", "timestamp": 1716152248, "time_this_iter_s": 17.07702088356018, "time_total_s": 117.30486750602722, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 117.30486750602722, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.345669291338588, "ram_util_percent": 32.16771653543308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3455365075859973, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.0010000000000000005, "total_loss": 9.672265812658495, "policy_loss": -0.1809372928078657, "vf_loss": 9.77700428296161, "vf_explained_var": -0.0009639934826922674, "kl": 0.022298704607117765, "entropy": 1.9100565092537993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 416.0, "episode_reward_min": 298.0, "episode_reward_mean": 355.78, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.0, 367.0, 373.0, 309.0, 344.0, 321.0, 329.0, 402.0, 405.0, 363.0, 298.0, 368.0, 334.0, 361.0, 316.0, 341.0, 351.0, 377.0, 370.0, 339.0, 364.0, 373.0, 354.0, 343.0, 315.0, 301.0, 369.0, 367.0, 346.0, 368.0, 357.0, 356.0, 378.0, 310.0, 386.0, 371.0, 401.0, 368.0, 321.0, 341.0, 388.0, 353.0, 348.0, 362.0, 331.0, 347.0, 362.0, 376.0, 370.0, 361.0, 305.0, 374.0, 342.0, 338.0, 368.0, 367.0, 361.0, 343.0, 334.0, 391.0, 367.0, 367.0, 370.0, 369.0, 341.0, 317.0, 336.0, 351.0, 341.0, 362.0, 374.0, 369.0, 339.0, 379.0, 379.0, 416.0, 355.0, 307.0, 369.0, 343.0, 353.0, 359.0, 329.0, 333.0, 359.0, 347.0, 363.0, 398.0, 399.0, 349.0, 393.0, 379.0, 346.0, 378.0, 300.0, 391.0, 337.0, 385.0, 346.0, 362.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14178414148814336, "mean_inference_ms": 0.956335555251797, "mean_action_processing_ms": 0.050947657719749684, "mean_env_wait_ms": 0.5397875535283098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01300954818725586, "StateBufferConnector_ms": 0.003003358840942383, "ViewRequirementAgentConnector_ms": 0.052803754806518555}, "num_episodes": 40, "episode_return_max": 416.0, "episode_return_min": 298.0, "episode_return_mean": 355.78}, "env_runner_results": {"episode_reward_max": 416.0, "episode_reward_min": 298.0, "episode_reward_mean": 355.78, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.0, 367.0, 373.0, 309.0, 344.0, 321.0, 329.0, 402.0, 405.0, 363.0, 298.0, 368.0, 334.0, 361.0, 316.0, 341.0, 351.0, 377.0, 370.0, 339.0, 364.0, 373.0, 354.0, 343.0, 315.0, 301.0, 369.0, 367.0, 346.0, 368.0, 357.0, 356.0, 378.0, 310.0, 386.0, 371.0, 401.0, 368.0, 321.0, 341.0, 388.0, 353.0, 348.0, 362.0, 331.0, 347.0, 362.0, 376.0, 370.0, 361.0, 305.0, 374.0, 342.0, 338.0, 368.0, 367.0, 361.0, 343.0, 334.0, 391.0, 367.0, 367.0, 370.0, 369.0, 341.0, 317.0, 336.0, 351.0, 341.0, 362.0, 374.0, 369.0, 339.0, 379.0, 379.0, 416.0, 355.0, 307.0, 369.0, 343.0, 353.0, 359.0, 329.0, 333.0, 359.0, 347.0, 363.0, 398.0, 399.0, 349.0, 393.0, 379.0, 346.0, 378.0, 300.0, 391.0, 337.0, 385.0, 346.0, 362.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14178414148814336, "mean_inference_ms": 0.956335555251797, "mean_action_processing_ms": 0.050947657719749684, "mean_env_wait_ms": 0.5397875535283098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01300954818725586, "StateBufferConnector_ms": 0.003003358840942383, "ViewRequirementAgentConnector_ms": 0.052803754806518555}, "num_episodes": 40, "episode_return_max": 416.0, "episode_return_min": 298.0, "episode_return_mean": 355.78}, "episode_reward_max": 416.0, "episode_reward_min": 298.0, "episode_reward_mean": 355.78, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [343.0, 367.0, 373.0, 309.0, 344.0, 321.0, 329.0, 402.0, 405.0, 363.0, 298.0, 368.0, 334.0, 361.0, 316.0, 341.0, 351.0, 377.0, 370.0, 339.0, 364.0, 373.0, 354.0, 343.0, 315.0, 301.0, 369.0, 367.0, 346.0, 368.0, 357.0, 356.0, 378.0, 310.0, 386.0, 371.0, 401.0, 368.0, 321.0, 341.0, 388.0, 353.0, 348.0, 362.0, 331.0, 347.0, 362.0, 376.0, 370.0, 361.0, 305.0, 374.0, 342.0, 338.0, 368.0, 367.0, 361.0, 343.0, 334.0, 391.0, 367.0, 367.0, 370.0, 369.0, 341.0, 317.0, 336.0, 351.0, 341.0, 362.0, 374.0, 369.0, 339.0, 379.0, 379.0, 416.0, 355.0, 307.0, 369.0, 343.0, 353.0, 359.0, 329.0, 333.0, 359.0, 347.0, 363.0, 398.0, 399.0, 349.0, 393.0, 379.0, 346.0, 378.0, 300.0, 391.0, 337.0, 385.0, 346.0, 362.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14178414148814336, "mean_inference_ms": 0.956335555251797, "mean_action_processing_ms": 0.050947657719749684, "mean_env_wait_ms": 0.5397875535283098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01300954818725586, "StateBufferConnector_ms": 0.003003358840942383, "ViewRequirementAgentConnector_ms": 0.052803754806518555}, "num_episodes": 40, "episode_return_max": 416.0, "episode_return_min": 298.0, "episode_return_mean": 355.78, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.56237436521877, "num_env_steps_trained_throughput_per_sec": 237.56237436521877, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 16762.562, "restore_workers_time_ms": 0.0, "training_step_time_ms": 16762.437, "sample_time_ms": 6789.879, "load_time_ms": 0.377, "load_throughput": 10609258.399, "learn_time_ms": 9966.3, "learn_throughput": 401.353, "synch_weights_time_ms": 5.692}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 320, "training_iteration": 8, "trial_id": "default", "date": "2024-05-19_13-58-57", "timestamp": 1716152337, "time_this_iter_s": 16.846196174621582, "time_total_s": 134.1510636806488, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 134.1510636806488, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.79133858267717, "ram_util_percent": 32.088976377952754}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.443117117625411, "cur_kl_coeff": 5.12578125, "cur_lr": 0.0010000000000000005, "total_loss": 9.603733567268618, "policy_loss": -0.15984102708377665, "vf_loss": 9.665677713578747, "vf_explained_var": -0.001084244123069189, "kl": 0.01909892176879826, "entropy": 1.9152103349726688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 416.0, "episode_reward_min": 300.0, "episode_reward_mean": 358.8, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [388.0, 353.0, 348.0, 362.0, 331.0, 347.0, 362.0, 376.0, 370.0, 361.0, 305.0, 374.0, 342.0, 338.0, 368.0, 367.0, 361.0, 343.0, 334.0, 391.0, 367.0, 367.0, 370.0, 369.0, 341.0, 317.0, 336.0, 351.0, 341.0, 362.0, 374.0, 369.0, 339.0, 379.0, 379.0, 416.0, 355.0, 307.0, 369.0, 343.0, 353.0, 359.0, 329.0, 333.0, 359.0, 347.0, 363.0, 398.0, 399.0, 349.0, 393.0, 379.0, 346.0, 378.0, 300.0, 391.0, 337.0, 385.0, 346.0, 362.0, 337.0, 365.0, 382.0, 347.0, 350.0, 319.0, 333.0, 407.0, 318.0, 328.0, 389.0, 357.0, 360.0, 399.0, 386.0, 384.0, 360.0, 377.0, 334.0, 321.0, 359.0, 386.0, 403.0, 360.0, 334.0, 388.0, 360.0, 349.0, 346.0, 354.0, 323.0, 331.0, 382.0, 394.0, 374.0, 311.0, 323.0, 385.0, 373.0, 414.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.141625651595613, "mean_inference_ms": 0.9550545173353612, "mean_action_processing_ms": 0.05100832110080445, "mean_env_wait_ms": 0.5402317067796178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018019676208496094, "StateBufferConnector_ms": 0.0009996891021728516, "ViewRequirementAgentConnector_ms": 0.05681657791137695}, "num_episodes": 40, "episode_return_max": 416.0, "episode_return_min": 300.0, "episode_return_mean": 358.8}, "env_runner_results": {"episode_reward_max": 416.0, "episode_reward_min": 300.0, "episode_reward_mean": 358.8, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [388.0, 353.0, 348.0, 362.0, 331.0, 347.0, 362.0, 376.0, 370.0, 361.0, 305.0, 374.0, 342.0, 338.0, 368.0, 367.0, 361.0, 343.0, 334.0, 391.0, 367.0, 367.0, 370.0, 369.0, 341.0, 317.0, 336.0, 351.0, 341.0, 362.0, 374.0, 369.0, 339.0, 379.0, 379.0, 416.0, 355.0, 307.0, 369.0, 343.0, 353.0, 359.0, 329.0, 333.0, 359.0, 347.0, 363.0, 398.0, 399.0, 349.0, 393.0, 379.0, 346.0, 378.0, 300.0, 391.0, 337.0, 385.0, 346.0, 362.0, 337.0, 365.0, 382.0, 347.0, 350.0, 319.0, 333.0, 407.0, 318.0, 328.0, 389.0, 357.0, 360.0, 399.0, 386.0, 384.0, 360.0, 377.0, 334.0, 321.0, 359.0, 386.0, 403.0, 360.0, 334.0, 388.0, 360.0, 349.0, 346.0, 354.0, 323.0, 331.0, 382.0, 394.0, 374.0, 311.0, 323.0, 385.0, 373.0, 414.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.141625651595613, "mean_inference_ms": 0.9550545173353612, "mean_action_processing_ms": 0.05100832110080445, "mean_env_wait_ms": 0.5402317067796178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018019676208496094, "StateBufferConnector_ms": 0.0009996891021728516, "ViewRequirementAgentConnector_ms": 0.05681657791137695}, "num_episodes": 40, "episode_return_max": 416.0, "episode_return_min": 300.0, "episode_return_mean": 358.8}, "episode_reward_max": 416.0, "episode_reward_min": 300.0, "episode_reward_mean": 358.8, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [388.0, 353.0, 348.0, 362.0, 331.0, 347.0, 362.0, 376.0, 370.0, 361.0, 305.0, 374.0, 342.0, 338.0, 368.0, 367.0, 361.0, 343.0, 334.0, 391.0, 367.0, 367.0, 370.0, 369.0, 341.0, 317.0, 336.0, 351.0, 341.0, 362.0, 374.0, 369.0, 339.0, 379.0, 379.0, 416.0, 355.0, 307.0, 369.0, 343.0, 353.0, 359.0, 329.0, 333.0, 359.0, 347.0, 363.0, 398.0, 399.0, 349.0, 393.0, 379.0, 346.0, 378.0, 300.0, 391.0, 337.0, 385.0, 346.0, 362.0, 337.0, 365.0, 382.0, 347.0, 350.0, 319.0, 333.0, 407.0, 318.0, 328.0, 389.0, 357.0, 360.0, 399.0, 386.0, 384.0, 360.0, 377.0, 334.0, 321.0, 359.0, 386.0, 403.0, 360.0, 334.0, 388.0, 360.0, 349.0, 346.0, 354.0, 323.0, 331.0, 382.0, 394.0, 374.0, 311.0, 323.0, 385.0, 373.0, 414.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.141625651595613, "mean_inference_ms": 0.9550545173353612, "mean_action_processing_ms": 0.05100832110080445, "mean_env_wait_ms": 0.5402317067796178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018019676208496094, "StateBufferConnector_ms": 0.0009996891021728516, "ViewRequirementAgentConnector_ms": 0.05681657791137695}, "num_episodes": 40, "episode_return_max": 416.0, "episode_return_min": 300.0, "episode_return_mean": 358.8, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.3696245851451, "num_env_steps_trained_throughput_per_sec": 236.3696245851451, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 16780.349, "restore_workers_time_ms": 0.0, "training_step_time_ms": 16780.238, "sample_time_ms": 6784.11, "load_time_ms": 0.335, "load_throughput": 11935415.698, "learn_time_ms": 9989.842, "learn_throughput": 400.407, "synch_weights_time_ms": 5.783}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 360, "training_iteration": 9, "trial_id": "default", "date": "2024-05-19_14-00-27", "timestamp": 1716152427, "time_this_iter_s": 16.930667400360107, "time_total_s": 151.0817310810089, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 151.0817310810089, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 21.448031496062992, "ram_util_percent": 32.16377952755904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.66472492435927, "cur_kl_coeff": 5.12578125, "cur_lr": 0.0010000000000000005, "total_loss": 9.625355059100736, "policy_loss": -0.17079332235209163, "vf_loss": 9.719484655318722, "vf_explained_var": -0.0019172813943637314, "kl": 0.014956492568674486, "entropy": 1.9165112951750396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 414.0, "episode_reward_min": 297.0, "episode_reward_mean": 360.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.0, 359.0, 329.0, 333.0, 359.0, 347.0, 363.0, 398.0, 399.0, 349.0, 393.0, 379.0, 346.0, 378.0, 300.0, 391.0, 337.0, 385.0, 346.0, 362.0, 337.0, 365.0, 382.0, 347.0, 350.0, 319.0, 333.0, 407.0, 318.0, 328.0, 389.0, 357.0, 360.0, 399.0, 386.0, 384.0, 360.0, 377.0, 334.0, 321.0, 359.0, 386.0, 403.0, 360.0, 334.0, 388.0, 360.0, 349.0, 346.0, 354.0, 323.0, 331.0, 382.0, 394.0, 374.0, 311.0, 323.0, 385.0, 373.0, 414.0, 363.0, 358.0, 346.0, 349.0, 360.0, 399.0, 396.0, 326.0, 384.0, 367.0, 297.0, 355.0, 371.0, 316.0, 361.0, 352.0, 324.0, 401.0, 408.0, 338.0, 386.0, 336.0, 405.0, 364.0, 364.0, 357.0, 373.0, 357.0, 364.0, 386.0, 340.0, 359.0, 361.0, 363.0, 367.0, 369.0, 361.0, 360.0, 370.0, 371.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14151203815050892, "mean_inference_ms": 0.9539827767998686, "mean_action_processing_ms": 0.050893783000680946, "mean_env_wait_ms": 0.5407350138659579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015525579452514648, "StateBufferConnector_ms": 0.0009996891021728516, "ViewRequirementAgentConnector_ms": 0.052741289138793945}, "num_episodes": 40, "episode_return_max": 414.0, "episode_return_min": 297.0, "episode_return_mean": 360.92}, "env_runner_results": {"episode_reward_max": 414.0, "episode_reward_min": 297.0, "episode_reward_mean": 360.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.0, 359.0, 329.0, 333.0, 359.0, 347.0, 363.0, 398.0, 399.0, 349.0, 393.0, 379.0, 346.0, 378.0, 300.0, 391.0, 337.0, 385.0, 346.0, 362.0, 337.0, 365.0, 382.0, 347.0, 350.0, 319.0, 333.0, 407.0, 318.0, 328.0, 389.0, 357.0, 360.0, 399.0, 386.0, 384.0, 360.0, 377.0, 334.0, 321.0, 359.0, 386.0, 403.0, 360.0, 334.0, 388.0, 360.0, 349.0, 346.0, 354.0, 323.0, 331.0, 382.0, 394.0, 374.0, 311.0, 323.0, 385.0, 373.0, 414.0, 363.0, 358.0, 346.0, 349.0, 360.0, 399.0, 396.0, 326.0, 384.0, 367.0, 297.0, 355.0, 371.0, 316.0, 361.0, 352.0, 324.0, 401.0, 408.0, 338.0, 386.0, 336.0, 405.0, 364.0, 364.0, 357.0, 373.0, 357.0, 364.0, 386.0, 340.0, 359.0, 361.0, 363.0, 367.0, 369.0, 361.0, 360.0, 370.0, 371.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14151203815050892, "mean_inference_ms": 0.9539827767998686, "mean_action_processing_ms": 0.050893783000680946, "mean_env_wait_ms": 0.5407350138659579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015525579452514648, "StateBufferConnector_ms": 0.0009996891021728516, "ViewRequirementAgentConnector_ms": 0.052741289138793945}, "num_episodes": 40, "episode_return_max": 414.0, "episode_return_min": 297.0, "episode_return_mean": 360.92}, "episode_reward_max": 414.0, "episode_reward_min": 297.0, "episode_reward_mean": 360.92, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [353.0, 359.0, 329.0, 333.0, 359.0, 347.0, 363.0, 398.0, 399.0, 349.0, 393.0, 379.0, 346.0, 378.0, 300.0, 391.0, 337.0, 385.0, 346.0, 362.0, 337.0, 365.0, 382.0, 347.0, 350.0, 319.0, 333.0, 407.0, 318.0, 328.0, 389.0, 357.0, 360.0, 399.0, 386.0, 384.0, 360.0, 377.0, 334.0, 321.0, 359.0, 386.0, 403.0, 360.0, 334.0, 388.0, 360.0, 349.0, 346.0, 354.0, 323.0, 331.0, 382.0, 394.0, 374.0, 311.0, 323.0, 385.0, 373.0, 414.0, 363.0, 358.0, 346.0, 349.0, 360.0, 399.0, 396.0, 326.0, 384.0, 367.0, 297.0, 355.0, 371.0, 316.0, 361.0, 352.0, 324.0, 401.0, 408.0, 338.0, 386.0, 336.0, 405.0, 364.0, 364.0, 357.0, 373.0, 357.0, 364.0, 386.0, 340.0, 359.0, 361.0, 363.0, 367.0, 369.0, 361.0, 360.0, 370.0, 371.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14151203815050892, "mean_inference_ms": 0.9539827767998686, "mean_action_processing_ms": 0.050893783000680946, "mean_env_wait_ms": 0.5407350138659579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015525579452514648, "StateBufferConnector_ms": 0.0009996891021728516, "ViewRequirementAgentConnector_ms": 0.052741289138793945}, "num_episodes": 40, "episode_return_max": 414.0, "episode_return_min": 297.0, "episode_return_mean": 360.92, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.23700341333523, "num_env_steps_trained_throughput_per_sec": 234.23700341333523, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 16809.986, "restore_workers_time_ms": 0.0, "training_step_time_ms": 16809.886, "sample_time_ms": 6785.951, "load_time_ms": 0.359, "load_throughput": 11132118.638, "learn_time_ms": 10017.669, "learn_throughput": 399.294, "synch_weights_time_ms": 5.756}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 400, "training_iteration": 10, "trial_id": "default", "date": "2024-05-19_14-01-58", "timestamp": 1716152518, "time_this_iter_s": 17.08623170852661, "time_total_s": 168.16796278953552, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 168.16796278953552, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 21.309375000000003, "ram_util_percent": 32.21640624999999}}
