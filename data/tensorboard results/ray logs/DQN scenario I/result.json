{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 380.0, "episode_reward_min": 312.0, "episode_reward_mean": 339.3, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32975933292171694, "mean_inference_ms": 1.3005378601196167, "mean_action_processing_ms": 0.05065144358815012, "mean_env_wait_ms": 0.5671018129819398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040106773376464844, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0710606575012207}, "num_episodes": 10, "episode_return_max": 380.0, "episode_return_min": 312.0, "episode_return_mean": 339.3}, "env_runner_results": {"episode_reward_max": 380.0, "episode_reward_min": 312.0, "episode_reward_mean": 339.3, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32975933292171694, "mean_inference_ms": 1.3005378601196167, "mean_action_processing_ms": 0.05065144358815012, "mean_env_wait_ms": 0.5671018129819398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040106773376464844, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0710606575012207}, "num_episodes": 10, "episode_return_max": 380.0, "episode_return_min": 312.0, "episode_return_mean": 339.3}, "episode_reward_max": 380.0, "episode_reward_min": 312.0, "episode_reward_mean": 339.3, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 1000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32975933292171694, "mean_inference_ms": 1.3005378601196167, "mean_action_processing_ms": 0.05065144358815012, "mean_env_wait_ms": 0.5671018129819398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040106773376464844, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0710606575012207}, "num_episodes": 10, "episode_return_max": 380.0, "episode_return_min": 312.0, "episode_return_mean": 339.3, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 268.58780759928015, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000, "num_env_steps_sampled_lifetime": 1000, "num_agent_steps_sampled_lifetime": 1000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000, "timers": {"training_iteration_time_ms": 3723.177, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3.863, "sample_time_ms": 3.863}, "counters": {"num_env_steps_sampled": 1000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "default", "date": "2024-05-19_13-49-33", "timestamp": 1716151773, "time_this_iter_s": 3.723177194595337, "time_total_s": 3.723177194595337, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3.723177194595337, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 9.886206896551721, "ram_util_percent": 30.986206896551725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8370197415351868, "mean_q": 10.75020980834961, "min_q": 3.4601938724517822, "max_q": 15.431869506835938, "cur_lr": 0.0005}, "td_error": [-2.001920700073242, -1.1004371643066406, 0.034340858459472656, 2.159242630004883, -0.3733081817626953, 0.8620800971984863, 1.7728805541992188, 5.9960455894470215, -1.5454225540161133, 1.848708152770996, 0.30878114700317383, -1.2345685958862305, 0.8787984848022461, 0.14038753509521484, -0.7575645446777344, 1.6178808212280273, -1.0566883087158203, 0.08394622802734375, -0.2636432647705078, -0.9040317535400391, -1.2753067016601562, -2.0782480239868164, -0.9090919494628906, -1.9656133651733398, 0.6077432632446289, -0.5866045951843262, 0.10154056549072266, -2.3495473861694336, -0.049216270446777344, 0.8141002655029297, -2.7441720962524414, -0.7735786437988281], "mean_td_error": -0.14820273220539093, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 999.0}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "last_target_update_ts": 1501, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": 382.0, "episode_reward_min": 312.0, "episode_reward_mean": 346.5, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3950582087433671, "mean_inference_ms": 1.4494478880585315, "mean_action_processing_ms": 0.059233228451817964, "mean_env_wait_ms": 0.6062828620273314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04172921180725098, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.1407325267791748}, "num_episodes": 10, "episode_return_max": 382.0, "episode_return_min": 312.0, "episode_return_mean": 346.5}, "env_runner_results": {"episode_reward_max": 382.0, "episode_reward_min": 312.0, "episode_reward_mean": 346.5, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3950582087433671, "mean_inference_ms": 1.4494478880585315, "mean_action_processing_ms": 0.059233228451817964, "mean_env_wait_ms": 0.6062828620273314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04172921180725098, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.1407325267791748}, "num_episodes": 10, "episode_return_max": 382.0, "episode_return_min": 312.0, "episode_return_mean": 346.5}, "episode_reward_max": 382.0, "episode_reward_min": 312.0, "episode_reward_mean": 346.5, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 2000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3950582087433671, "mean_inference_ms": 1.4494478880585315, "mean_action_processing_ms": 0.059233228451817964, "mean_env_wait_ms": 0.6062828620273314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04172921180725098, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.1407325267791748}, "num_episodes": 10, "episode_return_max": 382.0, "episode_return_min": 312.0, "episode_return_mean": 346.5, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.821548765204888, "num_env_steps_trained_throughput_per_sec": 634.2895604865564, "timesteps_total": 2000, "num_env_steps_sampled_lifetime": 2000, "num_agent_steps_sampled_lifetime": 2000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 27086.661, "restore_workers_time_ms": 0.0, "training_step_time_ms": 50.855, "sample_time_ms": 16.473, "load_time_ms": 0.2, "load_throughput": 160011.598, "learn_time_ms": 19.719, "learn_throughput": 1622.774, "synch_weights_time_ms": 6.207}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 32000, "last_target_update_ts": 1501, "num_target_updates": 2}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "default", "date": "2024-05-19_13-50-58", "timestamp": 1716151858, "time_this_iter_s": 50.46467089653015, "time_total_s": 54.18784809112549, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 54.18784809112549, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 21.162184873949577, "ram_util_percent": 31.512605042016816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8504310846328735, "mean_q": 23.239131927490234, "min_q": 11.303751945495605, "max_q": 33.560028076171875, "cur_lr": 0.0005}, "td_error": [-1.3616886138916016, 12.303751945495605, -1.5660409927368164, 0.9464492797851562, -1.1590461730957031, 4.293987274169922, -1.1960582733154297, -3.649425506591797, 0.9061374664306641, -0.4825572967529297, -0.6142597198486328, -0.6828155517578125, -1.8057727813720703, -0.5136909484863281, -2.455850601196289, 1.6107215881347656, 1.545175552368164, 0.8955516815185547, -1.0194568634033203, -2.3531951904296875, -1.532491683959961, -0.32285118103027344, -0.419464111328125, 0.07808494567871094, 0.10988426208496094, -0.061824798583984375, 1.5575180053710938, -0.21397018432617188, 4.508805274963379, 1.3126049041748047, 0.9448013305664062, -3.068361282348633], "mean_td_error": 0.2042078673839569, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 2000.0, "diff_num_grad_updates_vs_sampler_policy": 1999.0}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "last_target_update_ts": 2501, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": 418.0, "episode_reward_min": 312.0, "episode_reward_mean": 357.2, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43184726617848607, "mean_inference_ms": 1.530877998009533, "mean_action_processing_ms": 0.06317453826397483, "mean_env_wait_ms": 0.6287334063884608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032836596171061196, "StateBufferConnector_ms": 0.006656646728515625, "ViewRequirementAgentConnector_ms": 0.13052860895792642}, "num_episodes": 10, "episode_return_max": 418.0, "episode_return_min": 312.0, "episode_return_mean": 357.2}, "env_runner_results": {"episode_reward_max": 418.0, "episode_reward_min": 312.0, "episode_reward_mean": 357.2, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43184726617848607, "mean_inference_ms": 1.530877998009533, "mean_action_processing_ms": 0.06317453826397483, "mean_env_wait_ms": 0.6287334063884608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032836596171061196, "StateBufferConnector_ms": 0.006656646728515625, "ViewRequirementAgentConnector_ms": 0.13052860895792642}, "num_episodes": 10, "episode_return_max": 418.0, "episode_return_min": 312.0, "episode_return_mean": 357.2}, "episode_reward_max": 418.0, "episode_reward_min": 312.0, "episode_reward_mean": 357.2, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43184726617848607, "mean_inference_ms": 1.530877998009533, "mean_action_processing_ms": 0.06317453826397483, "mean_env_wait_ms": 0.6287334063884608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032836596171061196, "StateBufferConnector_ms": 0.006656646728515625, "ViewRequirementAgentConnector_ms": 0.13052860895792642}, "num_episodes": 10, "episode_return_max": 418.0, "episode_return_min": 312.0, "episode_return_mean": 357.2, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 19.246554483202583, "num_env_steps_trained_throughput_per_sec": 615.8897434624827, "timesteps_total": 3000, "num_env_steps_sampled_lifetime": 3000, "num_agent_steps_sampled_lifetime": 3000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 3000, "timers": {"training_iteration_time_ms": 35376.891, "restore_workers_time_ms": 0.1, "training_step_time_ms": 52.123, "sample_time_ms": 16.543, "load_time_ms": 0.1, "load_throughput": 319870.658, "learn_time_ms": 19.628, "learn_throughput": 1630.298, "synch_weights_time_ms": 6.795}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 3000, "num_agent_steps_trained": 64000, "last_target_update_ts": 2501, "num_target_updates": 4}, "done": false, "episodes_total": 30, "training_iteration": 3, "trial_id": "default", "date": "2024-05-19_13-52-25", "timestamp": 1716151945, "time_this_iter_s": 51.96986413002014, "time_total_s": 106.15771222114563, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 106.15771222114563, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.99512195121951, "ram_util_percent": 32.21869918699186}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.287961721420288, "mean_q": 35.10546112060547, "min_q": 23.454742431640625, "max_q": 43.32063674926758, "cur_lr": 0.0005}, "td_error": [-3.030445098876953, -1.4746551513671875, 1.386260986328125, 2.115081787109375, 0.6141891479492188, -1.4360618591308594, -0.23874282836914062, 1.2842636108398438, 2.5997467041015625, 0.4871063232421875, -1.1272811889648438, 20.831331253051758, 1.0225563049316406, -0.223114013671875, -0.1170806884765625, 1.9214668273925781, 5.096044540405273, -1.6613883972167969, 2.356006622314453, -0.7107658386230469, 1.4565849304199219, -0.6069793701171875, 1.2731437683105469, -3.179088592529297, 0.21390914916992188, 0.206939697265625, 1.703369140625, 2.3908653259277344, 1.5896224975585938, 0.19902801513671875, 2.802478790283203, -0.7856521606445312], "mean_td_error": 1.1549606323242188, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 3000.0, "diff_num_grad_updates_vs_sampler_policy": 2999.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "last_target_update_ts": 3501, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": 422.0, "episode_reward_min": 312.0, "episode_reward_mean": 366.7, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45914714450220073, "mean_inference_ms": 1.5846952595595771, "mean_action_processing_ms": 0.06611553292786543, "mean_env_wait_ms": 0.6453227262875494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027134418487548828, "StateBufferConnector_ms": 0.004992485046386719, "ViewRequirementAgentConnector_ms": 0.139198899269104}, "num_episodes": 10, "episode_return_max": 422.0, "episode_return_min": 312.0, "episode_return_mean": 366.7}, "env_runner_results": {"episode_reward_max": 422.0, "episode_reward_min": 312.0, "episode_reward_mean": 366.7, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45914714450220073, "mean_inference_ms": 1.5846952595595771, "mean_action_processing_ms": 0.06611553292786543, "mean_env_wait_ms": 0.6453227262875494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027134418487548828, "StateBufferConnector_ms": 0.004992485046386719, "ViewRequirementAgentConnector_ms": 0.139198899269104}, "num_episodes": 10, "episode_return_max": 422.0, "episode_return_min": 312.0, "episode_return_mean": 366.7}, "episode_reward_max": 422.0, "episode_reward_min": 312.0, "episode_reward_mean": 366.7, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45914714450220073, "mean_inference_ms": 1.5846952595595771, "mean_action_processing_ms": 0.06611553292786543, "mean_env_wait_ms": 0.6453227262875494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027134418487548828, "StateBufferConnector_ms": 0.004992485046386719, "ViewRequirementAgentConnector_ms": 0.139198899269104}, "num_episodes": 10, "episode_return_max": 422.0, "episode_return_min": 312.0, "episode_return_mean": 366.7, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.52339070142484, "num_env_steps_trained_throughput_per_sec": 592.7485024455949, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 40029.117, "restore_workers_time_ms": 0.0, "training_step_time_ms": 50.81, "sample_time_ms": 16.029, "load_time_ms": 0.1, "load_throughput": 319870.658, "learn_time_ms": 20.385, "learn_throughput": 1569.78, "synch_weights_time_ms": 6.206}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 96000, "last_target_update_ts": 3501, "num_target_updates": 6}, "done": false, "episodes_total": 40, "training_iteration": 4, "trial_id": "default", "date": "2024-05-19_13-53-54", "timestamp": 1716152034, "time_this_iter_s": 53.996312618255615, "time_total_s": 160.15402483940125, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 160.15402483940125, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 20.916666666666668, "ram_util_percent": 32.22301587301586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8162245750427246, "mean_q": 47.32195281982422, "min_q": 31.252538681030273, "max_q": 61.22759246826172, "cur_lr": 0.0005}, "td_error": [-0.9173774719238281, 0.4203681945800781, 2.8660545349121094, 1.2668266296386719, 1.9856529235839844, -7.585762023925781, 1.6298408508300781, -1.6286964416503906, -2.7936248779296875, 3.686870574951172, -0.6162452697753906, 2.639324188232422, 1.6440544128417969, 2.0270767211914062, 1.056610107421875, -2.025524139404297, -0.6675567626953125, 2.4399070739746094, 0.37181854248046875, 2.0784683227539062, -0.36899566650390625, 3.1913375854492188, 1.2147560119628906, 1.0865211486816406, 3.6219215393066406, -1.4775505065917969, 1.0918846130371094, 6.562046051025391, 1.8076629638671875, 2.528240203857422, -0.6967735290527344, 0.47321319580078125], "mean_td_error": 0.8410109281539917, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 4000.0, "diff_num_grad_updates_vs_sampler_policy": 3999.0}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "last_target_update_ts": 4501, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": 422.0, "episode_reward_min": 312.0, "episode_reward_mean": 371.08, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4795615021960043, "mean_inference_ms": 1.6237268168857997, "mean_action_processing_ms": 0.06823290034649052, "mean_env_wait_ms": 0.6588411775685492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02572154998779297, "StateBufferConnector_ms": 0.003993988037109375, "ViewRequirementAgentConnector_ms": 0.13772344589233398}, "num_episodes": 10, "episode_return_max": 422.0, "episode_return_min": 312.0, "episode_return_mean": 371.08}, "env_runner_results": {"episode_reward_max": 422.0, "episode_reward_min": 312.0, "episode_reward_mean": 371.08, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4795615021960043, "mean_inference_ms": 1.6237268168857997, "mean_action_processing_ms": 0.06823290034649052, "mean_env_wait_ms": 0.6588411775685492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02572154998779297, "StateBufferConnector_ms": 0.003993988037109375, "ViewRequirementAgentConnector_ms": 0.13772344589233398}, "num_episodes": 10, "episode_return_max": 422.0, "episode_return_min": 312.0, "episode_return_mean": 371.08}, "episode_reward_max": 422.0, "episode_reward_min": 312.0, "episode_reward_mean": 371.08, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4795615021960043, "mean_inference_ms": 1.6237268168857997, "mean_action_processing_ms": 0.06823290034649052, "mean_env_wait_ms": 0.6588411775685492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02572154998779297, "StateBufferConnector_ms": 0.003993988037109375, "ViewRequirementAgentConnector_ms": 0.13772344589233398}, "num_episodes": 10, "episode_return_max": 422.0, "episode_return_min": 312.0, "episode_return_mean": 371.08, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.62071571671259, "num_env_steps_trained_throughput_per_sec": 595.8629029348028, "timesteps_total": 5000, "num_env_steps_sampled_lifetime": 5000, "num_agent_steps_sampled_lifetime": 5000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 5000, "timers": {"training_iteration_time_ms": 42764.02, "restore_workers_time_ms": 0.0, "training_step_time_ms": 47.188, "sample_time_ms": 15.035, "load_time_ms": 0.2, "load_throughput": 159687.957, "learn_time_ms": 17.863, "learn_throughput": 1791.421, "synch_weights_time_ms": 5.779}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 5000, "num_agent_steps_trained": 128000, "last_target_update_ts": 4501, "num_target_updates": 8}, "done": false, "episodes_total": 50, "training_iteration": 5, "trial_id": "default", "date": "2024-05-19_13-55-23", "timestamp": 1716152123, "time_this_iter_s": 53.71667766571045, "time_total_s": 213.8707025051117, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 213.8707025051117, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.95873015873016, "ram_util_percent": 32.35555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4490491151809692, "mean_q": 56.62255859375, "min_q": 46.17825698852539, "max_q": 65.87434387207031, "cur_lr": 0.0005}, "td_error": [-0.6454048156738281, 5.997699737548828, -1.3612594604492188, 2.1549758911132812, -4.482990264892578, -0.24662399291992188, -0.5701332092285156, 2.9830665588378906, -1.9016876220703125, -2.1832809448242188, -1.5136909484863281, 1.4790687561035156, -3.2754058837890625, 8.57708740234375, 2.1734580993652344, -2.9714622497558594, -2.0083160400390625, -1.8748588562011719, -1.12457275390625, 4.332756042480469, 1.4668388366699219, -2.4173355102539062, 15.404964447021484, -0.06624603271484375, 2.1056861877441406, -1.3484649658203125, 0.46735382080078125, -0.3886871337890625, 1.7563285827636719, 1.43524169921875, -0.7553634643554688, -3.4122657775878906], "mean_td_error": 0.5558273792266846, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 5000.0, "diff_num_grad_updates_vs_sampler_policy": 4999.0}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "last_target_update_ts": 5501, "num_target_updates": 10}, "sampler_results": {"episode_reward_max": 452.0, "episode_reward_min": 312.0, "episode_reward_mean": 380.26666666666665, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 6000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49472191503440743, "mean_inference_ms": 1.6541208505256781, "mean_action_processing_ms": 0.06965623826879991, "mean_env_wait_ms": 0.6704890402486963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026433865229288738, "StateBufferConnector_ms": 0.0033283233642578125, "ViewRequirementAgentConnector_ms": 0.14313379923502603}, "num_episodes": 10, "episode_return_max": 452.0, "episode_return_min": 312.0, "episode_return_mean": 380.26666666666665}, "env_runner_results": {"episode_reward_max": 452.0, "episode_reward_min": 312.0, "episode_reward_mean": 380.26666666666665, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 6000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49472191503440743, "mean_inference_ms": 1.6541208505256781, "mean_action_processing_ms": 0.06965623826879991, "mean_env_wait_ms": 0.6704890402486963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026433865229288738, "StateBufferConnector_ms": 0.0033283233642578125, "ViewRequirementAgentConnector_ms": 0.14313379923502603}, "num_episodes": 10, "episode_return_max": 452.0, "episode_return_min": 312.0, "episode_return_mean": 380.26666666666665}, "episode_reward_max": 452.0, "episode_reward_min": 312.0, "episode_reward_mean": 380.26666666666665, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 6000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49472191503440743, "mean_inference_ms": 1.6541208505256781, "mean_action_processing_ms": 0.06965623826879991, "mean_env_wait_ms": 0.6704890402486963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026433865229288738, "StateBufferConnector_ms": 0.0033283233642578125, "ViewRequirementAgentConnector_ms": 0.14313379923502603}, "num_episodes": 10, "episode_return_max": 452.0, "episode_return_min": 312.0, "episode_return_mean": 380.26666666666665, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.386463812593213, "num_env_steps_trained_throughput_per_sec": 588.3668420029828, "timesteps_total": 6000, "num_env_steps_sampled_lifetime": 6000, "num_agent_steps_sampled_lifetime": 6000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 44701.323, "restore_workers_time_ms": 0.0, "training_step_time_ms": 57.585, "sample_time_ms": 18.678, "load_time_ms": 0.25, "load_throughput": 127875.122, "learn_time_ms": 22.578, "learn_throughput": 1417.279, "synch_weights_time_ms": 5.72}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 160000, "last_target_update_ts": 5501, "num_target_updates": 10}, "done": false, "episodes_total": 60, "training_iteration": 6, "trial_id": "default", "date": "2024-05-19_13-56-52", "timestamp": 1716152212, "time_this_iter_s": 54.39734625816345, "time_total_s": 268.26804876327515, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 268.26804876327515, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 21.61417322834646, "ram_util_percent": 32.170866141732276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6604976654052734, "mean_q": 65.15082550048828, "min_q": 52.959102630615234, "max_q": 80.74735260009766, "cur_lr": 0.0005}, "td_error": [0.702728271484375, -4.086692810058594, -0.56646728515625, 4.817787170410156, -3.7856292724609375, -2.0765304565429688, 2.4583206176757812, 10.984294891357422, 1.4734878540039062, 66.41293334960938, -1.2169113159179688, 1.4918136596679688, -1.7159957885742188, 2.150035858154297, -0.20037460327148438, 2.21435546875, -1.59368896484375, 5.620109558105469, 2.232086181640625, 1.6111984252929688, -2.778778076171875, 0.2940330505371094, -1.06976318359375, 3.168182373046875, 0.8055343627929688, -1.9110107421875, -0.3196563720703125, 1.140655517578125, 59.02516174316406, 3.4856338500976562, -0.5977439880371094, 3.115875244140625], "mean_td_error": 4.72765588760376, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 6000.0, "diff_num_grad_updates_vs_sampler_policy": 5999.0}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "last_target_update_ts": 6501, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": 473.0, "episode_reward_min": 312.0, "episode_reward_mean": 388.75714285714287, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 7000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0, 439.0, 420.0, 427.0, 401.0, 461.0, 435.0, 442.0, 464.0, 473.0, 435.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5072166756075993, "mean_inference_ms": 1.6777658379217084, "mean_action_processing_ms": 0.07057744251615838, "mean_env_wait_ms": 0.6797823184806056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02408947263445173, "StateBufferConnector_ms": 0.002852848597935268, "ViewRequirementAgentConnector_ms": 0.1441373143877302}, "num_episodes": 10, "episode_return_max": 473.0, "episode_return_min": 312.0, "episode_return_mean": 388.75714285714287}, "env_runner_results": {"episode_reward_max": 473.0, "episode_reward_min": 312.0, "episode_reward_mean": 388.75714285714287, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 7000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0, 439.0, 420.0, 427.0, 401.0, 461.0, 435.0, 442.0, 464.0, 473.0, 435.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5072166756075993, "mean_inference_ms": 1.6777658379217084, "mean_action_processing_ms": 0.07057744251615838, "mean_env_wait_ms": 0.6797823184806056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02408947263445173, "StateBufferConnector_ms": 0.002852848597935268, "ViewRequirementAgentConnector_ms": 0.1441373143877302}, "num_episodes": 10, "episode_return_max": 473.0, "episode_return_min": 312.0, "episode_return_mean": 388.75714285714287}, "episode_reward_max": 473.0, "episode_reward_min": 312.0, "episode_reward_mean": 388.75714285714287, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 7000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0, 439.0, 420.0, 427.0, 401.0, 461.0, 435.0, 442.0, 464.0, 473.0, 435.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5072166756075993, "mean_inference_ms": 1.6777658379217084, "mean_action_processing_ms": 0.07057744251615838, "mean_env_wait_ms": 0.6797823184806056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02408947263445173, "StateBufferConnector_ms": 0.002852848597935268, "ViewRequirementAgentConnector_ms": 0.1441373143877302}, "num_episodes": 10, "episode_return_max": 473.0, "episode_return_min": 312.0, "episode_return_mean": 388.75714285714287, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.360199258246556, "num_env_steps_trained_throughput_per_sec": 587.5263762638898, "timesteps_total": 7000, "num_env_steps_sampled_lifetime": 7000, "num_agent_steps_sampled_lifetime": 7000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 7000, "timers": {"training_iteration_time_ms": 46096.225, "restore_workers_time_ms": 0.0, "training_step_time_ms": 54.472, "sample_time_ms": 17.238, "load_time_ms": 0.1, "load_throughput": 318882.699, "learn_time_ms": 22.197, "learn_throughput": 1441.659, "synch_weights_time_ms": 6.306}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 7000, "num_agent_steps_trained": 192000, "last_target_update_ts": 6501, "num_target_updates": 12}, "done": false, "episodes_total": 70, "training_iteration": 7, "trial_id": "default", "date": "2024-05-19_13-58-22", "timestamp": 1716152302, "time_this_iter_s": 54.47816753387451, "time_total_s": 322.74621629714966, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 322.74621629714966, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 22.4244094488189, "ram_util_percent": 32.12047244094488}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7273905277252197, "mean_q": 75.85445404052734, "min_q": 49.07865905761719, "max_q": 87.7780990600586, "cur_lr": 0.0005}, "td_error": [-3.83294677734375, -2.8881301879882812, 8.663444519042969, -0.9689483642578125, 0.5861358642578125, 2.3734512329101562, 3.5560150146484375, -0.631378173828125, 13.11043930053711, -2.796600341796875, -6.9943084716796875, 3.7377853393554688, -5.649803161621094, 72.20100402832031, 0.8254852294921875, -1.5341415405273438, 5.124763488769531, -0.5048141479492188, -0.06751251220703125, 2.8374862670898438, -3.1330718994140625, 1.0412673950195312, -2.3827438354492188, 3.0907440185546875, 2.20123291015625, 1.1704940795898438, 0.7180633544921875, -3.2104110717773438, 5.496971130371094, -3.7564544677734375, -2.3017730712890625, 4.112983703613281], "mean_td_error": 2.818585157394409, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 7000.0, "diff_num_grad_updates_vs_sampler_policy": 6999.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "last_target_update_ts": 7501, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": 485.0, "episode_reward_min": 312.0, "episode_reward_mean": 398.3, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0, 439.0, 420.0, 427.0, 401.0, 461.0, 435.0, 442.0, 464.0, 473.0, 435.0, 451.0, 485.0, 483.0, 459.0, 445.0, 469.0, 464.0, 474.0, 437.0, 484.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5178621691918625, "mean_inference_ms": 1.6965922648952905, "mean_action_processing_ms": 0.0715433490864956, "mean_env_wait_ms": 0.6871573417760563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025457143783569336, "StateBufferConnector_ms": 0.005200505256652832, "ViewRequirementAgentConnector_ms": 0.13487964868545532}, "num_episodes": 10, "episode_return_max": 485.0, "episode_return_min": 312.0, "episode_return_mean": 398.3}, "env_runner_results": {"episode_reward_max": 485.0, "episode_reward_min": 312.0, "episode_reward_mean": 398.3, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0, 439.0, 420.0, 427.0, 401.0, 461.0, 435.0, 442.0, 464.0, 473.0, 435.0, 451.0, 485.0, 483.0, 459.0, 445.0, 469.0, 464.0, 474.0, 437.0, 484.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5178621691918625, "mean_inference_ms": 1.6965922648952905, "mean_action_processing_ms": 0.0715433490864956, "mean_env_wait_ms": 0.6871573417760563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025457143783569336, "StateBufferConnector_ms": 0.005200505256652832, "ViewRequirementAgentConnector_ms": 0.13487964868545532}, "num_episodes": 10, "episode_return_max": 485.0, "episode_return_min": 312.0, "episode_return_mean": 398.3}, "episode_reward_max": 485.0, "episode_reward_min": 312.0, "episode_reward_mean": 398.3, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0, 439.0, 420.0, 427.0, 401.0, 461.0, 435.0, 442.0, 464.0, 473.0, 435.0, 451.0, 485.0, 483.0, 459.0, 445.0, 469.0, 464.0, 474.0, 437.0, 484.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5178621691918625, "mean_inference_ms": 1.6965922648952905, "mean_action_processing_ms": 0.0715433490864956, "mean_env_wait_ms": 0.6871573417760563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025457143783569336, "StateBufferConnector_ms": 0.005200505256652832, "ViewRequirementAgentConnector_ms": 0.13487964868545532}, "num_episodes": 10, "episode_return_max": 485.0, "episode_return_min": 312.0, "episode_return_mean": 398.3, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.2989774064932, "num_env_steps_trained_throughput_per_sec": 585.5672770077824, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 47165.18, "restore_workers_time_ms": 0.0, "training_step_time_ms": 53.091, "sample_time_ms": 15.976, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 21.269, "learn_throughput": 1504.504, "synch_weights_time_ms": 6.159}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 224000, "last_target_update_ts": 7501, "num_target_updates": 14}, "done": false, "episodes_total": 80, "training_iteration": 8, "trial_id": "default", "date": "2024-05-19_13-59-52", "timestamp": 1716152392, "time_this_iter_s": 54.664379596710205, "time_total_s": 377.41059589385986, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 377.41059589385986, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.688976377952756, "ram_util_percent": 32.13937007874017}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0378739833831787, "mean_q": 80.58460235595703, "min_q": 2.2653141021728516, "max_q": 99.59164428710938, "cur_lr": 0.0005}, "td_error": [-6.7928924560546875, 2.7113800048828125, 1.2784271240234375, 1.3826828002929688, 0.9704513549804688, 16.988718032836914, -1.3119735717773438, -0.7271041870117188, 0.45716094970703125, 2.3381881713867188, 1.6910934448242188, -1.8737564086914062, 1.08990478515625, -1.0980377197265625, -6.7809906005859375, 3.8537139892578125, -0.42108917236328125, -2.3489227294921875, -0.10634613037109375, 1.7785263061523438, 0.7526931762695312, 3.5247573852539062, 0.9847412109375, -2.058074951171875, 0.5257339477539062, 2.8873138427734375, 80.23592376708984, 3.2653141021728516, 8.891433715820312, -1.8289566040039062, 0.99481201171875, -6.461894989013672], "mean_td_error": 3.2747788429260254, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 8000.0, "diff_num_grad_updates_vs_sampler_policy": 7999.0}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "last_target_update_ts": 8501, "num_target_updates": 16}, "sampler_results": {"episode_reward_max": 496.0, "episode_reward_min": 312.0, "episode_reward_mean": 405.73333333333335, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 9000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0, 439.0, 420.0, 427.0, 401.0, 461.0, 435.0, 442.0, 464.0, 473.0, 435.0, 451.0, 485.0, 483.0, 459.0, 445.0, 469.0, 464.0, 474.0, 437.0, 484.0, 478.0, 484.0, 481.0, 496.0, 467.0, 458.0, 425.0, 468.0, 451.0, 444.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.52706150107669, "mean_inference_ms": 1.711938083167222, "mean_action_processing_ms": 0.07251777213291512, "mean_env_wait_ms": 0.693460701691287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025410122341579862, "StateBufferConnector_ms": 0.0057379404703776045, "ViewRequirementAgentConnector_ms": 0.12934817208184135}, "num_episodes": 10, "episode_return_max": 496.0, "episode_return_min": 312.0, "episode_return_mean": 405.73333333333335}, "env_runner_results": {"episode_reward_max": 496.0, "episode_reward_min": 312.0, "episode_reward_mean": 405.73333333333335, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 9000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0, 439.0, 420.0, 427.0, 401.0, 461.0, 435.0, 442.0, 464.0, 473.0, 435.0, 451.0, 485.0, 483.0, 459.0, 445.0, 469.0, 464.0, 474.0, 437.0, 484.0, 478.0, 484.0, 481.0, 496.0, 467.0, 458.0, 425.0, 468.0, 451.0, 444.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.52706150107669, "mean_inference_ms": 1.711938083167222, "mean_action_processing_ms": 0.07251777213291512, "mean_env_wait_ms": 0.693460701691287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025410122341579862, "StateBufferConnector_ms": 0.0057379404703776045, "ViewRequirementAgentConnector_ms": 0.12934817208184135}, "num_episodes": 10, "episode_return_max": 496.0, "episode_return_min": 312.0, "episode_return_mean": 405.73333333333335}, "episode_reward_max": 496.0, "episode_reward_min": 312.0, "episode_reward_mean": 405.73333333333335, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 9000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0, 439.0, 420.0, 427.0, 401.0, 461.0, 435.0, 442.0, 464.0, 473.0, 435.0, 451.0, 485.0, 483.0, 459.0, 445.0, 469.0, 464.0, 474.0, 437.0, 484.0, 478.0, 484.0, 481.0, 496.0, 467.0, 458.0, 425.0, 468.0, 451.0, 444.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.52706150107669, "mean_inference_ms": 1.711938083167222, "mean_action_processing_ms": 0.07251777213291512, "mean_env_wait_ms": 0.693460701691287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025410122341579862, "StateBufferConnector_ms": 0.0057379404703776045, "ViewRequirementAgentConnector_ms": 0.12934817208184135}, "num_episodes": 10, "episode_return_max": 496.0, "episode_return_min": 312.0, "episode_return_mean": 405.73333333333335, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.269486194134913, "num_env_steps_trained_throughput_per_sec": 584.6235582123172, "timesteps_total": 9000, "num_env_steps_sampled_lifetime": 9000, "num_agent_steps_sampled_lifetime": 9000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 48006.391, "restore_workers_time_ms": 0.0, "training_step_time_ms": 50.895, "sample_time_ms": 14.931, "load_time_ms": 0.2, "load_throughput": 160011.598, "learn_time_ms": 21.097, "learn_throughput": 1516.811, "synch_weights_time_ms": 6.81}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 256000, "last_target_update_ts": 8501, "num_target_updates": 16}, "done": false, "episodes_total": 90, "training_iteration": 9, "trial_id": "default", "date": "2024-05-19_14-01-22", "timestamp": 1716152482, "time_this_iter_s": 54.747095584869385, "time_total_s": 432.15769147872925, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 432.15769147872925, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 21.628346456692917, "ram_util_percent": 32.194488188976365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5809279680252075, "mean_q": 85.87500762939453, "min_q": 3.5575947761535645, "max_q": 101.98345947265625, "cur_lr": 0.0005}, "td_error": [-2.5595016479492188, -0.7960968017578125, -0.46759033203125, 5.0255279541015625, 0.14600372314453125, 0.6552810668945312, 3.2515106201171875, 0.521148681640625, -0.991455078125, 4.206733703613281, -3.1728668212890625, -3.261871337890625, 1.2713623046875, -5.8443450927734375, 0.9569625854492188, 26.428272247314453, -0.06317901611328125, 16.124053955078125, 1.0047836303710938, -34.20365524291992, -1.6699981689453125, -0.9364700317382812, 3.4410552978515625, 1.495880126953125, -0.8255844116210938, -2.1303939819335938, 0.7018890380859375, -1.9171066284179688, -6.6384429931640625, -2.4808425903320312, 2.555816650390625, 5.063163757324219], "mean_td_error": 0.15281391143798828, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 32.0, "num_grad_updates_lifetime": 9000.0, "diff_num_grad_updates_vs_sampler_policy": 8999.0}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "last_target_update_ts": 9501, "num_target_updates": 18}, "sampler_results": {"episode_reward_max": 530.0, "episode_reward_min": 312.0, "episode_reward_mean": 414.36, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0, 439.0, 420.0, 427.0, 401.0, 461.0, 435.0, 442.0, 464.0, 473.0, 435.0, 451.0, 485.0, 483.0, 459.0, 445.0, 469.0, 464.0, 474.0, 437.0, 484.0, 478.0, 484.0, 481.0, 496.0, 467.0, 458.0, 425.0, 468.0, 451.0, 444.0, 470.0, 509.0, 477.0, 452.0, 477.0, 530.0, 519.0, 494.0, 503.0, 489.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349002484369769, "mean_inference_ms": 1.7252558196142969, "mean_action_processing_ms": 0.07343326996610579, "mean_env_wait_ms": 0.6988142571826088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023868322372436523, "StateBufferConnector_ms": 0.006164073944091797, "ViewRequirementAgentConnector_ms": 0.12442374229431152}, "num_episodes": 10, "episode_return_max": 530.0, "episode_return_min": 312.0, "episode_return_mean": 414.36}, "env_runner_results": {"episode_reward_max": 530.0, "episode_reward_min": 312.0, "episode_reward_mean": 414.36, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0, 439.0, 420.0, 427.0, 401.0, 461.0, 435.0, 442.0, 464.0, 473.0, 435.0, 451.0, 485.0, 483.0, 459.0, 445.0, 469.0, 464.0, 474.0, 437.0, 484.0, 478.0, 484.0, 481.0, 496.0, 467.0, 458.0, 425.0, 468.0, 451.0, 444.0, 470.0, 509.0, 477.0, 452.0, 477.0, 530.0, 519.0, 494.0, 503.0, 489.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349002484369769, "mean_inference_ms": 1.7252558196142969, "mean_action_processing_ms": 0.07343326996610579, "mean_env_wait_ms": 0.6988142571826088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023868322372436523, "StateBufferConnector_ms": 0.006164073944091797, "ViewRequirementAgentConnector_ms": 0.12442374229431152}, "num_episodes": 10, "episode_return_max": 530.0, "episode_return_min": 312.0, "episode_return_mean": 414.36}, "episode_reward_max": 530.0, "episode_reward_min": 312.0, "episode_reward_mean": 414.36, "episode_len_mean": 100.0, "episodes_this_iter": 10, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.0, 362.0, 336.0, 346.0, 314.0, 312.0, 356.0, 323.0, 330.0, 380.0, 327.0, 380.0, 363.0, 356.0, 372.0, 337.0, 350.0, 329.0, 382.0, 341.0, 375.0, 339.0, 347.0, 377.0, 366.0, 418.0, 416.0, 382.0, 382.0, 384.0, 375.0, 381.0, 408.0, 406.0, 422.0, 392.0, 377.0, 415.0, 391.0, 385.0, 382.0, 380.0, 391.0, 388.0, 402.0, 416.0, 399.0, 359.0, 369.0, 400.0, 435.0, 414.0, 413.0, 448.0, 434.0, 419.0, 446.0, 400.0, 401.0, 452.0, 439.0, 420.0, 427.0, 401.0, 461.0, 435.0, 442.0, 464.0, 473.0, 435.0, 451.0, 485.0, 483.0, 459.0, 445.0, 469.0, 464.0, 474.0, 437.0, 484.0, 478.0, 484.0, 481.0, 496.0, 467.0, 458.0, 425.0, 468.0, 451.0, 444.0, 470.0, 509.0, 477.0, 452.0, 477.0, 530.0, 519.0, 494.0, 503.0, 489.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5349002484369769, "mean_inference_ms": 1.7252558196142969, "mean_action_processing_ms": 0.07343326996610579, "mean_env_wait_ms": 0.6988142571826088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023868322372436523, "StateBufferConnector_ms": 0.006164073944091797, "ViewRequirementAgentConnector_ms": 0.12442374229431152}, "num_episodes": 10, "episode_return_max": 530.0, "episode_return_min": 312.0, "episode_return_mean": 414.36, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 1000, "num_env_steps_trained_this_iter": 32000, "num_env_steps_sampled_throughput_per_sec": 18.166863165556883, "num_env_steps_trained_throughput_per_sec": 581.3396212978203, "timesteps_total": 10000, "num_env_steps_sampled_lifetime": 10000, "num_agent_steps_sampled_lifetime": 10000, "num_steps_trained_this_iter": 32000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 48710.279, "restore_workers_time_ms": 0.0, "training_step_time_ms": 57.876, "sample_time_ms": 17.056, "load_time_ms": 0.1, "load_throughput": 320023.195, "learn_time_ms": 23.844, "learn_throughput": 1342.082, "synch_weights_time_ms": 6.46}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 288000, "last_target_update_ts": 9501, "num_target_updates": 18}, "done": false, "episodes_total": 100, "training_iteration": 10, "trial_id": "default", "date": "2024-05-19_14-02-53", "timestamp": 1716152573, "time_this_iter_s": 55.057814598083496, "time_total_s": 487.21550607681274, "pid": 33100, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 32, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 1.0, "final_epsilon": 0.02, "epsilon_timesteps": 10000}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000174338CD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": {"explore": false}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 1000, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "epsilon": [[0, 1.0], [10000, 0.05]], "target_network_update_freq": 500, "num_steps_sampled_before_learning_starts": 1000, "store_buffer_in_checkpoints": false, "lr_schedule": null, "adam_epsilon": 1e-08, "tau": 1.0, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "hiddens": [256], "double_q": true, "n_step": 1, "before_learn_on_batch": null, "training_intensity": null, "td_error_loss_fn": "huber", "categorical_distribution_temperature": 1.0, "replay_buffer_config": {"type": "<class 'ray.rllib.utils.replay_buffers.multi_agent_prioritized_replay_buffer.MultiAgentPrioritizedReplayBuffer'>", "prioritized_replay": -1, "capacity": 60000, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.5, "prioritized_replay_eps": 3e-06, "replay_sequence_length": 1, "worker_side_prioritization": false}, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 487.21550607681274, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.014728682170542, "ram_util_percent": 32.231782945736434}}
