{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.751779233255694, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0, "total_loss": 9.924175047105358, "policy_loss": -0.008930759264096137, "vf_loss": 9.933105960969002, "vf_explained_var": 1.0786517973869078e-06, "kl": -2.1518557992831093e-10, "entropy": 2.079430833939583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 372.0, "episode_reward_min": 290.0, "episode_reward_mean": 335.7, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.0, 336.0, 348.0, 313.0, 328.0, 313.0, 332.0, 313.0, 346.0, 359.0, 290.0, 342.0, 331.0, 354.0, 352.0, 353.0, 321.0, 349.0, 359.0, 332.0, 357.0, 372.0, 352.0, 299.0, 320.0, 290.0, 331.0, 304.0, 358.0, 370.0, 353.0, 364.0, 337.0, 345.0, 326.0, 318.0, 369.0, 332.0, 333.0, 330.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17637415130088938, "mean_inference_ms": 1.3365782490076943, "mean_action_processing_ms": 0.05938833399255167, "mean_env_wait_ms": 0.5531799671084426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018183588981628418, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.05785167217254639}, "num_episodes": 40, "episode_return_max": 372.0, "episode_return_min": 290.0, "episode_return_mean": 335.7}, "env_runner_results": {"episode_reward_max": 372.0, "episode_reward_min": 290.0, "episode_reward_mean": 335.7, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.0, 336.0, 348.0, 313.0, 328.0, 313.0, 332.0, 313.0, 346.0, 359.0, 290.0, 342.0, 331.0, 354.0, 352.0, 353.0, 321.0, 349.0, 359.0, 332.0, 357.0, 372.0, 352.0, 299.0, 320.0, 290.0, 331.0, 304.0, 358.0, 370.0, 353.0, 364.0, 337.0, 345.0, 326.0, 318.0, 369.0, 332.0, 333.0, 330.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17637415130088938, "mean_inference_ms": 1.3365782490076943, "mean_action_processing_ms": 0.05938833399255167, "mean_env_wait_ms": 0.5531799671084426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018183588981628418, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.05785167217254639}, "num_episodes": 40, "episode_return_max": 372.0, "episode_return_min": 290.0, "episode_return_mean": 335.7}, "episode_reward_max": 372.0, "episode_reward_min": 290.0, "episode_reward_mean": 335.7, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 4000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [297.0, 336.0, 348.0, 313.0, 328.0, 313.0, 332.0, 313.0, 346.0, 359.0, 290.0, 342.0, 331.0, 354.0, 352.0, 353.0, 321.0, 349.0, 359.0, 332.0, 357.0, 372.0, 352.0, 299.0, 320.0, 290.0, 331.0, 304.0, 358.0, 370.0, 353.0, 364.0, 337.0, 345.0, 326.0, 318.0, 369.0, 332.0, 333.0, 330.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17637415130088938, "mean_inference_ms": 1.3365782490076943, "mean_action_processing_ms": 0.05938833399255167, "mean_env_wait_ms": 0.5531799671084426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018183588981628418, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.05785167217254639}, "num_episodes": 40, "episode_return_max": 372.0, "episode_return_min": 290.0, "episode_return_mean": 335.7, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.27669689765918, "num_env_steps_trained_throughput_per_sec": 213.27669689765918, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 18754.979, "restore_workers_time_ms": 0.0, "training_step_time_ms": 18754.979, "sample_time_ms": 8542.345, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 10211.13, "learn_throughput": 391.729, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "default", "date": "2024-05-18_20-50-47", "timestamp": 1716090647, "time_this_iter_s": 18.754979133605957, "time_total_s": 18.754979133605957, "pid": 45440, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021ED8029620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 18.754979133605957, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 8.28888888888889, "ram_util_percent": 34.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9367466549719534, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0, "total_loss": 9.917384793681483, "policy_loss": -0.009725129982877162, "vf_loss": 9.927109841377504, "vf_explained_var": -1.038274457377772e-06, "kl": -2.1485458125897731e-10, "entropy": 2.079431072358162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 372.0, "episode_reward_min": 266.0, "episode_reward_mean": 333.25, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.0, 336.0, 348.0, 313.0, 328.0, 313.0, 332.0, 313.0, 346.0, 359.0, 290.0, 342.0, 331.0, 354.0, 352.0, 353.0, 321.0, 349.0, 359.0, 332.0, 357.0, 372.0, 352.0, 299.0, 320.0, 290.0, 331.0, 304.0, 358.0, 370.0, 353.0, 364.0, 337.0, 345.0, 326.0, 318.0, 369.0, 332.0, 333.0, 330.0, 302.0, 326.0, 322.0, 334.0, 327.0, 311.0, 369.0, 362.0, 302.0, 321.0, 339.0, 353.0, 325.0, 316.0, 335.0, 326.0, 348.0, 321.0, 306.0, 332.0, 317.0, 329.0, 346.0, 349.0, 360.0, 343.0, 357.0, 312.0, 328.0, 324.0, 361.0, 333.0, 332.0, 318.0, 352.0, 323.0, 310.0, 350.0, 266.0, 345.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17354891299295094, "mean_inference_ms": 1.3421321714495626, "mean_action_processing_ms": 0.05813683897436659, "mean_env_wait_ms": 0.5509644295339278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009721517562866211, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.06125211715698242}, "num_episodes": 40, "episode_return_max": 372.0, "episode_return_min": 266.0, "episode_return_mean": 333.25}, "env_runner_results": {"episode_reward_max": 372.0, "episode_reward_min": 266.0, "episode_reward_mean": 333.25, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.0, 336.0, 348.0, 313.0, 328.0, 313.0, 332.0, 313.0, 346.0, 359.0, 290.0, 342.0, 331.0, 354.0, 352.0, 353.0, 321.0, 349.0, 359.0, 332.0, 357.0, 372.0, 352.0, 299.0, 320.0, 290.0, 331.0, 304.0, 358.0, 370.0, 353.0, 364.0, 337.0, 345.0, 326.0, 318.0, 369.0, 332.0, 333.0, 330.0, 302.0, 326.0, 322.0, 334.0, 327.0, 311.0, 369.0, 362.0, 302.0, 321.0, 339.0, 353.0, 325.0, 316.0, 335.0, 326.0, 348.0, 321.0, 306.0, 332.0, 317.0, 329.0, 346.0, 349.0, 360.0, 343.0, 357.0, 312.0, 328.0, 324.0, 361.0, 333.0, 332.0, 318.0, 352.0, 323.0, 310.0, 350.0, 266.0, 345.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17354891299295094, "mean_inference_ms": 1.3421321714495626, "mean_action_processing_ms": 0.05813683897436659, "mean_env_wait_ms": 0.5509644295339278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009721517562866211, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.06125211715698242}, "num_episodes": 40, "episode_return_max": 372.0, "episode_return_min": 266.0, "episode_return_mean": 333.25}, "episode_reward_max": 372.0, "episode_reward_min": 266.0, "episode_reward_mean": 333.25, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 8000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [297.0, 336.0, 348.0, 313.0, 328.0, 313.0, 332.0, 313.0, 346.0, 359.0, 290.0, 342.0, 331.0, 354.0, 352.0, 353.0, 321.0, 349.0, 359.0, 332.0, 357.0, 372.0, 352.0, 299.0, 320.0, 290.0, 331.0, 304.0, 358.0, 370.0, 353.0, 364.0, 337.0, 345.0, 326.0, 318.0, 369.0, 332.0, 333.0, 330.0, 302.0, 326.0, 322.0, 334.0, 327.0, 311.0, 369.0, 362.0, 302.0, 321.0, 339.0, 353.0, 325.0, 316.0, 335.0, 326.0, 348.0, 321.0, 306.0, 332.0, 317.0, 329.0, 346.0, 349.0, 360.0, 343.0, 357.0, 312.0, 328.0, 324.0, 361.0, 333.0, 332.0, 318.0, 352.0, 323.0, 310.0, 350.0, 266.0, 345.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17354891299295094, "mean_inference_ms": 1.3421321714495626, "mean_action_processing_ms": 0.05813683897436659, "mean_env_wait_ms": 0.5509644295339278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009721517562866211, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.06125211715698242}, "num_episodes": 40, "episode_return_max": 372.0, "episode_return_min": 266.0, "episode_return_mean": 333.25, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.58513654046047, "num_env_steps_trained_throughput_per_sec": 211.58513654046047, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 18829.949, "restore_workers_time_ms": 0.0, "training_step_time_ms": 18829.949, "sample_time_ms": 8530.984, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 10297.713, "learn_throughput": 388.436, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 80, "training_iteration": 2, "trial_id": "default", "date": "2024-05-18_20-51-06", "timestamp": 1716090666, "time_this_iter_s": 18.904919624328613, "time_total_s": 37.65989875793457, "pid": 45440, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021ED8029620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 37.65989875793457, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 8.299999999999999, "ram_util_percent": 34.092592592592595}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7910461656508907, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0, "total_loss": 9.935284337689799, "policy_loss": -0.00768101119226025, "vf_loss": 9.942965353688885, "vf_explained_var": 1.4420478574691281e-06, "kl": -1.1126787708050413e-10, "entropy": 2.0794310569763184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 386.0, "episode_reward_min": 266.0, "episode_reward_mean": 334.68, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.0, 372.0, 352.0, 299.0, 320.0, 290.0, 331.0, 304.0, 358.0, 370.0, 353.0, 364.0, 337.0, 345.0, 326.0, 318.0, 369.0, 332.0, 333.0, 330.0, 302.0, 326.0, 322.0, 334.0, 327.0, 311.0, 369.0, 362.0, 302.0, 321.0, 339.0, 353.0, 325.0, 316.0, 335.0, 326.0, 348.0, 321.0, 306.0, 332.0, 317.0, 329.0, 346.0, 349.0, 360.0, 343.0, 357.0, 312.0, 328.0, 324.0, 361.0, 333.0, 332.0, 318.0, 352.0, 323.0, 310.0, 350.0, 266.0, 345.0, 351.0, 319.0, 370.0, 356.0, 277.0, 338.0, 338.0, 327.0, 356.0, 329.0, 324.0, 326.0, 307.0, 338.0, 307.0, 294.0, 347.0, 336.0, 339.0, 290.0, 348.0, 302.0, 329.0, 386.0, 344.0, 347.0, 352.0, 342.0, 341.0, 315.0, 336.0, 361.0, 340.0, 382.0, 346.0, 335.0, 365.0, 320.0, 337.0, 379.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16974903545419284, "mean_inference_ms": 1.3454392093759577, "mean_action_processing_ms": 0.05739672789372486, "mean_env_wait_ms": 0.5514398671715527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005506038665771484, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0624089241027832}, "num_episodes": 40, "episode_return_max": 386.0, "episode_return_min": 266.0, "episode_return_mean": 334.68}, "env_runner_results": {"episode_reward_max": 386.0, "episode_reward_min": 266.0, "episode_reward_mean": 334.68, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.0, 372.0, 352.0, 299.0, 320.0, 290.0, 331.0, 304.0, 358.0, 370.0, 353.0, 364.0, 337.0, 345.0, 326.0, 318.0, 369.0, 332.0, 333.0, 330.0, 302.0, 326.0, 322.0, 334.0, 327.0, 311.0, 369.0, 362.0, 302.0, 321.0, 339.0, 353.0, 325.0, 316.0, 335.0, 326.0, 348.0, 321.0, 306.0, 332.0, 317.0, 329.0, 346.0, 349.0, 360.0, 343.0, 357.0, 312.0, 328.0, 324.0, 361.0, 333.0, 332.0, 318.0, 352.0, 323.0, 310.0, 350.0, 266.0, 345.0, 351.0, 319.0, 370.0, 356.0, 277.0, 338.0, 338.0, 327.0, 356.0, 329.0, 324.0, 326.0, 307.0, 338.0, 307.0, 294.0, 347.0, 336.0, 339.0, 290.0, 348.0, 302.0, 329.0, 386.0, 344.0, 347.0, 352.0, 342.0, 341.0, 315.0, 336.0, 361.0, 340.0, 382.0, 346.0, 335.0, 365.0, 320.0, 337.0, 379.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16974903545419284, "mean_inference_ms": 1.3454392093759577, "mean_action_processing_ms": 0.05739672789372486, "mean_env_wait_ms": 0.5514398671715527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005506038665771484, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0624089241027832}, "num_episodes": 40, "episode_return_max": 386.0, "episode_return_min": 266.0, "episode_return_mean": 334.68}, "episode_reward_max": 386.0, "episode_reward_min": 266.0, "episode_reward_mean": 334.68, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [357.0, 372.0, 352.0, 299.0, 320.0, 290.0, 331.0, 304.0, 358.0, 370.0, 353.0, 364.0, 337.0, 345.0, 326.0, 318.0, 369.0, 332.0, 333.0, 330.0, 302.0, 326.0, 322.0, 334.0, 327.0, 311.0, 369.0, 362.0, 302.0, 321.0, 339.0, 353.0, 325.0, 316.0, 335.0, 326.0, 348.0, 321.0, 306.0, 332.0, 317.0, 329.0, 346.0, 349.0, 360.0, 343.0, 357.0, 312.0, 328.0, 324.0, 361.0, 333.0, 332.0, 318.0, 352.0, 323.0, 310.0, 350.0, 266.0, 345.0, 351.0, 319.0, 370.0, 356.0, 277.0, 338.0, 338.0, 327.0, 356.0, 329.0, 324.0, 326.0, 307.0, 338.0, 307.0, 294.0, 347.0, 336.0, 339.0, 290.0, 348.0, 302.0, 329.0, 386.0, 344.0, 347.0, 352.0, 342.0, 341.0, 315.0, 336.0, 361.0, 340.0, 382.0, 346.0, 335.0, 365.0, 320.0, 337.0, 379.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16974903545419284, "mean_inference_ms": 1.3454392093759577, "mean_action_processing_ms": 0.05739672789372486, "mean_env_wait_ms": 0.5514398671715527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005506038665771484, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0624089241027832}, "num_episodes": 40, "episode_return_max": 386.0, "episode_return_min": 266.0, "episode_return_mean": 334.68, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.93756940512327, "num_env_steps_trained_throughput_per_sec": 211.93756940512327, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 18844.46, "restore_workers_time_ms": 0.0, "training_step_time_ms": 18844.46, "sample_time_ms": 8526.354, "load_time_ms": 0.333, "load_throughput": 11998009.058, "learn_time_ms": 10316.938, "learn_throughput": 387.712, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 120, "training_iteration": 3, "trial_id": "default", "date": "2024-05-18_20-51-25", "timestamp": 1716090685, "time_this_iter_s": 18.8744854927063, "time_total_s": 56.53438425064087, "pid": 45440, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021ED8029620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 56.53438425064087, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 9.68148148148148, "ram_util_percent": 33.80740740740741}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.763882754310485, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0, "total_loss": 9.91833625301238, "policy_loss": -0.008942066781943845, "vf_loss": 9.927278518676758, "vf_explained_var": 1.6343209051316783e-07, "kl": -4.108916276220647e-10, "entropy": 2.0794310646672405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 386.0, "episode_reward_min": 266.0, "episode_reward_mean": 330.77, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [317.0, 329.0, 346.0, 349.0, 360.0, 343.0, 357.0, 312.0, 328.0, 324.0, 361.0, 333.0, 332.0, 318.0, 352.0, 323.0, 310.0, 350.0, 266.0, 345.0, 351.0, 319.0, 370.0, 356.0, 277.0, 338.0, 338.0, 327.0, 356.0, 329.0, 324.0, 326.0, 307.0, 338.0, 307.0, 294.0, 347.0, 336.0, 339.0, 290.0, 348.0, 302.0, 329.0, 386.0, 344.0, 347.0, 352.0, 342.0, 341.0, 315.0, 336.0, 361.0, 340.0, 382.0, 346.0, 335.0, 365.0, 320.0, 337.0, 379.0, 298.0, 296.0, 332.0, 324.0, 281.0, 334.0, 309.0, 322.0, 313.0, 322.0, 335.0, 366.0, 336.0, 329.0, 282.0, 359.0, 325.0, 318.0, 346.0, 291.0, 315.0, 301.0, 313.0, 345.0, 333.0, 332.0, 299.0, 281.0, 281.0, 346.0, 316.0, 364.0, 340.0, 348.0, 332.0, 365.0, 337.0, 319.0, 342.0, 319.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1655103294004748, "mean_inference_ms": 1.343927255186539, "mean_action_processing_ms": 0.056041867486873904, "mean_env_wait_ms": 0.5525405478553204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011014938354492188, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.05256152153015137}, "num_episodes": 40, "episode_return_max": 386.0, "episode_return_min": 266.0, "episode_return_mean": 330.77}, "env_runner_results": {"episode_reward_max": 386.0, "episode_reward_min": 266.0, "episode_reward_mean": 330.77, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [317.0, 329.0, 346.0, 349.0, 360.0, 343.0, 357.0, 312.0, 328.0, 324.0, 361.0, 333.0, 332.0, 318.0, 352.0, 323.0, 310.0, 350.0, 266.0, 345.0, 351.0, 319.0, 370.0, 356.0, 277.0, 338.0, 338.0, 327.0, 356.0, 329.0, 324.0, 326.0, 307.0, 338.0, 307.0, 294.0, 347.0, 336.0, 339.0, 290.0, 348.0, 302.0, 329.0, 386.0, 344.0, 347.0, 352.0, 342.0, 341.0, 315.0, 336.0, 361.0, 340.0, 382.0, 346.0, 335.0, 365.0, 320.0, 337.0, 379.0, 298.0, 296.0, 332.0, 324.0, 281.0, 334.0, 309.0, 322.0, 313.0, 322.0, 335.0, 366.0, 336.0, 329.0, 282.0, 359.0, 325.0, 318.0, 346.0, 291.0, 315.0, 301.0, 313.0, 345.0, 333.0, 332.0, 299.0, 281.0, 281.0, 346.0, 316.0, 364.0, 340.0, 348.0, 332.0, 365.0, 337.0, 319.0, 342.0, 319.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1655103294004748, "mean_inference_ms": 1.343927255186539, "mean_action_processing_ms": 0.056041867486873904, "mean_env_wait_ms": 0.5525405478553204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011014938354492188, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.05256152153015137}, "num_episodes": 40, "episode_return_max": 386.0, "episode_return_min": 266.0, "episode_return_mean": 330.77}, "episode_reward_max": 386.0, "episode_reward_min": 266.0, "episode_reward_mean": 330.77, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [317.0, 329.0, 346.0, 349.0, 360.0, 343.0, 357.0, 312.0, 328.0, 324.0, 361.0, 333.0, 332.0, 318.0, 352.0, 323.0, 310.0, 350.0, 266.0, 345.0, 351.0, 319.0, 370.0, 356.0, 277.0, 338.0, 338.0, 327.0, 356.0, 329.0, 324.0, 326.0, 307.0, 338.0, 307.0, 294.0, 347.0, 336.0, 339.0, 290.0, 348.0, 302.0, 329.0, 386.0, 344.0, 347.0, 352.0, 342.0, 341.0, 315.0, 336.0, 361.0, 340.0, 382.0, 346.0, 335.0, 365.0, 320.0, 337.0, 379.0, 298.0, 296.0, 332.0, 324.0, 281.0, 334.0, 309.0, 322.0, 313.0, 322.0, 335.0, 366.0, 336.0, 329.0, 282.0, 359.0, 325.0, 318.0, 346.0, 291.0, 315.0, 301.0, 313.0, 345.0, 333.0, 332.0, 299.0, 281.0, 281.0, 346.0, 316.0, 364.0, 340.0, 348.0, 332.0, 365.0, 337.0, 319.0, 342.0, 319.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1655103294004748, "mean_inference_ms": 1.343927255186539, "mean_action_processing_ms": 0.056041867486873904, "mean_env_wait_ms": 0.5525405478553204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011014938354492188, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.05256152153015137}, "num_episodes": 40, "episode_return_max": 386.0, "episode_return_min": 266.0, "episode_return_mean": 330.77, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.00373316076855, "num_env_steps_trained_throughput_per_sec": 214.00373316076855, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 18806.161, "restore_workers_time_ms": 0.0, "training_step_time_ms": 18806.161, "sample_time_ms": 8471.496, "load_time_ms": 0.25, "load_throughput": 15997345.411, "learn_time_ms": 10333.413, "learn_throughput": 387.094, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 160, "training_iteration": 4, "trial_id": "default", "date": "2024-05-18_20-51-43", "timestamp": 1716090703, "time_this_iter_s": 18.69126272201538, "time_total_s": 75.22564697265625, "pid": 45440, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021ED8029620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 75.22564697265625, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 7.53076923076923, "ram_util_percent": 33.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.789042592048645, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0, "total_loss": 9.934495033756379, "policy_loss": -0.008936594931348678, "vf_loss": 9.943431669665921, "vf_explained_var": -6.191192134734123e-07, "kl": 1.001056346239976e-09, "entropy": 2.079430910848802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 386.0, "episode_reward_min": 281.0, "episode_reward_mean": 333.19, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.0, 302.0, 329.0, 386.0, 344.0, 347.0, 352.0, 342.0, 341.0, 315.0, 336.0, 361.0, 340.0, 382.0, 346.0, 335.0, 365.0, 320.0, 337.0, 379.0, 298.0, 296.0, 332.0, 324.0, 281.0, 334.0, 309.0, 322.0, 313.0, 322.0, 335.0, 366.0, 336.0, 329.0, 282.0, 359.0, 325.0, 318.0, 346.0, 291.0, 315.0, 301.0, 313.0, 345.0, 333.0, 332.0, 299.0, 281.0, 281.0, 346.0, 316.0, 364.0, 340.0, 348.0, 332.0, 365.0, 337.0, 319.0, 342.0, 319.0, 353.0, 341.0, 324.0, 315.0, 353.0, 343.0, 338.0, 311.0, 365.0, 338.0, 355.0, 304.0, 335.0, 355.0, 333.0, 316.0, 371.0, 310.0, 346.0, 353.0, 356.0, 328.0, 345.0, 316.0, 333.0, 295.0, 324.0, 349.0, 337.0, 345.0, 299.0, 364.0, 342.0, 313.0, 348.0, 340.0, 334.0, 353.0, 359.0, 327.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16299436933215627, "mean_inference_ms": 1.3421896929439459, "mean_action_processing_ms": 0.05541936790510114, "mean_env_wait_ms": 0.5550265316020574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012722492218017578, "StateBufferConnector_ms": 0.0020003318786621094, "ViewRequirementAgentConnector_ms": 0.055428266525268555}, "num_episodes": 40, "episode_return_max": 386.0, "episode_return_min": 281.0, "episode_return_mean": 333.19}, "env_runner_results": {"episode_reward_max": 386.0, "episode_reward_min": 281.0, "episode_reward_mean": 333.19, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.0, 302.0, 329.0, 386.0, 344.0, 347.0, 352.0, 342.0, 341.0, 315.0, 336.0, 361.0, 340.0, 382.0, 346.0, 335.0, 365.0, 320.0, 337.0, 379.0, 298.0, 296.0, 332.0, 324.0, 281.0, 334.0, 309.0, 322.0, 313.0, 322.0, 335.0, 366.0, 336.0, 329.0, 282.0, 359.0, 325.0, 318.0, 346.0, 291.0, 315.0, 301.0, 313.0, 345.0, 333.0, 332.0, 299.0, 281.0, 281.0, 346.0, 316.0, 364.0, 340.0, 348.0, 332.0, 365.0, 337.0, 319.0, 342.0, 319.0, 353.0, 341.0, 324.0, 315.0, 353.0, 343.0, 338.0, 311.0, 365.0, 338.0, 355.0, 304.0, 335.0, 355.0, 333.0, 316.0, 371.0, 310.0, 346.0, 353.0, 356.0, 328.0, 345.0, 316.0, 333.0, 295.0, 324.0, 349.0, 337.0, 345.0, 299.0, 364.0, 342.0, 313.0, 348.0, 340.0, 334.0, 353.0, 359.0, 327.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16299436933215627, "mean_inference_ms": 1.3421896929439459, "mean_action_processing_ms": 0.05541936790510114, "mean_env_wait_ms": 0.5550265316020574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012722492218017578, "StateBufferConnector_ms": 0.0020003318786621094, "ViewRequirementAgentConnector_ms": 0.055428266525268555}, "num_episodes": 40, "episode_return_max": 386.0, "episode_return_min": 281.0, "episode_return_mean": 333.19}, "episode_reward_max": 386.0, "episode_reward_min": 281.0, "episode_reward_mean": 333.19, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [348.0, 302.0, 329.0, 386.0, 344.0, 347.0, 352.0, 342.0, 341.0, 315.0, 336.0, 361.0, 340.0, 382.0, 346.0, 335.0, 365.0, 320.0, 337.0, 379.0, 298.0, 296.0, 332.0, 324.0, 281.0, 334.0, 309.0, 322.0, 313.0, 322.0, 335.0, 366.0, 336.0, 329.0, 282.0, 359.0, 325.0, 318.0, 346.0, 291.0, 315.0, 301.0, 313.0, 345.0, 333.0, 332.0, 299.0, 281.0, 281.0, 346.0, 316.0, 364.0, 340.0, 348.0, 332.0, 365.0, 337.0, 319.0, 342.0, 319.0, 353.0, 341.0, 324.0, 315.0, 353.0, 343.0, 338.0, 311.0, 365.0, 338.0, 355.0, 304.0, 335.0, 355.0, 333.0, 316.0, 371.0, 310.0, 346.0, 353.0, 356.0, 328.0, 345.0, 316.0, 333.0, 295.0, 324.0, 349.0, 337.0, 345.0, 299.0, 364.0, 342.0, 313.0, 348.0, 340.0, 334.0, 353.0, 359.0, 327.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16299436933215627, "mean_inference_ms": 1.3421896929439459, "mean_action_processing_ms": 0.05541936790510114, "mean_env_wait_ms": 0.5550265316020574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012722492218017578, "StateBufferConnector_ms": 0.0020003318786621094, "ViewRequirementAgentConnector_ms": 0.055428266525268555}, "num_episodes": 40, "episode_return_max": 386.0, "episode_return_min": 281.0, "episode_return_mean": 333.19, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.4758631127604, "num_env_steps_trained_throughput_per_sec": 208.4758631127604, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 18882.303, "restore_workers_time_ms": 0.0, "training_step_time_ms": 18882.303, "sample_time_ms": 8501.345, "load_time_ms": 0.2, "load_throughput": 19996681.764, "learn_time_ms": 10379.957, "learn_throughput": 385.358, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 200, "training_iteration": 5, "trial_id": "default", "date": "2024-05-18_20-52-03", "timestamp": 1716090723, "time_this_iter_s": 19.18687343597412, "time_total_s": 94.41252040863037, "pid": 45440, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021ED8029620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 94.41252040863037, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 8.292592592592593, "ram_util_percent": 33.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6510105056147422, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0, "total_loss": 9.916140340989635, "policy_loss": -0.00951622141104552, "vf_loss": 9.92565647248299, "vf_explained_var": -5.200985939271989e-06, "kl": 5.875094443199844e-10, "entropy": 2.079431010830787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 371.0, "episode_reward_min": 281.0, "episode_reward_mean": 332.75, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [315.0, 301.0, 313.0, 345.0, 333.0, 332.0, 299.0, 281.0, 281.0, 346.0, 316.0, 364.0, 340.0, 348.0, 332.0, 365.0, 337.0, 319.0, 342.0, 319.0, 353.0, 341.0, 324.0, 315.0, 353.0, 343.0, 338.0, 311.0, 365.0, 338.0, 355.0, 304.0, 335.0, 355.0, 333.0, 316.0, 371.0, 310.0, 346.0, 353.0, 356.0, 328.0, 345.0, 316.0, 333.0, 295.0, 324.0, 349.0, 337.0, 345.0, 299.0, 364.0, 342.0, 313.0, 348.0, 340.0, 334.0, 353.0, 359.0, 327.0, 314.0, 342.0, 353.0, 352.0, 357.0, 357.0, 334.0, 305.0, 334.0, 339.0, 334.0, 284.0, 319.0, 311.0, 312.0, 329.0, 370.0, 339.0, 302.0, 361.0, 352.0, 324.0, 367.0, 335.0, 344.0, 317.0, 353.0, 342.0, 336.0, 320.0, 323.0, 321.0, 346.0, 340.0, 324.0, 308.0, 320.0, 324.0, 325.0, 312.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1616172817237659, "mean_inference_ms": 1.3422330089495977, "mean_action_processing_ms": 0.055071682721871615, "mean_env_wait_ms": 0.556001077146732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018843650817871094, "StateBufferConnector_ms": 0.0020017623901367188, "ViewRequirementAgentConnector_ms": 0.06227707862854004}, "num_episodes": 40, "episode_return_max": 371.0, "episode_return_min": 281.0, "episode_return_mean": 332.75}, "env_runner_results": {"episode_reward_max": 371.0, "episode_reward_min": 281.0, "episode_reward_mean": 332.75, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [315.0, 301.0, 313.0, 345.0, 333.0, 332.0, 299.0, 281.0, 281.0, 346.0, 316.0, 364.0, 340.0, 348.0, 332.0, 365.0, 337.0, 319.0, 342.0, 319.0, 353.0, 341.0, 324.0, 315.0, 353.0, 343.0, 338.0, 311.0, 365.0, 338.0, 355.0, 304.0, 335.0, 355.0, 333.0, 316.0, 371.0, 310.0, 346.0, 353.0, 356.0, 328.0, 345.0, 316.0, 333.0, 295.0, 324.0, 349.0, 337.0, 345.0, 299.0, 364.0, 342.0, 313.0, 348.0, 340.0, 334.0, 353.0, 359.0, 327.0, 314.0, 342.0, 353.0, 352.0, 357.0, 357.0, 334.0, 305.0, 334.0, 339.0, 334.0, 284.0, 319.0, 311.0, 312.0, 329.0, 370.0, 339.0, 302.0, 361.0, 352.0, 324.0, 367.0, 335.0, 344.0, 317.0, 353.0, 342.0, 336.0, 320.0, 323.0, 321.0, 346.0, 340.0, 324.0, 308.0, 320.0, 324.0, 325.0, 312.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1616172817237659, "mean_inference_ms": 1.3422330089495977, "mean_action_processing_ms": 0.055071682721871615, "mean_env_wait_ms": 0.556001077146732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018843650817871094, "StateBufferConnector_ms": 0.0020017623901367188, "ViewRequirementAgentConnector_ms": 0.06227707862854004}, "num_episodes": 40, "episode_return_max": 371.0, "episode_return_min": 281.0, "episode_return_mean": 332.75}, "episode_reward_max": 371.0, "episode_reward_min": 281.0, "episode_reward_mean": 332.75, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [315.0, 301.0, 313.0, 345.0, 333.0, 332.0, 299.0, 281.0, 281.0, 346.0, 316.0, 364.0, 340.0, 348.0, 332.0, 365.0, 337.0, 319.0, 342.0, 319.0, 353.0, 341.0, 324.0, 315.0, 353.0, 343.0, 338.0, 311.0, 365.0, 338.0, 355.0, 304.0, 335.0, 355.0, 333.0, 316.0, 371.0, 310.0, 346.0, 353.0, 356.0, 328.0, 345.0, 316.0, 333.0, 295.0, 324.0, 349.0, 337.0, 345.0, 299.0, 364.0, 342.0, 313.0, 348.0, 340.0, 334.0, 353.0, 359.0, 327.0, 314.0, 342.0, 353.0, 352.0, 357.0, 357.0, 334.0, 305.0, 334.0, 339.0, 334.0, 284.0, 319.0, 311.0, 312.0, 329.0, 370.0, 339.0, 302.0, 361.0, 352.0, 324.0, 367.0, 335.0, 344.0, 317.0, 353.0, 342.0, 336.0, 320.0, 323.0, 321.0, 346.0, 340.0, 324.0, 308.0, 320.0, 324.0, 325.0, 312.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1616172817237659, "mean_inference_ms": 1.3422330089495977, "mean_action_processing_ms": 0.055071682721871615, "mean_env_wait_ms": 0.556001077146732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018843650817871094, "StateBufferConnector_ms": 0.0020017623901367188, "ViewRequirementAgentConnector_ms": 0.06227707862854004}, "num_episodes": 40, "episode_return_max": 371.0, "episode_return_min": 281.0, "episode_return_mean": 332.75, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.9121558518708, "num_env_steps_trained_throughput_per_sec": 206.9121558518708, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 18957.232, "restore_workers_time_ms": 0.0, "training_step_time_ms": 18957.232, "sample_time_ms": 8491.577, "load_time_ms": 0.167, "load_throughput": 23996018.117, "learn_time_ms": 10464.821, "learn_throughput": 382.233, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 240, "training_iteration": 6, "trial_id": "default", "date": "2024-05-18_20-52-22", "timestamp": 1716090742, "time_this_iter_s": 19.331875324249268, "time_total_s": 113.74439573287964, "pid": 45440, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021ED8029620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 113.74439573287964, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 9.37142857142857, "ram_util_percent": 33.80357142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7995052568374141, "cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0, "total_loss": 9.932166161075715, "policy_loss": -0.008786718210866374, "vf_loss": 9.940952977826518, "vf_explained_var": 1.5804844517861643e-06, "kl": 9.918967081382158e-12, "entropy": 2.079430833939583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 370.0, "episode_reward_min": 278.0, "episode_reward_mean": 333.34, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 328.0, 345.0, 316.0, 333.0, 295.0, 324.0, 349.0, 337.0, 345.0, 299.0, 364.0, 342.0, 313.0, 348.0, 340.0, 334.0, 353.0, 359.0, 327.0, 314.0, 342.0, 353.0, 352.0, 357.0, 357.0, 334.0, 305.0, 334.0, 339.0, 334.0, 284.0, 319.0, 311.0, 312.0, 329.0, 370.0, 339.0, 302.0, 361.0, 352.0, 324.0, 367.0, 335.0, 344.0, 317.0, 353.0, 342.0, 336.0, 320.0, 323.0, 321.0, 346.0, 340.0, 324.0, 308.0, 320.0, 324.0, 325.0, 312.0, 349.0, 321.0, 315.0, 349.0, 317.0, 278.0, 337.0, 332.0, 355.0, 333.0, 334.0, 334.0, 370.0, 322.0, 359.0, 347.0, 350.0, 344.0, 336.0, 339.0, 345.0, 297.0, 320.0, 352.0, 323.0, 320.0, 336.0, 351.0, 328.0, 344.0, 324.0, 306.0, 315.0, 341.0, 337.0, 322.0, 334.0, 360.0, 322.0, 348.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16073976224598716, "mean_inference_ms": 1.3430970658481038, "mean_action_processing_ms": 0.0550635533253474, "mean_env_wait_ms": 0.556138325819016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014136552810668945, "StateBufferConnector_ms": 0.0020017623901367188, "ViewRequirementAgentConnector_ms": 0.06688117980957031}, "num_episodes": 40, "episode_return_max": 370.0, "episode_return_min": 278.0, "episode_return_mean": 333.34}, "env_runner_results": {"episode_reward_max": 370.0, "episode_reward_min": 278.0, "episode_reward_mean": 333.34, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 328.0, 345.0, 316.0, 333.0, 295.0, 324.0, 349.0, 337.0, 345.0, 299.0, 364.0, 342.0, 313.0, 348.0, 340.0, 334.0, 353.0, 359.0, 327.0, 314.0, 342.0, 353.0, 352.0, 357.0, 357.0, 334.0, 305.0, 334.0, 339.0, 334.0, 284.0, 319.0, 311.0, 312.0, 329.0, 370.0, 339.0, 302.0, 361.0, 352.0, 324.0, 367.0, 335.0, 344.0, 317.0, 353.0, 342.0, 336.0, 320.0, 323.0, 321.0, 346.0, 340.0, 324.0, 308.0, 320.0, 324.0, 325.0, 312.0, 349.0, 321.0, 315.0, 349.0, 317.0, 278.0, 337.0, 332.0, 355.0, 333.0, 334.0, 334.0, 370.0, 322.0, 359.0, 347.0, 350.0, 344.0, 336.0, 339.0, 345.0, 297.0, 320.0, 352.0, 323.0, 320.0, 336.0, 351.0, 328.0, 344.0, 324.0, 306.0, 315.0, 341.0, 337.0, 322.0, 334.0, 360.0, 322.0, 348.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16073976224598716, "mean_inference_ms": 1.3430970658481038, "mean_action_processing_ms": 0.0550635533253474, "mean_env_wait_ms": 0.556138325819016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014136552810668945, "StateBufferConnector_ms": 0.0020017623901367188, "ViewRequirementAgentConnector_ms": 0.06688117980957031}, "num_episodes": 40, "episode_return_max": 370.0, "episode_return_min": 278.0, "episode_return_mean": 333.34}, "episode_reward_max": 370.0, "episode_reward_min": 278.0, "episode_reward_mean": 333.34, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [356.0, 328.0, 345.0, 316.0, 333.0, 295.0, 324.0, 349.0, 337.0, 345.0, 299.0, 364.0, 342.0, 313.0, 348.0, 340.0, 334.0, 353.0, 359.0, 327.0, 314.0, 342.0, 353.0, 352.0, 357.0, 357.0, 334.0, 305.0, 334.0, 339.0, 334.0, 284.0, 319.0, 311.0, 312.0, 329.0, 370.0, 339.0, 302.0, 361.0, 352.0, 324.0, 367.0, 335.0, 344.0, 317.0, 353.0, 342.0, 336.0, 320.0, 323.0, 321.0, 346.0, 340.0, 324.0, 308.0, 320.0, 324.0, 325.0, 312.0, 349.0, 321.0, 315.0, 349.0, 317.0, 278.0, 337.0, 332.0, 355.0, 333.0, 334.0, 334.0, 370.0, 322.0, 359.0, 347.0, 350.0, 344.0, 336.0, 339.0, 345.0, 297.0, 320.0, 352.0, 323.0, 320.0, 336.0, 351.0, 328.0, 344.0, 324.0, 306.0, 315.0, 341.0, 337.0, 322.0, 334.0, 360.0, 322.0, 348.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16073976224598716, "mean_inference_ms": 1.3430970658481038, "mean_action_processing_ms": 0.0550635533253474, "mean_env_wait_ms": 0.556138325819016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014136552810668945, "StateBufferConnector_ms": 0.0020017623901367188, "ViewRequirementAgentConnector_ms": 0.06688117980957031}, "num_episodes": 40, "episode_return_max": 370.0, "episode_return_min": 278.0, "episode_return_mean": 333.34, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.30998292044688, "num_env_steps_trained_throughput_per_sec": 210.30998292044688, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 18966.134, "restore_workers_time_ms": 0.0, "training_step_time_ms": 18966.134, "sample_time_ms": 8489.44, "load_time_ms": 0.286, "load_throughput": 13999345.81, "learn_time_ms": 10475.835, "learn_throughput": 381.831, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 280, "training_iteration": 7, "trial_id": "default", "date": "2024-05-18_20-52-41", "timestamp": 1716090761, "time_this_iter_s": 19.020544052124023, "time_total_s": 132.76493978500366, "pid": 45440, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021ED8029620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 132.76493978500366, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 9.307407407407409, "ram_util_percent": 33.71851851851852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7729098085434205, "cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0, "total_loss": 9.909552420339276, "policy_loss": -0.008419663194687135, "vf_loss": 9.917971949423514, "vf_explained_var": 4.472271088630922e-06, "kl": 2.354564840591972e-10, "entropy": 2.0794309646852556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 371.0, "episode_reward_min": 278.0, "episode_reward_mean": 335.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.0, 324.0, 367.0, 335.0, 344.0, 317.0, 353.0, 342.0, 336.0, 320.0, 323.0, 321.0, 346.0, 340.0, 324.0, 308.0, 320.0, 324.0, 325.0, 312.0, 349.0, 321.0, 315.0, 349.0, 317.0, 278.0, 337.0, 332.0, 355.0, 333.0, 334.0, 334.0, 370.0, 322.0, 359.0, 347.0, 350.0, 344.0, 336.0, 339.0, 345.0, 297.0, 320.0, 352.0, 323.0, 320.0, 336.0, 351.0, 328.0, 344.0, 324.0, 306.0, 315.0, 341.0, 337.0, 322.0, 334.0, 360.0, 322.0, 348.0, 327.0, 343.0, 338.0, 342.0, 351.0, 339.0, 359.0, 341.0, 337.0, 333.0, 330.0, 341.0, 369.0, 324.0, 334.0, 371.0, 355.0, 326.0, 314.0, 358.0, 343.0, 321.0, 364.0, 350.0, 332.0, 354.0, 350.0, 330.0, 367.0, 317.0, 342.0, 337.0, 315.0, 337.0, 342.0, 308.0, 312.0, 348.0, 353.0, 359.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1589563958760889, "mean_inference_ms": 1.341895681875835, "mean_action_processing_ms": 0.055534031437340585, "mean_env_wait_ms": 0.5559995263299078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012539863586425781, "StateBufferConnector_ms": 0.0020055770874023438, "ViewRequirementAgentConnector_ms": 0.0644223690032959}, "num_episodes": 40, "episode_return_max": 371.0, "episode_return_min": 278.0, "episode_return_mean": 335.92}, "env_runner_results": {"episode_reward_max": 371.0, "episode_reward_min": 278.0, "episode_reward_mean": 335.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.0, 324.0, 367.0, 335.0, 344.0, 317.0, 353.0, 342.0, 336.0, 320.0, 323.0, 321.0, 346.0, 340.0, 324.0, 308.0, 320.0, 324.0, 325.0, 312.0, 349.0, 321.0, 315.0, 349.0, 317.0, 278.0, 337.0, 332.0, 355.0, 333.0, 334.0, 334.0, 370.0, 322.0, 359.0, 347.0, 350.0, 344.0, 336.0, 339.0, 345.0, 297.0, 320.0, 352.0, 323.0, 320.0, 336.0, 351.0, 328.0, 344.0, 324.0, 306.0, 315.0, 341.0, 337.0, 322.0, 334.0, 360.0, 322.0, 348.0, 327.0, 343.0, 338.0, 342.0, 351.0, 339.0, 359.0, 341.0, 337.0, 333.0, 330.0, 341.0, 369.0, 324.0, 334.0, 371.0, 355.0, 326.0, 314.0, 358.0, 343.0, 321.0, 364.0, 350.0, 332.0, 354.0, 350.0, 330.0, 367.0, 317.0, 342.0, 337.0, 315.0, 337.0, 342.0, 308.0, 312.0, 348.0, 353.0, 359.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1589563958760889, "mean_inference_ms": 1.341895681875835, "mean_action_processing_ms": 0.055534031437340585, "mean_env_wait_ms": 0.5559995263299078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012539863586425781, "StateBufferConnector_ms": 0.0020055770874023438, "ViewRequirementAgentConnector_ms": 0.0644223690032959}, "num_episodes": 40, "episode_return_max": 371.0, "episode_return_min": 278.0, "episode_return_mean": 335.92}, "episode_reward_max": 371.0, "episode_reward_min": 278.0, "episode_reward_mean": 335.92, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [352.0, 324.0, 367.0, 335.0, 344.0, 317.0, 353.0, 342.0, 336.0, 320.0, 323.0, 321.0, 346.0, 340.0, 324.0, 308.0, 320.0, 324.0, 325.0, 312.0, 349.0, 321.0, 315.0, 349.0, 317.0, 278.0, 337.0, 332.0, 355.0, 333.0, 334.0, 334.0, 370.0, 322.0, 359.0, 347.0, 350.0, 344.0, 336.0, 339.0, 345.0, 297.0, 320.0, 352.0, 323.0, 320.0, 336.0, 351.0, 328.0, 344.0, 324.0, 306.0, 315.0, 341.0, 337.0, 322.0, 334.0, 360.0, 322.0, 348.0, 327.0, 343.0, 338.0, 342.0, 351.0, 339.0, 359.0, 341.0, 337.0, 333.0, 330.0, 341.0, 369.0, 324.0, 334.0, 371.0, 355.0, 326.0, 314.0, 358.0, 343.0, 321.0, 364.0, 350.0, 332.0, 354.0, 350.0, 330.0, 367.0, 317.0, 342.0, 337.0, 315.0, 337.0, 342.0, 308.0, 312.0, 348.0, 353.0, 359.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1589563958760889, "mean_inference_ms": 1.341895681875835, "mean_action_processing_ms": 0.055534031437340585, "mean_env_wait_ms": 0.5559995263299078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012539863586425781, "StateBufferConnector_ms": 0.0020055770874023438, "ViewRequirementAgentConnector_ms": 0.0644223690032959}, "num_episodes": 40, "episode_return_max": 371.0, "episode_return_min": 278.0, "episode_return_mean": 335.92, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.6886182869941, "num_env_steps_trained_throughput_per_sec": 210.6886182869941, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 18968.538, "restore_workers_time_ms": 0.0, "training_step_time_ms": 18968.538, "sample_time_ms": 8470.722, "load_time_ms": 0.25, "load_throughput": 15999252.354, "learn_time_ms": 10497.065, "learn_throughput": 381.059, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 320, "training_iteration": 8, "trial_id": "default", "date": "2024-05-18_20-53-00", "timestamp": 1716090780, "time_this_iter_s": 18.98636555671692, "time_total_s": 151.75130534172058, "pid": 45440, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021ED8029620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 151.75130534172058, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 8.807407407407409, "ram_util_percent": 33.6888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.764288346613607, "cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0, "total_loss": 9.87197842136506, "policy_loss": -0.009170171053659531, "vf_loss": 9.881148553663685, "vf_explained_var": 1.3939795955534904e-06, "kl": 5.738076886401123e-10, "entropy": 2.0794306416665354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 383.0, "episode_reward_min": 290.0, "episode_reward_mean": 334.8, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [345.0, 297.0, 320.0, 352.0, 323.0, 320.0, 336.0, 351.0, 328.0, 344.0, 324.0, 306.0, 315.0, 341.0, 337.0, 322.0, 334.0, 360.0, 322.0, 348.0, 327.0, 343.0, 338.0, 342.0, 351.0, 339.0, 359.0, 341.0, 337.0, 333.0, 330.0, 341.0, 369.0, 324.0, 334.0, 371.0, 355.0, 326.0, 314.0, 358.0, 343.0, 321.0, 364.0, 350.0, 332.0, 354.0, 350.0, 330.0, 367.0, 317.0, 342.0, 337.0, 315.0, 337.0, 342.0, 308.0, 312.0, 348.0, 353.0, 359.0, 367.0, 332.0, 345.0, 383.0, 346.0, 333.0, 329.0, 350.0, 367.0, 336.0, 358.0, 343.0, 321.0, 296.0, 297.0, 312.0, 332.0, 290.0, 334.0, 310.0, 316.0, 301.0, 341.0, 367.0, 335.0, 341.0, 343.0, 351.0, 302.0, 331.0, 345.0, 318.0, 312.0, 306.0, 343.0, 320.0, 310.0, 302.0, 335.0, 342.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15740891679891755, "mean_inference_ms": 1.3423495020744098, "mean_action_processing_ms": 0.05607450868103378, "mean_env_wait_ms": 0.5561421986660037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011034488677978516, "StateBufferConnector_ms": 0.002004384994506836, "ViewRequirementAgentConnector_ms": 0.05663943290710449}, "num_episodes": 40, "episode_return_max": 383.0, "episode_return_min": 290.0, "episode_return_mean": 334.8}, "env_runner_results": {"episode_reward_max": 383.0, "episode_reward_min": 290.0, "episode_reward_mean": 334.8, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [345.0, 297.0, 320.0, 352.0, 323.0, 320.0, 336.0, 351.0, 328.0, 344.0, 324.0, 306.0, 315.0, 341.0, 337.0, 322.0, 334.0, 360.0, 322.0, 348.0, 327.0, 343.0, 338.0, 342.0, 351.0, 339.0, 359.0, 341.0, 337.0, 333.0, 330.0, 341.0, 369.0, 324.0, 334.0, 371.0, 355.0, 326.0, 314.0, 358.0, 343.0, 321.0, 364.0, 350.0, 332.0, 354.0, 350.0, 330.0, 367.0, 317.0, 342.0, 337.0, 315.0, 337.0, 342.0, 308.0, 312.0, 348.0, 353.0, 359.0, 367.0, 332.0, 345.0, 383.0, 346.0, 333.0, 329.0, 350.0, 367.0, 336.0, 358.0, 343.0, 321.0, 296.0, 297.0, 312.0, 332.0, 290.0, 334.0, 310.0, 316.0, 301.0, 341.0, 367.0, 335.0, 341.0, 343.0, 351.0, 302.0, 331.0, 345.0, 318.0, 312.0, 306.0, 343.0, 320.0, 310.0, 302.0, 335.0, 342.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15740891679891755, "mean_inference_ms": 1.3423495020744098, "mean_action_processing_ms": 0.05607450868103378, "mean_env_wait_ms": 0.5561421986660037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011034488677978516, "StateBufferConnector_ms": 0.002004384994506836, "ViewRequirementAgentConnector_ms": 0.05663943290710449}, "num_episodes": 40, "episode_return_max": 383.0, "episode_return_min": 290.0, "episode_return_mean": 334.8}, "episode_reward_max": 383.0, "episode_reward_min": 290.0, "episode_reward_mean": 334.8, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [345.0, 297.0, 320.0, 352.0, 323.0, 320.0, 336.0, 351.0, 328.0, 344.0, 324.0, 306.0, 315.0, 341.0, 337.0, 322.0, 334.0, 360.0, 322.0, 348.0, 327.0, 343.0, 338.0, 342.0, 351.0, 339.0, 359.0, 341.0, 337.0, 333.0, 330.0, 341.0, 369.0, 324.0, 334.0, 371.0, 355.0, 326.0, 314.0, 358.0, 343.0, 321.0, 364.0, 350.0, 332.0, 354.0, 350.0, 330.0, 367.0, 317.0, 342.0, 337.0, 315.0, 337.0, 342.0, 308.0, 312.0, 348.0, 353.0, 359.0, 367.0, 332.0, 345.0, 383.0, 346.0, 333.0, 329.0, 350.0, 367.0, 336.0, 358.0, 343.0, 321.0, 296.0, 297.0, 312.0, 332.0, 290.0, 334.0, 310.0, 316.0, 301.0, 341.0, 367.0, 335.0, 341.0, 343.0, 351.0, 302.0, 331.0, 345.0, 318.0, 312.0, 306.0, 343.0, 320.0, 310.0, 302.0, 335.0, 342.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15740891679891755, "mean_inference_ms": 1.3423495020744098, "mean_action_processing_ms": 0.05607450868103378, "mean_env_wait_ms": 0.5561421986660037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011034488677978516, "StateBufferConnector_ms": 0.002004384994506836, "ViewRequirementAgentConnector_ms": 0.05663943290710449}, "num_episodes": 40, "episode_return_max": 383.0, "episode_return_min": 290.0, "episode_return_mean": 334.8, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.84029231090366, "num_env_steps_trained_throughput_per_sec": 208.84029231090366, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 18989.077, "restore_workers_time_ms": 0.0, "training_step_time_ms": 18989.077, "sample_time_ms": 8485.89, "load_time_ms": 0.222, "load_throughput": 17999158.899, "learn_time_ms": 10502.408, "learn_throughput": 380.865, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 360, "training_iteration": 9, "trial_id": "default", "date": "2024-05-18_20-53-19", "timestamp": 1716090799, "time_this_iter_s": 19.15339207649231, "time_total_s": 170.9046974182129, "pid": 45440, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021ED8029620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 170.9046974182129, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 8.892592592592592, "ram_util_percent": 33.93333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7251062873871095, "cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0, "total_loss": 9.93481082300986, "policy_loss": -0.010207557570069067, "vf_loss": 9.945018245327857, "vf_explained_var": 2.4284085919780116e-06, "kl": 6.030529910564411e-10, "entropy": 2.079431087740006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 383.0, "episode_reward_min": 283.0, "episode_reward_mean": 333.31, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.0, 321.0, 364.0, 350.0, 332.0, 354.0, 350.0, 330.0, 367.0, 317.0, 342.0, 337.0, 315.0, 337.0, 342.0, 308.0, 312.0, 348.0, 353.0, 359.0, 367.0, 332.0, 345.0, 383.0, 346.0, 333.0, 329.0, 350.0, 367.0, 336.0, 358.0, 343.0, 321.0, 296.0, 297.0, 312.0, 332.0, 290.0, 334.0, 310.0, 316.0, 301.0, 341.0, 367.0, 335.0, 341.0, 343.0, 351.0, 302.0, 331.0, 345.0, 318.0, 312.0, 306.0, 343.0, 320.0, 310.0, 302.0, 335.0, 342.0, 366.0, 319.0, 349.0, 326.0, 345.0, 380.0, 379.0, 325.0, 343.0, 312.0, 320.0, 338.0, 348.0, 284.0, 349.0, 331.0, 353.0, 341.0, 341.0, 283.0, 331.0, 373.0, 321.0, 311.0, 305.0, 307.0, 306.0, 352.0, 370.0, 314.0, 338.0, 284.0, 347.0, 320.0, 324.0, 330.0, 312.0, 331.0, 367.0, 333.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1563822577263254, "mean_inference_ms": 1.3421545115209323, "mean_action_processing_ms": 0.05643009234659078, "mean_env_wait_ms": 0.5563668315775778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008021354675292969, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.04566454887390137}, "num_episodes": 40, "episode_return_max": 383.0, "episode_return_min": 283.0, "episode_return_mean": 333.31}, "env_runner_results": {"episode_reward_max": 383.0, "episode_reward_min": 283.0, "episode_reward_mean": 333.31, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.0, 321.0, 364.0, 350.0, 332.0, 354.0, 350.0, 330.0, 367.0, 317.0, 342.0, 337.0, 315.0, 337.0, 342.0, 308.0, 312.0, 348.0, 353.0, 359.0, 367.0, 332.0, 345.0, 383.0, 346.0, 333.0, 329.0, 350.0, 367.0, 336.0, 358.0, 343.0, 321.0, 296.0, 297.0, 312.0, 332.0, 290.0, 334.0, 310.0, 316.0, 301.0, 341.0, 367.0, 335.0, 341.0, 343.0, 351.0, 302.0, 331.0, 345.0, 318.0, 312.0, 306.0, 343.0, 320.0, 310.0, 302.0, 335.0, 342.0, 366.0, 319.0, 349.0, 326.0, 345.0, 380.0, 379.0, 325.0, 343.0, 312.0, 320.0, 338.0, 348.0, 284.0, 349.0, 331.0, 353.0, 341.0, 341.0, 283.0, 331.0, 373.0, 321.0, 311.0, 305.0, 307.0, 306.0, 352.0, 370.0, 314.0, 338.0, 284.0, 347.0, 320.0, 324.0, 330.0, 312.0, 331.0, 367.0, 333.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1563822577263254, "mean_inference_ms": 1.3421545115209323, "mean_action_processing_ms": 0.05643009234659078, "mean_env_wait_ms": 0.5563668315775778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008021354675292969, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.04566454887390137}, "num_episodes": 40, "episode_return_max": 383.0, "episode_return_min": 283.0, "episode_return_mean": 333.31}, "episode_reward_max": 383.0, "episode_reward_min": 283.0, "episode_reward_mean": 333.31, "episode_len_mean": 100.0, "episodes_this_iter": 40, "episodes_timesteps_total": 10000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [343.0, 321.0, 364.0, 350.0, 332.0, 354.0, 350.0, 330.0, 367.0, 317.0, 342.0, 337.0, 315.0, 337.0, 342.0, 308.0, 312.0, 348.0, 353.0, 359.0, 367.0, 332.0, 345.0, 383.0, 346.0, 333.0, 329.0, 350.0, 367.0, 336.0, 358.0, 343.0, 321.0, 296.0, 297.0, 312.0, 332.0, 290.0, 334.0, 310.0, 316.0, 301.0, 341.0, 367.0, 335.0, 341.0, 343.0, 351.0, 302.0, 331.0, 345.0, 318.0, 312.0, 306.0, 343.0, 320.0, 310.0, 302.0, 335.0, 342.0, 366.0, 319.0, 349.0, 326.0, 345.0, 380.0, 379.0, 325.0, 343.0, 312.0, 320.0, 338.0, 348.0, 284.0, 349.0, 331.0, 353.0, 341.0, 341.0, 283.0, 331.0, 373.0, 321.0, 311.0, 305.0, 307.0, 306.0, 352.0, 370.0, 314.0, 338.0, 284.0, 347.0, 320.0, 324.0, 330.0, 312.0, 331.0, 367.0, 333.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1563822577263254, "mean_inference_ms": 1.3421545115209323, "mean_action_processing_ms": 0.05643009234659078, "mean_env_wait_ms": 0.5563668315775778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008021354675292969, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.04566454887390137}, "num_episodes": 40, "episode_return_max": 383.0, "episode_return_min": 283.0, "episode_return_mean": 333.31, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.93034445236552, "num_env_steps_trained_throughput_per_sec": 213.93034445236552, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 18959.937, "restore_workers_time_ms": 0.0, "training_step_time_ms": 18959.937, "sample_time_ms": 8474.36, "load_time_ms": 0.2, "load_throughput": 19999065.443, "learn_time_ms": 10484.876, "learn_throughput": 381.502, "synch_weights_time_ms": 0.0}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 400, "training_iteration": 10, "trial_id": "default", "date": "2024-05-18_20-53-38", "timestamp": 1716090818, "time_this_iter_s": 18.69867491722107, "time_total_s": 189.60337233543396, "pid": 45440, "hostname": "Martin-PC", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "netenv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.999, "lr": 0.0, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000021ED8029620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 60, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "evaluation_num_workers": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 189.60337233543396, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 9.288461538461537, "ram_util_percent": 34.05}}
